<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.IOledger.IOledger-votingexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.IOledger.IOledger-votingexample.html" class="Module">Complex-Model.IOledger.IOledger-votingexample</a> <a id="86" class="Keyword">where</a>


<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Data.List.html" class="Module">Data.List</a> <a id="137" class="Keyword">hiding</a> <a id="144" class="Symbol">(</a><a id="145" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="149" class="Symbol">)</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="180" class="Keyword">using</a> <a id="186" class="Symbol">(</a><a id="187" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="190" class="Symbol">;</a> <a id="192" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="195" class="Symbol">)</a>
<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="294" class="Keyword">open</a> <a id="299" class="Keyword">import</a> <a id="306" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="317" class="Keyword">hiding</a> <a id="324" class="Symbol">(</a><a id="325" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="330" class="Symbol">)</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Data.String.html" class="Module">Data.String</a> <a id="356" class="Keyword">hiding</a> <a id="363" class="Symbol">(</a><a id="364" href="Data.String.Base.html#2430" class="Function">length</a><a id="370" class="Symbol">;</a><a id="371" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="375" class="Symbol">)</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="interface.Console.html" class="Module">interface.Console</a> <a id="433" class="Keyword">hiding</a> <a id="440" class="Symbol">(</a><a id="441" href="interface.Console.html#1258" class="Function">main</a><a id="445" class="Symbol">)</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="interface.Unit.html" class="Module">interface.Unit</a>
<a id="474" class="Keyword">open</a> <a id="479" class="Keyword">import</a> <a id="486" href="interface.NativeIO.html" class="Module">interface.NativeIO</a>
<a id="505" class="Keyword">open</a> <a id="510" class="Keyword">import</a> <a id="517" href="interface.Base.html" class="Module">interface.Base</a>
<a id="532" class="Keyword">open</a> <a id="537" class="Keyword">import</a> <a id="544" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="560" class="Symbol">as</a> <a id="563" class="Module">Maybe</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="581" class="Symbol">;</a> <a id="583" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="590" class="Symbol">;</a> <a id="592" href="Data.Maybe.Base.html#2335" class="Function Operator">_&lt;∣&gt;_</a><a id="597" class="Symbol">;</a> <a id="599" href="Data.Maybe.Base.html#2450" class="Function">when</a><a id="603" class="Symbol">)</a>
<a id="605" class="Keyword">import</a> <a id="612" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="635" class="Symbol">as</a> <a id="638" class="Module">Maybe</a>
<a id="644" class="Keyword">open</a> <a id="649" class="Keyword">import</a> <a id="656" href="Data.Product.html" class="Module">Data.Product</a> <a id="669" class="Keyword">renaming</a> <a id="678" class="Symbol">(</a><a id="679" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="683" class="Symbol">to</a> <a id="686" class="InductiveConstructor Operator">_,,_</a> <a id="691" class="Symbol">)</a>
<a id="693" class="Keyword">open</a> <a id="698" class="Keyword">import</a> <a id="705" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>


<a id="727" class="Comment">-- our work</a>
<a id="739" class="Keyword">open</a> <a id="744" class="Keyword">import</a> <a id="751" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>
<a id="772" class="Keyword">open</a> <a id="777" class="Keyword">import</a> <a id="784" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="805" class="Keyword">open</a> <a id="810" class="Keyword">import</a> <a id="817" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a>
<a id="837" class="Keyword">open</a> <a id="842" class="Keyword">import</a> <a id="849" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>
<a id="871" class="Keyword">open</a> <a id="876" class="Keyword">import</a> <a id="883" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="902" class="Keyword">open</a> <a id="907" class="Keyword">import</a> <a id="914" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="963" href="constantparameters.html#837" class="Function">exampleParameters</a>
<a id="981" class="Keyword">open</a> <a id="986" class="Keyword">import</a> <a id="993" href="Complex-Model.ledgerversion.Ledger-Complex-Model-improved-non-terminate.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model-improved-non-terminate</a> <a id="1065" href="constantparameters.html#837" class="Function">exampleParameters</a>


<a id="1085" class="Comment">--convert message to natural number</a>
<a id="msg2ℕ"></a><a id="1121" href="Complex-Model.IOledger.IOledger-votingexample.html#1121" class="Function">msg2ℕ</a> <a id="1127" class="Symbol">:</a> <a id="1129" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1133" class="Symbol">→</a> <a id="1135" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="1137" href="Complex-Model.IOledger.IOledger-votingexample.html#1121" class="Function">msg2ℕ</a> <a id="1143" class="Symbol">(</a><a id="1144" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1148" href="Complex-Model.IOledger.IOledger-votingexample.html#1148" class="Bound">n</a><a id="1149" class="Symbol">)</a>         <a id="1159" class="Symbol">=</a> <a id="1161" href="Complex-Model.IOledger.IOledger-votingexample.html#1148" class="Bound">n</a>
<a id="1163" href="Complex-Model.IOledger.IOledger-votingexample.html#1121" class="CatchallClause Function">msg2ℕ</a><a id="1168" class="CatchallClause"> </a><a id="1169" href="Complex-Model.IOledger.IOledger-votingexample.html#1169" class="CatchallClause Bound">otherwise</a>       <a id="1185" class="Symbol">=</a> <a id="1187" class="Number">0</a>


<a id="1191" class="Comment">-- convert to string</a>
<a id="initialfun2Str"></a><a id="1212" href="Complex-Model.IOledger.IOledger-votingexample.html#1212" class="Function">initialfun2Str</a> <a id="1227" class="Symbol">:</a> <a id="1229" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a> <a id="1240" class="Symbol">→</a> <a id="1242" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="1249" href="Complex-Model.IOledger.IOledger-votingexample.html#1212" class="Function">initialfun2Str</a> <a id="1264" class="Symbol">(</a><a id="1265" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="1272" class="Symbol">(</a><a id="1273" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1277" href="Complex-Model.IOledger.IOledger-votingexample.html#1277" class="Bound">n₁</a><a id="1279" class="Symbol">))</a> <a id="1282" class="Symbol">=</a> <a id="1284" class="String">&quot;(theMsg &quot;</a> <a id="1295" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1298" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1303" href="Complex-Model.IOledger.IOledger-votingexample.html#1277" class="Bound">n₁</a> <a id="1306" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1309" class="String">&quot;)&quot;</a>
<a id="1313" href="Complex-Model.IOledger.IOledger-votingexample.html#1212" class="CatchallClause Function">initialfun2Str</a><a id="1327" class="CatchallClause"> </a><a id="1328" class="CatchallClause Symbol">(</a><a id="1329" href="basicDataStructure.html#1455" class="CatchallClause InductiveConstructor">theMsg</a><a id="1335" class="CatchallClause"> </a><a id="1336" href="Complex-Model.IOledger.IOledger-votingexample.html#1336" class="CatchallClause Bound">othermsg</a><a id="1344" class="CatchallClause Symbol">)</a> <a id="1346" class="Symbol">=</a> <a id="1348" class="String">&quot; The message is not a number &quot;</a>
<a id="1380" href="Complex-Model.IOledger.IOledger-votingexample.html#1212" class="Function">initialfun2Str</a> <a id="1395" class="Symbol">(</a><a id="1396" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="1400" href="Complex-Model.IOledger.IOledger-votingexample.html#1400" class="Bound">x</a><a id="1401" class="Symbol">)</a> <a id="1403" class="Symbol">=</a> <a id="1405" class="String">&quot; The message is not a number &quot;</a>



<a id="1440" class="Keyword">mutual</a>

<a id="1448" class="Comment">--Program 1: Execute a function of a contract</a>

  <a id="executeLedger"></a><a id="1497" href="Complex-Model.IOledger.IOledger-votingexample.html#1497" class="Function">executeLedger</a>           <a id="1521" class="Symbol">:</a> <a id="1523" class="Symbol">∀{</a><a id="1525" href="Complex-Model.IOledger.IOledger-votingexample.html#1525" class="Bound">i</a><a id="1526" class="Symbol">}</a> <a id="1528" class="Symbol">→</a> <a id="1530" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="1538" class="Symbol">→</a> <a id="1540" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="1550" href="Complex-Model.IOledger.IOledger-votingexample.html#1525" class="Bound">i</a> <a id="1552" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="1559" href="Complex-Model.IOledger.IOledger-votingexample.html#1497" class="Function">executeLedger</a> <a id="1573" href="Complex-Model.IOledger.IOledger-votingexample.html#1573" class="Bound">stIO</a> <a id="1578" class="Symbol">.</a><a id="1579" href="interface.Base.html#689" class="Field">force</a> <a id="1585" class="Symbol">=</a>
                             <a id="1616" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="1622" class="Symbol">(</a><a id="1623" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="1632" class="String">&quot;Enter the called address as a natural number&quot;</a><a id="1678" class="Symbol">)</a>
                             <a id="1709" class="Symbol">λ</a> <a id="1711" href="Complex-Model.IOledger.IOledger-votingexample.html#1711" class="Bound">_</a> <a id="1713" class="Symbol">→</a> <a id="1715" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="1722" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>  <a id="1731" class="Symbol">λ</a> <a id="1733" href="Complex-Model.IOledger.IOledger-votingexample.html#1733" class="Bound">line</a> <a id="1738" class="Symbol">→</a> 
                            <a id="1769" href="Complex-Model.IOledger.IOledger-votingexample.html#1819" class="Function">executeLedgerStep1-2</a> <a id="1790" href="Complex-Model.IOledger.IOledger-votingexample.html#1573" class="Bound">stIO</a> <a id="1795" class="Symbol">(</a><a id="1796" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="1806" class="Number">10</a> <a id="1809" href="Complex-Model.IOledger.IOledger-votingexample.html#1733" class="Bound">line</a><a id="1813" class="Symbol">)</a>


  <a id="executeLedgerStep1-2"></a><a id="1819" href="Complex-Model.IOledger.IOledger-votingexample.html#1819" class="Function">executeLedgerStep1-2</a>    <a id="1843" class="Symbol">:</a> <a id="1845" class="Symbol">∀{</a><a id="1847" href="Complex-Model.IOledger.IOledger-votingexample.html#1847" class="Bound">i</a><a id="1848" class="Symbol">}</a> <a id="1850" class="Symbol">→</a> <a id="1852" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1868" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1870" class="Symbol">→</a> <a id="1872" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="1882" href="Complex-Model.IOledger.IOledger-votingexample.html#1847" class="Bound">i</a> <a id="1884" href="interface.Unit.html#38" class="Record">Unit</a>  
  <a id="1893" href="Complex-Model.IOledger.IOledger-votingexample.html#1819" class="Function">executeLedgerStep1-2</a> <a id="1914" href="Complex-Model.IOledger.IOledger-votingexample.html#1914" class="Bound">stIO</a> <a id="1919" class="Symbol">(</a><a id="1920" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1925" href="Complex-Model.IOledger.IOledger-votingexample.html#1925" class="Bound">calledAddr</a><a id="1935" class="Symbol">)</a> <a id="1937" class="Symbol">.</a><a id="1938" href="interface.Base.html#689" class="Field">force</a> <a id="1944" class="Symbol">=</a>
                                        <a id="1986" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="1992" class="Symbol">(</a><a id="1993" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2002" class="String">&quot;Enter the function name as addVoter, deleteVoter, or vote&quot;</a><a id="2061" class="Symbol">)</a>
                                         <a id="2104" class="Symbol">λ</a> <a id="2106" href="Complex-Model.IOledger.IOledger-votingexample.html#2106" class="Bound">_</a> <a id="2108" class="Symbol">→</a> <a id="2110" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="2117" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>  
                                         <a id="2168" class="Symbol">λ</a> <a id="2170" href="Complex-Model.IOledger.IOledger-votingexample.html#2170" class="Bound">line</a> <a id="2175" class="Symbol">→</a> <a id="2177" href="Complex-Model.IOledger.IOledger-votingexample.html#2464" class="Function">executeLedgerStep1-3</a> <a id="2198" href="Complex-Model.IOledger.IOledger-votingexample.html#1914" class="Bound">stIO</a> <a id="2203" href="Complex-Model.IOledger.IOledger-votingexample.html#1925" class="Bound">calledAddr</a> <a id="2214" class="Symbol">(</a><a id="2215" href="libraries.IOlibrary.html#769" class="Function">string2FunctionName</a> <a id="2235" href="Complex-Model.IOledger.IOledger-votingexample.html#2170" class="Bound">line</a><a id="2239" class="Symbol">)</a>
  <a id="2243" href="Complex-Model.IOledger.IOledger-votingexample.html#1819" class="Function">executeLedgerStep1-2</a> <a id="2264" href="Complex-Model.IOledger.IOledger-votingexample.html#2264" class="Bound">stIO</a> <a id="2269" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="2277" class="Symbol">.</a><a id="2278" href="interface.Base.html#689" class="Field">force</a> <a id="2284" class="Symbol">=</a>
                                          <a id="2328" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="2334" class="Symbol">(</a><a id="2335" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2344" class="String">&quot;Please enter an address as a natural number&quot;</a><a id="2389" class="Symbol">)</a>
                                          <a id="2433" class="Symbol">λ</a> <a id="2435" href="Complex-Model.IOledger.IOledger-votingexample.html#2435" class="Bound">_</a> <a id="2437" class="Symbol">→</a> <a id="2439" href="Complex-Model.IOledger.IOledger-votingexample.html#1497" class="Function">executeLedger</a> <a id="2453" href="Complex-Model.IOledger.IOledger-votingexample.html#2264" class="Bound">stIO</a>


 
  <a id="executeLedgerStep1-3"></a><a id="2464" href="Complex-Model.IOledger.IOledger-votingexample.html#2464" class="Function">executeLedgerStep1-3</a>    <a id="2488" class="Symbol">:</a> <a id="2490" class="Symbol">∀{</a><a id="2492" href="Complex-Model.IOledger.IOledger-votingexample.html#2492" class="Bound">i</a><a id="2493" class="Symbol">}</a> <a id="2495" class="Symbol">→</a> <a id="2497" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="2505" class="Symbol">→</a> <a id="2507" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2509" class="Symbol">→</a> <a id="2511" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2517" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="2530" class="Symbol">→</a> <a id="2532" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="2542" href="Complex-Model.IOledger.IOledger-votingexample.html#2492" class="Bound">i</a> <a id="2544" href="interface.Unit.html#38" class="Record">Unit</a> 
  <a id="2552" href="Complex-Model.IOledger.IOledger-votingexample.html#2464" class="Function">executeLedgerStep1-3</a> <a id="2573" href="Complex-Model.IOledger.IOledger-votingexample.html#2573" class="Bound">stIO</a> <a id="2578" href="Complex-Model.IOledger.IOledger-votingexample.html#2578" class="Bound">calledAddr</a> <a id="2589" class="Symbol">(</a><a id="2590" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2595" href="Complex-Model.IOledger.IOledger-votingexample.html#2595" class="Bound">f</a><a id="2596" class="Symbol">)</a> <a id="2598" class="Symbol">.</a><a id="2599" href="interface.Base.html#689" class="Field">force</a> <a id="2605" class="Symbol">=</a> <a id="2607" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="2613" class="Symbol">(</a><a id="2614" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2623" class="String">&quot;Enter the argument of the function name as a natural number&quot;</a><a id="2684" class="Symbol">)</a>
                                                         <a id="2743" class="Symbol">λ</a> <a id="2745" href="Complex-Model.IOledger.IOledger-votingexample.html#2745" class="Bound">_</a> <a id="2747" class="Symbol">→</a> <a id="2749" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="2756" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>
                                                         <a id="2821" class="Symbol">λ</a> <a id="2823" href="Complex-Model.IOledger.IOledger-votingexample.html#2823" class="Bound">line</a> <a id="2828" class="Symbol">→</a>  <a id="2831" href="Complex-Model.IOledger.IOledger-votingexample.html#3140" class="Function">executeLedgerStep1-4</a> <a id="2852" href="Complex-Model.IOledger.IOledger-votingexample.html#2573" class="Bound">stIO</a> <a id="2857" href="Complex-Model.IOledger.IOledger-votingexample.html#2578" class="Bound">calledAddr</a> <a id="2868" href="Complex-Model.IOledger.IOledger-votingexample.html#2595" class="Bound">f</a> <a id="2870" class="Symbol">(</a><a id="2871" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="2881" class="Number">10</a> <a id="2884" href="Complex-Model.IOledger.IOledger-votingexample.html#2823" class="Bound">line</a><a id="2888" class="Symbol">)</a>
  <a id="2892" href="Complex-Model.IOledger.IOledger-votingexample.html#2464" class="Function">executeLedgerStep1-3</a> <a id="2913" href="Complex-Model.IOledger.IOledger-votingexample.html#2913" class="Bound">stIO</a> <a id="2918" href="Complex-Model.IOledger.IOledger-votingexample.html#2918" class="Bound">calledAddr</a> <a id="2929" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="2938" class="Symbol">.</a><a id="2939" href="interface.Base.html#689" class="Field">force</a> <a id="2945" class="Symbol">=</a> <a id="2947" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="2953" class="Symbol">(</a><a id="2954" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2963" class="String">&quot;Please enter a function name as addVoter, deleteVoter, or vote&quot;</a><a id="3027" class="Symbol">)</a>
                                                         <a id="3086" class="Symbol">λ</a> <a id="3088" href="Complex-Model.IOledger.IOledger-votingexample.html#3088" class="Bound">_</a> <a id="3090" class="Symbol">→</a> <a id="3092" href="Complex-Model.IOledger.IOledger-votingexample.html#1819" class="Function">executeLedgerStep1-2</a> <a id="3113" href="Complex-Model.IOledger.IOledger-votingexample.html#2913" class="Bound">stIO</a> <a id="3118" class="Symbol">(</a><a id="3119" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3124" href="Complex-Model.IOledger.IOledger-votingexample.html#2918" class="Bound">calledAddr</a><a id="3134" class="Symbol">)</a>


  <a id="executeLedgerStep1-4"></a><a id="3140" href="Complex-Model.IOledger.IOledger-votingexample.html#3140" class="Function">executeLedgerStep1-4</a>    <a id="3164" class="Symbol">:</a> <a id="3166" class="Symbol">∀{</a><a id="3168" href="Complex-Model.IOledger.IOledger-votingexample.html#3168" class="Bound">i</a><a id="3169" class="Symbol">}</a> <a id="3171" class="Symbol">→</a> <a id="3173" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="3181" class="Symbol">→</a> <a id="3183" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3185" class="Symbol">→</a> <a id="3187" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="3200" class="Symbol">→</a> <a id="3202" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3208" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="3210" class="Symbol">→</a> <a id="3212" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="3222" href="Complex-Model.IOledger.IOledger-votingexample.html#3168" class="Bound">i</a> <a id="3224" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="3231" href="Complex-Model.IOledger.IOledger-votingexample.html#3140" class="Function">executeLedgerStep1-4</a> <a id="3252" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="3254" href="Complex-Model.IOledger.IOledger-votingexample.html#3254" class="Bound">ledger</a> <a id="3261" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="3269" href="Complex-Model.IOledger.IOledger-votingexample.html#3269" class="Bound">initialAddr</a> <a id="3281" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="3294" href="Complex-Model.IOledger.IOledger-votingexample.html#3294" class="Bound">gas</a> <a id="3298" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="3303" href="Complex-Model.IOledger.IOledger-votingexample.html#3303" class="Bound">calledAddr</a> <a id="3314" href="Complex-Model.IOledger.IOledger-votingexample.html#3314" class="Bound">f</a> <a id="3316" class="Symbol">(</a><a id="3317" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="3322" href="Complex-Model.IOledger.IOledger-votingexample.html#3322" class="Bound">m</a><a id="3323" class="Symbol">)</a> <a id="3325" class="Symbol">.</a><a id="3326" href="interface.Base.html#689" class="Field">force</a>
                                        <a id="3372" class="Symbol">=</a> <a id="3374" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="3380" class="Symbol">(</a><a id="3381" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="3390" class="Symbol">(</a><a id="3391" class="String">&quot; The result is as follows:  \n&quot;</a> <a id="3424" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                                                           <a id="3486" class="String">&quot; \n The initial address is &quot;</a> <a id="3516" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="3519" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="3524" href="Complex-Model.IOledger.IOledger-votingexample.html#3269" class="Bound">initialAddr</a> <a id="3536" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                                                           <a id="3598" class="String">&quot; \n The called address is &quot;</a>  <a id="3628" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="3631" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="3636" href="Complex-Model.IOledger.IOledger-votingexample.html#3303" class="Bound">calledAddr</a><a id="3646" class="Symbol">))</a> <a id="3649" class="Symbol">λ</a> <a id="3651" href="Complex-Model.IOledger.IOledger-votingexample.html#3651" class="Bound">_</a> <a id="3653" class="Symbol">→</a>
                                          <a id="3697" href="Complex-Model.IOledger.IOledger-votingexample.html#4180" class="Function">executeLedgerFinalStep</a> <a id="3720" class="Symbol">((</a><a id="3722" href="Complex-Model.ledgerversion.Ledger-Complex-Model-improved-non-terminate.html#3148" class="Function">evaluateNonTerminatingfinal</a> <a id="3750" href="Complex-Model.IOledger.IOledger-votingexample.html#3254" class="Bound">ledger</a> <a id="3757" href="Complex-Model.IOledger.IOledger-votingexample.html#3269" class="Bound">initialAddr</a> <a id="3769" href="Complex-Model.IOledger.IOledger-votingexample.html#3269" class="Bound">initialAddr</a> <a id="3781" href="Complex-Model.IOledger.IOledger-votingexample.html#3303" class="Bound">calledAddr</a> <a id="3792" href="Complex-Model.IOledger.IOledger-votingexample.html#3314" class="Bound">f</a> <a id="3794" class="Symbol">(</a><a id="3795" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="3799" href="Complex-Model.IOledger.IOledger-votingexample.html#3322" class="Bound">m</a><a id="3800" class="Symbol">)</a> <a id="3802" href="Complex-Model.IOledger.IOledger-votingexample.html#3294" class="Bound">gas</a><a id="3805" class="Symbol">))</a>
                                           <a id="3851" class="Symbol">(</a><a id="3852" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="3854" href="Complex-Model.IOledger.IOledger-votingexample.html#3254" class="Bound">ledger</a> <a id="3861" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="3869" href="Complex-Model.IOledger.IOledger-votingexample.html#3269" class="Bound">initialAddr</a> <a id="3881" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="3894" href="Complex-Model.IOledger.IOledger-votingexample.html#3294" class="Bound">gas</a> <a id="3898" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="3902" class="Symbol">)</a>
  <a id="3906" href="Complex-Model.IOledger.IOledger-votingexample.html#3140" class="Function">executeLedgerStep1-4</a> <a id="3927" href="Complex-Model.IOledger.IOledger-votingexample.html#3927" class="Bound">stIO</a> <a id="3932" href="Complex-Model.IOledger.IOledger-votingexample.html#3932" class="Bound">calledAddr</a> <a id="3943" href="Complex-Model.IOledger.IOledger-votingexample.html#3943" class="Bound">f</a> <a id="3945" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="3954" class="Symbol">.</a><a id="3955" href="interface.Base.html#689" class="Field">force</a>
                                        <a id="4001" class="Symbol">=</a> <a id="4003" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="4009" class="Symbol">(</a><a id="4010" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="4019" class="String">&quot;Enter the argument of the function name as a natural number&quot;</a><a id="4080" class="Symbol">)</a>
                                        <a id="4122" class="Symbol">λ</a> <a id="4124" href="Complex-Model.IOledger.IOledger-votingexample.html#4124" class="Bound">_</a> <a id="4126" class="Symbol">→</a>  <a id="4129" href="Complex-Model.IOledger.IOledger-votingexample.html#2464" class="Function">executeLedgerStep1-3</a> <a id="4150" href="Complex-Model.IOledger.IOledger-votingexample.html#3927" class="Bound">stIO</a>  <a id="4156" href="Complex-Model.IOledger.IOledger-votingexample.html#3932" class="Bound">calledAddr</a> <a id="4167" class="Symbol">(</a><a id="4168" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4173" href="Complex-Model.IOledger.IOledger-votingexample.html#3943" class="Bound">f</a><a id="4174" class="Symbol">)</a>


  <a id="executeLedgerFinalStep"></a><a id="4180" href="Complex-Model.IOledger.IOledger-votingexample.html#4180" class="Function">executeLedgerFinalStep</a>  <a id="4204" class="Symbol">:</a> <a id="4206" class="Symbol">∀{</a><a id="4208" href="Complex-Model.IOledger.IOledger-votingexample.html#4208" class="Bound">i</a><a id="4209" class="Symbol">}</a> <a id="4211" class="Symbol">→</a> <a id="4213" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4219" class="Symbol">(</a><a id="4220" href="libraries.Mainlibrary.html#1012" class="Function">Ledger</a> <a id="4227" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4229" href="basicDataStructure.html#1675" class="Record">MsgOrErrorWithGas</a><a id="4246" class="Symbol">)</a> <a id="4248" class="Symbol">→</a> <a id="4250" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a>  <a id="4259" class="Symbol">→</a> <a id="4261" href="interface.Base.html#590" class="Record">IO</a> <a id="4264" href="interface.Console.html#511" class="Function">consoleI</a> <a id="4273" href="Complex-Model.IOledger.IOledger-votingexample.html#4208" class="Bound">i</a> <a id="4275" href="interface.Unit.html#38" class="Record">Unit</a>  
  <a id="4284" href="Complex-Model.IOledger.IOledger-votingexample.html#4180" class="Function">executeLedgerFinalStep</a> <a id="4307" class="Symbol">(</a><a id="4308" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4313" class="Symbol">(</a><a id="4314" href="Complex-Model.IOledger.IOledger-votingexample.html#4314" class="Bound">newledger</a> <a id="4324" href="Complex-Model.IOledger.IOledger-votingexample.html#686" class="InductiveConstructor Operator">,,</a> <a id="4327" class="Symbol">(</a><a id="4328" href="basicDataStructure.html#1562" class="InductiveConstructor">theMsg</a> <a id="4335" href="Complex-Model.IOledger.IOledger-votingexample.html#4335" class="Bound">ms</a> <a id="4338" href="basicDataStructure.html#1726" class="InductiveConstructor Operator">,</a> <a id="4340" href="Complex-Model.IOledger.IOledger-votingexample.html#4340" class="Bound">gas₁</a> <a id="4345" href="basicDataStructure.html#1726" class="InductiveConstructor Operator">gas</a><a id="4348" class="Symbol">)))</a>
                         <a id="4377" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="4379" href="Complex-Model.IOledger.IOledger-votingexample.html#4379" class="Bound">ledger</a> <a id="4386" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="4394" href="Complex-Model.IOledger.IOledger-votingexample.html#4394" class="Bound">initialAddr</a> <a id="4406" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="4419" href="Complex-Model.IOledger.IOledger-votingexample.html#4419" class="Bound">gas</a> <a id="4423" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="4428" class="Symbol">.</a><a id="4429" href="interface.Base.html#689" class="Field">force</a>
                          <a id="4461" class="Symbol">=</a> <a id="4463" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="4469" class="Symbol">(</a><a id="4470" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="4479" class="Symbol">(</a><a id="4480" class="String">&quot; The argument of the function name is &quot;</a> <a id="4521" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4524" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="4535" href="Complex-Model.IOledger.IOledger-votingexample.html#4335" class="Bound">ms</a><a id="4537" class="Symbol">))</a>
                           <a id="4567" class="Symbol">λ</a> <a id="4569" href="Complex-Model.IOledger.IOledger-votingexample.html#4569" class="Bound">_</a> <a id="4571" class="Symbol">→</a> <a id="4573" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="4580" class="Symbol">(</a><a id="4581" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="4590" class="Symbol">(</a><a id="4591" class="String">&quot; The remaining gas is &quot;</a> <a id="4616" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4619" class="Symbol">(</a><a id="4620" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="4625" href="Complex-Model.IOledger.IOledger-votingexample.html#4340" class="Bound">gas₁</a><a id="4629" class="Symbol">)</a> <a id="4631" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4634" class="String">&quot; wei&quot;</a>
                           <a id="4668" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4671" class="String">&quot; ,  The function returned &quot;</a> <a id="4700" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4703" href="Complex-Model.IOledger.IOledger-votingexample.html#1212" class="Function">initialfun2Str</a> <a id="4718" class="Symbol">(</a><a id="4719" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="4726" href="Complex-Model.IOledger.IOledger-votingexample.html#4335" class="Bound">ms</a><a id="4728" class="Symbol">)))</a>
                           <a id="4759" class="Symbol">λ</a> <a id="4761" href="Complex-Model.IOledger.IOledger-votingexample.html#4761" class="Bound">_</a> <a id="4763" class="Symbol">→</a> <a id="4765" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="4774" class="Symbol">(</a><a id="4775" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="4777" href="Complex-Model.IOledger.IOledger-votingexample.html#4314" class="Bound">newledger</a> <a id="4787" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="4795" href="Complex-Model.IOledger.IOledger-votingexample.html#4394" class="Bound">initialAddr</a> <a id="4807" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="4820" href="Complex-Model.IOledger.IOledger-votingexample.html#4419" class="Bound">gas</a> <a id="4824" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="4828" class="Symbol">)</a>
  <a id="4832" href="Complex-Model.IOledger.IOledger-votingexample.html#4180" class="Function">executeLedgerFinalStep</a> <a id="4855" class="Symbol">(</a><a id="4856" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4861" class="Symbol">(</a><a id="4862" href="Complex-Model.IOledger.IOledger-votingexample.html#4862" class="Bound">newledger</a> <a id="4872" href="Complex-Model.IOledger.IOledger-votingexample.html#686" class="InductiveConstructor Operator">,,</a> <a id="4875" class="Symbol">(</a><a id="4876" href="basicDataStructure.html#1590" class="InductiveConstructor">err</a> <a id="4880" href="Complex-Model.IOledger.IOledger-votingexample.html#4880" class="Bound">e</a> <a id="4882" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="4884" href="Complex-Model.IOledger.IOledger-votingexample.html#4884" class="Bound">lastCallAddress</a> <a id="4900" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4903" href="Complex-Model.IOledger.IOledger-votingexample.html#4903" class="Bound">curraddr</a> <a id="4912" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="4914" href="Complex-Model.IOledger.IOledger-votingexample.html#4914" class="Bound">lastfunname</a> <a id="4926" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="4928" href="Complex-Model.IOledger.IOledger-votingexample.html#4928" class="Bound">lastmsg</a> <a id="4936" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a> <a id="4939" href="basicDataStructure.html#1726" class="InductiveConstructor Operator">,</a> <a id="4941" href="Complex-Model.IOledger.IOledger-votingexample.html#4941" class="Bound">gas₁</a> <a id="4946" href="basicDataStructure.html#1726" class="InductiveConstructor Operator">gas</a><a id="4949" class="Symbol">)))</a>
                          <a id="4979" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="4981" href="Complex-Model.IOledger.IOledger-votingexample.html#4981" class="Bound">ledger</a> <a id="4988" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="4996" href="Complex-Model.IOledger.IOledger-votingexample.html#4996" class="Bound">initialAddr</a> <a id="5008" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="5021" href="Complex-Model.IOledger.IOledger-votingexample.html#5021" class="Bound">gas</a> <a id="5025" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="5030" class="Symbol">.</a><a id="5031" href="interface.Base.html#689" class="Field">force</a>
                          <a id="5063" class="Symbol">=</a> <a id="5065" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="5071" class="Symbol">(</a><a id="5072" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="5081" class="String">&quot;Debug information&quot;</a><a id="5100" class="Symbol">)</a>
                           <a id="5129" class="Symbol">λ</a> <a id="5131" href="Complex-Model.IOledger.IOledger-votingexample.html#5131" class="Bound">_</a> <a id="5133" class="Symbol">→</a> <a id="5135" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="5142" class="Symbol">(</a><a id="5143" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="5152" class="Symbol">(</a><a id="5153" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="5166" class="Symbol">(</a><a id="5167" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="5171" href="Complex-Model.IOledger.IOledger-votingexample.html#4880" class="Bound">e</a> <a id="5173" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="5175" href="Complex-Model.IOledger.IOledger-votingexample.html#4884" class="Bound">lastCallAddress</a> <a id="5191" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="5194" href="Complex-Model.IOledger.IOledger-votingexample.html#4903" class="Bound">curraddr</a> <a id="5203" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="5205" href="Complex-Model.IOledger.IOledger-votingexample.html#4914" class="Bound">lastfunname</a> <a id="5217" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="5219" href="Complex-Model.IOledger.IOledger-votingexample.html#4928" class="Bound">lastmsg</a> <a id="5227" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="5229" class="Symbol">)))</a>
                           <a id="5260" class="Symbol">λ</a> <a id="5262" href="Complex-Model.IOledger.IOledger-votingexample.html#5262" class="Bound">_</a> <a id="5264" class="Symbol">→</a> <a id="5266" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="5273" class="Symbol">(</a><a id="5274" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="5283" class="Symbol">(</a><a id="5284" class="String">&quot;Address &quot;</a> <a id="5295" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="5298" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="5303" href="Complex-Model.IOledger.IOledger-votingexample.html#4884" class="Bound">lastCallAddress</a> <a id="5319" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                           <a id="5349" class="String">&quot; is trying to call the address &quot;</a> <a id="5383" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="5386" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="5391" href="Complex-Model.IOledger.IOledger-votingexample.html#4903" class="Bound">curraddr</a> <a id="5400" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                           <a id="5430" class="String">&quot; with Function Name &quot;</a> <a id="5453" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="5456" href="libraries.IOlibrary.html#858" class="Function">funname2string</a> <a id="5471" href="Complex-Model.IOledger.IOledger-votingexample.html#4914" class="Bound">lastfunname</a> <a id="5483" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                           <a id="5513" class="String">&quot; with Message &quot;</a> <a id="5530" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="5533" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="5544" href="Complex-Model.IOledger.IOledger-votingexample.html#4928" class="Bound">lastmsg</a><a id="5551" class="Symbol">))</a>
                           <a id="5581" class="Symbol">λ</a> <a id="5583" href="Complex-Model.IOledger.IOledger-votingexample.html#5583" class="Bound">_</a> <a id="5585" class="Symbol">→</a> <a id="5587" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="5594" class="Symbol">(</a><a id="5595" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="5604" class="Symbol">(</a><a id="5605" class="String">&quot;The remaining gas is &quot;</a> <a id="5629" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="5632" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="5637" href="Complex-Model.IOledger.IOledger-votingexample.html#4941" class="Bound">gas₁</a> <a id="5642" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="5645" class="String">&quot; wei&quot;</a><a id="5651" class="Symbol">))</a>
                           <a id="5681" class="Symbol">λ</a> <a id="5683" href="Complex-Model.IOledger.IOledger-votingexample.html#5683" class="Bound">_</a> <a id="5685" class="Symbol">→</a> <a id="5687" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="5696" class="Symbol">(</a><a id="5697" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="5699" href="Complex-Model.IOledger.IOledger-votingexample.html#4862" class="Bound">newledger</a> <a id="5709" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="5717" href="Complex-Model.IOledger.IOledger-votingexample.html#4996" class="Bound">initialAddr</a> <a id="5729" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="5742" href="Complex-Model.IOledger.IOledger-votingexample.html#5021" class="Bound">gas</a> <a id="5746" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="5750" class="Symbol">)</a>

  <a id="5755" href="Complex-Model.IOledger.IOledger-votingexample.html#4180" class="Function">executeLedgerFinalStep</a> <a id="5778" class="Symbol">(</a><a id="5779" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5784" class="Symbol">(</a><a id="5785" href="Complex-Model.IOledger.IOledger-votingexample.html#5785" class="Bound">newledger</a> <a id="5795" href="Complex-Model.IOledger.IOledger-votingexample.html#686" class="InductiveConstructor Operator">,,</a> <a id="5798" class="Symbol">(</a><a id="5799" href="basicDataStructure.html#1632" class="InductiveConstructor">invalidtransaction</a> <a id="5818" href="basicDataStructure.html#1726" class="InductiveConstructor Operator">,</a> <a id="5820" href="Complex-Model.IOledger.IOledger-votingexample.html#5820" class="Bound">gas₁</a> <a id="5825" href="basicDataStructure.html#1726" class="InductiveConstructor Operator">gas</a><a id="5828" class="Symbol">)))</a>
                         <a id="5857" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="5859" href="Complex-Model.IOledger.IOledger-votingexample.html#5859" class="Bound">ledger</a> <a id="5866" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="5874" href="Complex-Model.IOledger.IOledger-votingexample.html#5874" class="Bound">initialAddr</a> <a id="5886" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="5899" href="Complex-Model.IOledger.IOledger-votingexample.html#5899" class="Bound">gas</a> <a id="5903" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="5908" class="Symbol">.</a><a id="5909" href="interface.Base.html#689" class="Field">force</a>
                          <a id="5941" class="Symbol">=</a> <a id="5943" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="5949" class="Symbol">(</a><a id="5950" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="5959" class="String">&quot;Invalid transaction&quot;</a><a id="5980" class="Symbol">)</a>
                             <a id="6011" class="Symbol">λ</a> <a id="6013" href="Complex-Model.IOledger.IOledger-votingexample.html#6013" class="Bound">_</a> <a id="6015" class="Symbol">→</a> <a id="6017" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="6024" class="Symbol">(</a><a id="6025" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="6034" class="Symbol">(</a><a id="6035" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="6048" href="basicDataStructure.html#1161" class="InductiveConstructor">invalidtransaction</a><a id="6066" class="Symbol">))</a>
                             <a id="6098" class="Symbol">λ</a> <a id="6100" href="Complex-Model.IOledger.IOledger-votingexample.html#6100" class="Bound">_</a> <a id="6102" class="Symbol">→</a> <a id="6104" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="6111" class="Symbol">(</a><a id="6112" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="6121" class="Symbol">(</a><a id="6122" class="String">&quot;The remaining gas is &quot;</a> <a id="6146" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="6149" class="Symbol">(</a><a id="6150" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="6155" href="Complex-Model.IOledger.IOledger-votingexample.html#5820" class="Bound">gas₁</a><a id="6159" class="Symbol">)</a> <a id="6161" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="6164" class="String">&quot; wei&quot;</a><a id="6170" class="Symbol">))</a>
                             <a id="6202" class="Symbol">λ</a> <a id="6204" href="Complex-Model.IOledger.IOledger-votingexample.html#6204" class="Bound">_</a> <a id="6206" class="Symbol">→</a> <a id="6208" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="6217" class="Symbol">(</a><a id="6218" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="6220" href="Complex-Model.IOledger.IOledger-votingexample.html#5785" class="Bound">newledger</a> <a id="6230" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="6238" href="Complex-Model.IOledger.IOledger-votingexample.html#5874" class="Bound">initialAddr</a> <a id="6250" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="6263" href="Complex-Model.IOledger.IOledger-votingexample.html#5899" class="Bound">gas</a> <a id="6267" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="6271" class="Symbol">)</a>
  <a id="6275" href="Complex-Model.IOledger.IOledger-votingexample.html#4180" class="Function">executeLedgerFinalStep</a> <a id="6298" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="6306" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="6308" href="Complex-Model.IOledger.IOledger-votingexample.html#6308" class="Bound">ledger</a> <a id="6315" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="6323" href="Complex-Model.IOledger.IOledger-votingexample.html#6323" class="Bound">initialAddr</a> <a id="6335" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="6348" href="Complex-Model.IOledger.IOledger-votingexample.html#6348" class="Bound">gas</a> <a id="6352" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="6357" class="Symbol">.</a><a id="6358" href="interface.Base.html#689" class="Field">force</a>
                          <a id="6390" class="Symbol">=</a> <a id="6392" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="6398" class="Symbol">(</a><a id="6399" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="6408" class="String">&quot;Nothing and the ledger will change to old ledger&quot;</a><a id="6458" class="Symbol">)</a>
                     <a id="6481" class="Symbol">λ</a> <a id="6483" href="Complex-Model.IOledger.IOledger-votingexample.html#6483" class="Bound">_</a> <a id="6485" class="Symbol">→</a> <a id="6487" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="6496" class="Symbol">(</a><a id="6497" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="6499" href="Complex-Model.IOledger.IOledger-votingexample.html#6308" class="Bound">ledger</a> <a id="6506" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="6514" href="Complex-Model.IOledger.IOledger-votingexample.html#6323" class="Bound">initialAddr</a> <a id="6526" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="6539" href="Complex-Model.IOledger.IOledger-votingexample.html#6348" class="Bound">gas</a> <a id="6543" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="6547" class="Symbol">)</a>



<a id="6552" class="Comment">-- program 2: Look up the balance of one contract</a>

  <a id="executeLedger-CheckBalance"></a><a id="6605" href="Complex-Model.IOledger.IOledger-votingexample.html#6605" class="Function">executeLedger-CheckBalance</a> <a id="6632" class="Symbol">:</a> <a id="6634" class="Symbol">∀{</a><a id="6636" href="Complex-Model.IOledger.IOledger-votingexample.html#6636" class="Bound">i</a><a id="6637" class="Symbol">}</a> <a id="6639" class="Symbol">→</a> <a id="6641" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="6649" class="Symbol">→</a> <a id="6651" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="6661" href="Complex-Model.IOledger.IOledger-votingexample.html#6636" class="Bound">i</a> <a id="6663" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="6670" href="Complex-Model.IOledger.IOledger-votingexample.html#6605" class="Function">executeLedger-CheckBalance</a> <a id="6697" href="Complex-Model.IOledger.IOledger-votingexample.html#6697" class="Bound">stIO</a> <a id="6702" class="Symbol">.</a><a id="6703" href="interface.Base.html#689" class="Field">force</a> <a id="6709" class="Symbol">=</a> <a id="6711" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="6717" class="Symbol">(</a><a id="6718" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="6727" class="String">&quot;Enter the called address as a natural number&quot;</a><a id="6773" class="Symbol">)</a>
                                           <a id="6818" class="Symbol">λ</a> <a id="6820" href="Complex-Model.IOledger.IOledger-votingexample.html#6820" class="Bound">_</a> <a id="6822" class="Symbol">→</a> <a id="6824" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="6831" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>  <a id="6840" class="Symbol">λ</a> <a id="6842" href="Complex-Model.IOledger.IOledger-votingexample.html#6842" class="Bound">line</a> <a id="6847" class="Symbol">→</a> 
                                            <a id="6894" href="Complex-Model.IOledger.IOledger-votingexample.html#6984" class="Function">executeLedgerStep-CheckBalanceAux</a> <a id="6928" href="Complex-Model.IOledger.IOledger-votingexample.html#6697" class="Bound">stIO</a> <a id="6933" class="Symbol">(</a><a id="6934" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="6944" class="Number">10</a> <a id="6947" href="Complex-Model.IOledger.IOledger-votingexample.html#6842" class="Bound">line</a><a id="6951" class="Symbol">)</a>
                            
  <a id="executeLedgerStep-CheckBalanceAux"></a><a id="6984" href="Complex-Model.IOledger.IOledger-votingexample.html#6984" class="Function">executeLedgerStep-CheckBalanceAux</a>  <a id="7019" class="Symbol">:</a> <a id="7021" class="Symbol">∀{</a><a id="7023" href="Complex-Model.IOledger.IOledger-votingexample.html#7023" class="Bound">i</a><a id="7024" class="Symbol">}</a> <a id="7026" class="Symbol">→</a> <a id="7028" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="7036" class="Symbol">→</a> <a id="7038" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="7044" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="7046" class="Symbol">→</a> <a id="7048" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="7058" href="Complex-Model.IOledger.IOledger-votingexample.html#7023" class="Bound">i</a> <a id="7060" href="interface.Unit.html#38" class="Record">Unit</a>  
  <a id="7069" href="Complex-Model.IOledger.IOledger-votingexample.html#6984" class="Function">executeLedgerStep-CheckBalanceAux</a> <a id="7103" href="Complex-Model.IOledger.IOledger-votingexample.html#7103" class="Bound">stIO</a> <a id="7108" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="7116" class="Symbol">.</a><a id="7117" href="interface.Base.html#689" class="Field">force</a>
                                       <a id="7162" class="Symbol">=</a> <a id="7164" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="7170" class="Symbol">(</a><a id="7171" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="7180" class="String">&quot;Please enter an address as a natural number&quot;</a><a id="7225" class="Symbol">)</a>
                                         <a id="7268" class="Symbol">λ</a> <a id="7270" href="Complex-Model.IOledger.IOledger-votingexample.html#7270" class="Bound">_</a> <a id="7272" class="Symbol">→</a> <a id="7274" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="7281" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> 
                                         <a id="7331" class="Symbol">λ</a> <a id="7333" href="Complex-Model.IOledger.IOledger-votingexample.html#7333" class="Bound">_</a> <a id="7335" class="Symbol">→</a> <a id="7337" href="Complex-Model.IOledger.IOledger-votingexample.html#6605" class="Function">executeLedger-CheckBalance</a> <a id="7364" href="Complex-Model.IOledger.IOledger-votingexample.html#7103" class="Bound">stIO</a>

  <a id="7372" href="Complex-Model.IOledger.IOledger-votingexample.html#6984" class="Function">executeLedgerStep-CheckBalanceAux</a> <a id="7406" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="7408" href="Complex-Model.IOledger.IOledger-votingexample.html#7408" class="Bound">ledger</a> <a id="7415" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="7423" href="Complex-Model.IOledger.IOledger-votingexample.html#7423" class="Bound">initialAddr</a> <a id="7435" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="7448" href="Complex-Model.IOledger.IOledger-votingexample.html#7448" class="Bound">gas</a> <a id="7452" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="7457" class="Symbol">(</a><a id="7458" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="7463" href="Complex-Model.IOledger.IOledger-votingexample.html#7463" class="Bound">calledAddr</a><a id="7473" class="Symbol">)</a> <a id="7475" class="Symbol">.</a><a id="7476" href="interface.Base.html#689" class="Field">force</a>
                                       <a id="7521" class="Symbol">=</a> <a id="7523" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="7529" class="Symbol">(</a><a id="7530" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="7539" class="String">&quot;The information you get is below:  &quot;</a><a id="7576" class="Symbol">)</a>
                                       <a id="7617" class="Symbol">λ</a> <a id="7619" href="Complex-Model.IOledger.IOledger-votingexample.html#7619" class="Bound">line</a> <a id="7624" class="Symbol">→</a> <a id="7626" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="7633" class="Symbol">(</a><a id="7634" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="7643" class="Symbol">(</a><a id="7644" class="String">&quot;The available money is &quot;</a> <a id="7670" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="7673" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="7678" class="Symbol">(</a><a id="7679" href="Complex-Model.IOledger.IOledger-votingexample.html#7408" class="Bound">ledger</a> <a id="7686" href="Complex-Model.IOledger.IOledger-votingexample.html#7463" class="Bound">calledAddr</a> <a id="7697" class="Symbol">.</a><a id="7698" href="libraries.Mainlibrary.html#839" class="Field">amount</a><a id="7704" class="Symbol">)</a>
                                         <a id="7747" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="7750" class="String">&quot; wei in address &quot;</a> <a id="7769" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="7772" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="7777" href="Complex-Model.IOledger.IOledger-votingexample.html#7463" class="Bound">calledAddr</a><a id="7787" class="Symbol">))</a>
                                       <a id="7829" class="Symbol">(λ</a> <a id="7832" href="Complex-Model.IOledger.IOledger-votingexample.html#7832" class="Bound">line</a> <a id="7837" class="Symbol">→</a> <a id="7839" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="7848" class="Symbol">(</a><a id="7849" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="7851" href="Complex-Model.IOledger.IOledger-votingexample.html#7408" class="Bound">ledger</a> <a id="7858" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="7866" href="Complex-Model.IOledger.IOledger-votingexample.html#7423" class="Bound">initialAddr</a> <a id="7878" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="7891" href="Complex-Model.IOledger.IOledger-votingexample.html#7448" class="Bound">gas</a> <a id="7895" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="7899" class="Symbol">))</a>



<a id="7905" class="Comment">-- program 3: Change the calling address</a>

  <a id="executeLedger-ChangeCallingAddress"></a><a id="7949" href="Complex-Model.IOledger.IOledger-votingexample.html#7949" class="Function">executeLedger-ChangeCallingAddress</a> <a id="7984" class="Symbol">:</a> <a id="7986" class="Symbol">∀{</a><a id="7988" href="Complex-Model.IOledger.IOledger-votingexample.html#7988" class="Bound">i</a><a id="7989" class="Symbol">}</a> <a id="7991" class="Symbol">→</a> <a id="7993" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="8001" class="Symbol">→</a> <a id="8003" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="8013" href="Complex-Model.IOledger.IOledger-votingexample.html#7988" class="Bound">i</a> <a id="8015" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="8022" href="Complex-Model.IOledger.IOledger-votingexample.html#7949" class="Function">executeLedger-ChangeCallingAddress</a> <a id="8057" href="Complex-Model.IOledger.IOledger-votingexample.html#8057" class="Bound">stIO</a> <a id="8062" class="Symbol">.</a><a id="8063" href="interface.Base.html#689" class="Field">force</a>
                    <a id="8089" class="Symbol">=</a> <a id="8091" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="8097" class="Symbol">(</a><a id="8098" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="8107" class="String">&quot;Enter a new calling address as a natural number&quot;</a><a id="8156" class="Symbol">)</a>
                      <a id="8180" class="Symbol">λ</a> <a id="8182" href="Complex-Model.IOledger.IOledger-votingexample.html#8182" class="Bound">_</a> <a id="8184" class="Symbol">→</a> <a id="8186" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="8193" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>
                      <a id="8223" class="Symbol">λ</a> <a id="8225" href="Complex-Model.IOledger.IOledger-votingexample.html#8225" class="Bound">line</a> <a id="8230" class="Symbol">→</a>  <a id="8233" href="Complex-Model.IOledger.IOledger-votingexample.html#8299" class="Function">executeLedger-ChangeCallingAddressAux</a> <a id="8271" href="Complex-Model.IOledger.IOledger-votingexample.html#8057" class="Bound">stIO</a> <a id="8276" class="Symbol">(</a><a id="8277" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="8287" class="Number">10</a> <a id="8290" href="Complex-Model.IOledger.IOledger-votingexample.html#8225" class="Bound">line</a><a id="8294" class="Symbol">)</a>

  <a id="executeLedger-ChangeCallingAddressAux"></a><a id="8299" href="Complex-Model.IOledger.IOledger-votingexample.html#8299" class="Function">executeLedger-ChangeCallingAddressAux</a>  <a id="8338" class="Symbol">:</a> <a id="8340" class="Symbol">∀{</a><a id="8342" href="Complex-Model.IOledger.IOledger-votingexample.html#8342" class="Bound">i</a><a id="8343" class="Symbol">}</a> <a id="8345" class="Symbol">→</a> <a id="8347" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="8355" class="Symbol">→</a> <a id="8357" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="8363" href="basicDataStructure.html#405" class="Function">Address</a> <a id="8371" class="Symbol">→</a> <a id="8373" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="8383" href="Complex-Model.IOledger.IOledger-votingexample.html#8342" class="Bound">i</a> <a id="8385" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="8392" href="Complex-Model.IOledger.IOledger-votingexample.html#8299" class="Function">executeLedger-ChangeCallingAddressAux</a> <a id="8430" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="8432" href="Complex-Model.IOledger.IOledger-votingexample.html#8432" class="Bound">ledger₁</a> <a id="8440" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="8448" href="Complex-Model.IOledger.IOledger-votingexample.html#8448" class="Bound">initialAddr₁</a> <a id="8461" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="8474" href="Complex-Model.IOledger.IOledger-votingexample.html#8474" class="Bound">gas₁</a> <a id="8479" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="8484" class="Symbol">(</a><a id="8485" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="8490" href="Complex-Model.IOledger.IOledger-votingexample.html#8490" class="Bound">callingAddr</a><a id="8501" class="Symbol">)</a>
            <a id="8515" class="Symbol">=</a> <a id="8517" href="Complex-Model.IOledger.IOledger-votingexample.html#1497" class="Function">executeLedger</a> <a id="8531" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="8533" href="Complex-Model.IOledger.IOledger-votingexample.html#8432" class="Bound">ledger₁</a> <a id="8541" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="8549" href="Complex-Model.IOledger.IOledger-votingexample.html#8490" class="Bound">callingAddr</a> <a id="8561" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="8574" href="Complex-Model.IOledger.IOledger-votingexample.html#8474" class="Bound">gas₁</a> <a id="8579" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a>
  <a id="8586" href="Complex-Model.IOledger.IOledger-votingexample.html#8299" class="Function">executeLedger-ChangeCallingAddressAux</a> <a id="8624" href="Complex-Model.IOledger.IOledger-votingexample.html#8624" class="Bound">stIO</a> <a id="8629" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="8637" class="Symbol">.</a><a id="8638" href="interface.Base.html#689" class="Field">force</a>
            <a id="8656" class="Symbol">=</a> <a id="8658" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="8664" class="Symbol">(</a><a id="8665" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="8674" class="String">&quot;Please enter the calling address as a natural number&quot;</a><a id="8728" class="Symbol">)</a>
              <a id="8744" class="Symbol">λ</a> <a id="8746" href="Complex-Model.IOledger.IOledger-votingexample.html#8746" class="Bound">_</a> <a id="8748" class="Symbol">→</a> <a id="8750" href="Complex-Model.IOledger.IOledger-votingexample.html#7949" class="Function">executeLedger-ChangeCallingAddress</a> <a id="8785" href="Complex-Model.IOledger.IOledger-votingexample.html#8624" class="Bound">stIO</a>




<a id="8794" class="Comment">-- program 4: Update the gas limit</a>
  <a id="executeLedger-updateGas"></a><a id="8831" href="Complex-Model.IOledger.IOledger-votingexample.html#8831" class="Function">executeLedger-updateGas</a>         <a id="8863" class="Symbol">:</a> <a id="8865" class="Symbol">∀{</a><a id="8867" href="Complex-Model.IOledger.IOledger-votingexample.html#8867" class="Bound">i</a><a id="8868" class="Symbol">}</a> <a id="8870" class="Symbol">→</a> <a id="8872" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="8880" class="Symbol">→</a> <a id="8882" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="8892" href="Complex-Model.IOledger.IOledger-votingexample.html#8867" class="Bound">i</a> <a id="8894" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="8901" href="Complex-Model.IOledger.IOledger-votingexample.html#8831" class="Function">executeLedger-updateGas</a> <a id="8925" href="Complex-Model.IOledger.IOledger-votingexample.html#8925" class="Bound">stIO</a> <a id="8930" class="Symbol">.</a><a id="8931" href="interface.Base.html#689" class="Field">force</a> <a id="8937" class="Symbol">=</a> <a id="8939" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="8945" class="Symbol">(</a><a id="8946" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="8955" class="String">&quot;Enter the new gas amount as a natural number&quot;</a><a id="9001" class="Symbol">)</a>
                                         <a id="9044" class="Symbol">λ</a> <a id="9046" href="Complex-Model.IOledger.IOledger-votingexample.html#9046" class="Bound">_</a> <a id="9048" class="Symbol">→</a> <a id="9050" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="9057" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>  <a id="9066" class="Symbol">λ</a> <a id="9068" href="Complex-Model.IOledger.IOledger-votingexample.html#9068" class="Bound">line</a> <a id="9073" class="Symbol">→</a> 
                                         <a id="9117" href="Complex-Model.IOledger.IOledger-votingexample.html#9179" class="Function">executeLedgerStep-updateGasAux</a> <a id="9148" href="Complex-Model.IOledger.IOledger-votingexample.html#8925" class="Bound">stIO</a> <a id="9153" class="Symbol">(</a><a id="9154" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="9164" class="Number">10</a> <a id="9167" href="Complex-Model.IOledger.IOledger-votingexample.html#9068" class="Bound">line</a><a id="9171" class="Symbol">)</a>

  
  <a id="executeLedgerStep-updateGasAux"></a><a id="9179" href="Complex-Model.IOledger.IOledger-votingexample.html#9179" class="Function">executeLedgerStep-updateGasAux</a>  <a id="9211" class="Symbol">:</a> <a id="9213" class="Symbol">∀{</a><a id="9215" href="Complex-Model.IOledger.IOledger-votingexample.html#9215" class="Bound">i</a><a id="9216" class="Symbol">}</a> <a id="9218" class="Symbol">→</a> <a id="9220" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="9228" class="Symbol">→</a> <a id="9230" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="9236" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="9238" class="Symbol">→</a> <a id="9240" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="9250" href="Complex-Model.IOledger.IOledger-votingexample.html#9215" class="Bound">i</a> <a id="9252" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="9259" href="Complex-Model.IOledger.IOledger-votingexample.html#9179" class="Function">executeLedgerStep-updateGasAux</a> <a id="9290" href="Complex-Model.IOledger.IOledger-votingexample.html#9290" class="Bound">stIO</a>  <a id="9296" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="9304" class="Symbol">.</a><a id="9305" href="interface.Base.html#689" class="Field">force</a>
                    <a id="9331" class="Symbol">=</a> <a id="9333" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="9339" class="Symbol">(</a><a id="9340" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="9349" class="String">&quot;Please enter a gas as a natural number&quot;</a><a id="9389" class="Symbol">)</a>
                      <a id="9413" class="Symbol">λ</a> <a id="9415" href="Complex-Model.IOledger.IOledger-votingexample.html#9415" class="Bound">_</a> <a id="9417" class="Symbol">→</a> <a id="9419" href="Complex-Model.IOledger.IOledger-votingexample.html#8831" class="Function">executeLedger-updateGas</a> <a id="9443" href="Complex-Model.IOledger.IOledger-votingexample.html#9290" class="Bound">stIO</a>

  <a id="9451" href="Complex-Model.IOledger.IOledger-votingexample.html#9179" class="Function">executeLedgerStep-updateGasAux</a> <a id="9482" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="9484" href="Complex-Model.IOledger.IOledger-votingexample.html#9484" class="Bound">ledger</a> <a id="9491" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="9499" href="Complex-Model.IOledger.IOledger-votingexample.html#9499" class="Bound">initialAddr</a> <a id="9511" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="9524" href="Complex-Model.IOledger.IOledger-votingexample.html#9524" class="Bound">gas</a> <a id="9528" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a>  <a id="9534" class="Symbol">(</a><a id="9535" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="9540" href="Complex-Model.IOledger.IOledger-votingexample.html#9540" class="Bound">gass</a><a id="9544" class="Symbol">)</a> <a id="9546" class="Symbol">.</a><a id="9547" href="interface.Base.html#689" class="Field">force</a>
                   <a id="9572" class="Symbol">=</a> <a id="9574" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="9580" class="Symbol">(</a><a id="9581" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="9590" class="Symbol">(</a><a id="9591" class="String">&quot;The gas amount has been updated successfully. \n The new gas amount is  &quot;</a> <a id="9666" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="9669" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="9674" href="Complex-Model.IOledger.IOledger-votingexample.html#9540" class="Bound">gass</a> <a id="9679" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="9682" class="String">&quot; wei&quot;</a>
                    <a id="9709" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="9712" class="String">&quot; and the old gas amount is &quot;</a> <a id="9742" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="9745" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="9750" href="Complex-Model.IOledger.IOledger-votingexample.html#9524" class="Bound">gas</a> <a id="9754" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="9757" class="String">&quot; wei&quot;</a> <a id="9764" class="Symbol">))</a>
                    <a id="9787" class="Symbol">λ</a> <a id="9789" href="Complex-Model.IOledger.IOledger-votingexample.html#9789" class="Bound">line</a> <a id="9794" class="Symbol">→</a> <a id="9796" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="9805" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="9807" href="Complex-Model.IOledger.IOledger-votingexample.html#9484" class="Bound">ledger</a> <a id="9814" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="9822" href="Complex-Model.IOledger.IOledger-votingexample.html#9499" class="Bound">initialAddr</a> <a id="9834" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="9847" href="Complex-Model.IOledger.IOledger-votingexample.html#9540" class="Bound">gass</a> <a id="9852" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a>




<a id="9861" class="Comment">-- program 5: Check the gas limit</a>

  <a id="executeLedger-checkGas"></a><a id="9898" href="Complex-Model.IOledger.IOledger-votingexample.html#9898" class="Function">executeLedger-checkGas</a> <a id="9921" class="Symbol">:</a> <a id="9923" class="Symbol">∀{</a><a id="9925" href="Complex-Model.IOledger.IOledger-votingexample.html#9925" class="Bound">i</a><a id="9926" class="Symbol">}</a> <a id="9928" class="Symbol">→</a> <a id="9930" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="9938" class="Symbol">→</a> <a id="9940" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="9950" href="Complex-Model.IOledger.IOledger-votingexample.html#9925" class="Bound">i</a> <a id="9952" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="9959" href="Complex-Model.IOledger.IOledger-votingexample.html#9898" class="Function">executeLedger-checkGas</a> <a id="9982" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="9984" href="Complex-Model.IOledger.IOledger-votingexample.html#9984" class="Bound">ledger</a> <a id="9991" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="9999" href="Complex-Model.IOledger.IOledger-votingexample.html#9999" class="Bound">initialAddr</a> <a id="10011" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="10024" href="Complex-Model.IOledger.IOledger-votingexample.html#10024" class="Bound">gas</a> <a id="10028" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a>  <a id="10034" class="Symbol">.</a><a id="10035" href="interface.Base.html#689" class="Field">force</a>
                   <a id="10060" class="Symbol">=</a> <a id="10062" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="10068" class="Symbol">(</a><a id="10069" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="10078" class="Symbol">(</a><a id="10079" class="String">&quot; The gas limit is &quot;</a>  <a id="10101" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="10104" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="10109" href="Complex-Model.IOledger.IOledger-votingexample.html#10024" class="Bound">gas</a> <a id="10113" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="10116" class="String">&quot; wei&quot;</a> <a id="10123" class="Symbol">))</a>
                           <a id="10153" class="Symbol">λ</a> <a id="10155" href="Complex-Model.IOledger.IOledger-votingexample.html#10155" class="Bound">line</a> <a id="10160" class="Symbol">→</a> <a id="10162" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="10171" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="10173" href="Complex-Model.IOledger.IOledger-votingexample.html#9984" class="Bound">ledger</a> <a id="10180" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="10188" href="Complex-Model.IOledger.IOledger-votingexample.html#9999" class="Bound">initialAddr</a> <a id="10200" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="10213" href="Complex-Model.IOledger.IOledger-votingexample.html#10024" class="Bound">gas</a> <a id="10217" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a>



<a id="10225" class="Comment">-- program 6: Check the pure function</a>

  <a id="executeLedger-purefunction"></a><a id="10266" href="Complex-Model.IOledger.IOledger-votingexample.html#10266" class="Function">executeLedger-purefunction</a>  <a id="10294" class="Symbol">:</a> <a id="10296" class="Symbol">∀{</a><a id="10298" href="Complex-Model.IOledger.IOledger-votingexample.html#10298" class="Bound">i</a><a id="10299" class="Symbol">}</a> <a id="10301" class="Symbol">→</a> <a id="10303" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="10311" class="Symbol">→</a> <a id="10313" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="10323" href="Complex-Model.IOledger.IOledger-votingexample.html#10298" class="Bound">i</a> <a id="10325" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="10332" href="Complex-Model.IOledger.IOledger-votingexample.html#10266" class="Function">executeLedger-purefunction</a> <a id="10359" href="Complex-Model.IOledger.IOledger-votingexample.html#10359" class="Bound">stIO</a> <a id="10364" class="Symbol">.</a><a id="10365" href="interface.Base.html#689" class="Field">force</a>
                         <a id="10396" class="Symbol">=</a> <a id="10398" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="10404" class="Symbol">(</a><a id="10405" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="10414" class="String">&quot;Enter the Calling Address as a natural number&quot;</a><a id="10461" class="Symbol">)</a>
                         <a id="10488" class="Symbol">λ</a> <a id="10490" href="Complex-Model.IOledger.IOledger-votingexample.html#10490" class="Bound">_</a> <a id="10492" class="Symbol">→</a> <a id="10494" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="10501" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>
                         <a id="10534" class="Symbol">λ</a> <a id="10536" href="Complex-Model.IOledger.IOledger-votingexample.html#10536" class="Bound">line</a> <a id="10541" class="Symbol">→</a>  <a id="10544" href="Complex-Model.IOledger.IOledger-votingexample.html#10601" class="Function">executeLedger-purefunction0</a> <a id="10572" href="Complex-Model.IOledger.IOledger-votingexample.html#10359" class="Bound">stIO</a> <a id="10577" class="Symbol">(</a><a id="10578" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="10588" class="Number">10</a> <a id="10591" href="Complex-Model.IOledger.IOledger-votingexample.html#10536" class="Bound">line</a><a id="10595" class="Symbol">)</a>


  <a id="executeLedger-purefunction0"></a><a id="10601" href="Complex-Model.IOledger.IOledger-votingexample.html#10601" class="Function">executeLedger-purefunction0</a> <a id="10629" class="Symbol">:</a> <a id="10631" class="Symbol">∀{</a><a id="10633" href="Complex-Model.IOledger.IOledger-votingexample.html#10633" class="Bound">i</a><a id="10634" class="Symbol">}</a> <a id="10636" class="Symbol">→</a> <a id="10638" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a>  <a id="10647" class="Symbol">→</a> <a id="10649" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="10655" href="basicDataStructure.html#405" class="Function">Address</a> <a id="10663" class="Symbol">→</a> <a id="10665" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="10675" href="Complex-Model.IOledger.IOledger-votingexample.html#10633" class="Bound">i</a> <a id="10677" href="interface.Unit.html#38" class="Record">Unit</a>  
  <a id="10686" href="Complex-Model.IOledger.IOledger-votingexample.html#10601" class="Function">executeLedger-purefunction0</a> <a id="10714" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="10716" href="Complex-Model.IOledger.IOledger-votingexample.html#10716" class="Bound">ledger₁</a> <a id="10724" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="10732" href="Complex-Model.IOledger.IOledger-votingexample.html#10732" class="Bound">initialAddr₁</a> <a id="10745" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="10758" href="Complex-Model.IOledger.IOledger-votingexample.html#10758" class="Bound">gas₁</a> <a id="10763" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="10768" class="Symbol">(</a><a id="10769" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="10774" href="Complex-Model.IOledger.IOledger-votingexample.html#10774" class="Bound">callingAddr</a><a id="10785" class="Symbol">)</a>
            <a id="10799" class="Symbol">=</a> <a id="10801" href="Complex-Model.IOledger.IOledger-votingexample.html#11071" class="Function">executeLedger-purefunction1</a> <a id="10829" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="10831" href="Complex-Model.IOledger.IOledger-votingexample.html#10716" class="Bound">ledger₁</a> <a id="10839" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="10847" href="Complex-Model.IOledger.IOledger-votingexample.html#10774" class="Bound">callingAddr</a> <a id="10859" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="10872" href="Complex-Model.IOledger.IOledger-votingexample.html#10758" class="Bound">gas₁</a> <a id="10877" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a>
  <a id="10884" href="Complex-Model.IOledger.IOledger-votingexample.html#10601" class="Function">executeLedger-purefunction0</a> <a id="10912" href="Complex-Model.IOledger.IOledger-votingexample.html#10912" class="Bound">stIO</a> <a id="10917" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="10925" class="Symbol">.</a><a id="10926" href="interface.Base.html#689" class="Field">force</a> <a id="10932" class="Symbol">=</a> <a id="10934" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="10940" class="Symbol">(</a><a id="10941" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="10950" class="String">&quot;Please enter as a natural number&quot;</a><a id="10984" class="Symbol">)</a>
                                        <a id="11026" class="Symbol">λ</a> <a id="11028" href="Complex-Model.IOledger.IOledger-votingexample.html#11028" class="Bound">_</a> <a id="11030" class="Symbol">→</a> <a id="11032" href="Complex-Model.IOledger.IOledger-votingexample.html#10266" class="Function">executeLedger-purefunction</a> <a id="11059" href="Complex-Model.IOledger.IOledger-votingexample.html#10912" class="Bound">stIO</a>


  
  <a id="executeLedger-purefunction1"></a><a id="11071" href="Complex-Model.IOledger.IOledger-votingexample.html#11071" class="Function">executeLedger-purefunction1</a>  <a id="11100" class="Symbol">:</a> <a id="11102" class="Symbol">∀{</a><a id="11104" href="Complex-Model.IOledger.IOledger-votingexample.html#11104" class="Bound">i</a><a id="11105" class="Symbol">}</a> <a id="11107" class="Symbol">→</a> <a id="11109" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="11117" class="Symbol">→</a> <a id="11119" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="11129" href="Complex-Model.IOledger.IOledger-votingexample.html#11104" class="Bound">i</a> <a id="11131" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="11138" href="Complex-Model.IOledger.IOledger-votingexample.html#11071" class="Function">executeLedger-purefunction1</a> <a id="11166" href="Complex-Model.IOledger.IOledger-votingexample.html#11166" class="Bound">stIO</a> <a id="11171" class="Symbol">.</a><a id="11172" href="interface.Base.html#689" class="Field">force</a> <a id="11178" class="Symbol">=</a>
                             <a id="11209" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="11215" class="Symbol">(</a><a id="11216" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="11225" class="String">&quot;Enter the Called Address as a natural number&quot;</a><a id="11271" class="Symbol">)</a>
                             <a id="11302" class="Symbol">λ</a> <a id="11304" href="Complex-Model.IOledger.IOledger-votingexample.html#11304" class="Bound">_</a> <a id="11306" class="Symbol">→</a> <a id="11308" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="11315" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> <a id="11323" class="Symbol">λ</a> <a id="11325" href="Complex-Model.IOledger.IOledger-votingexample.html#11325" class="Bound">line</a> <a id="11330" class="Symbol">→</a>
                            <a id="11360" href="Complex-Model.IOledger.IOledger-votingexample.html#11421" class="Function">executeLedger-purefunStep1-2</a> <a id="11389" href="Complex-Model.IOledger.IOledger-votingexample.html#11166" class="Bound">stIO</a> <a id="11394" class="Symbol">(</a><a id="11395" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="11405" class="Number">10</a> <a id="11408" href="Complex-Model.IOledger.IOledger-votingexample.html#11325" class="Bound">line</a><a id="11412" class="Symbol">)</a>


  
  <a id="executeLedger-purefunStep1-2"></a><a id="11421" href="Complex-Model.IOledger.IOledger-votingexample.html#11421" class="Function">executeLedger-purefunStep1-2</a> <a id="11450" class="Symbol">:</a> <a id="11452" class="Symbol">∀{</a><a id="11454" href="Complex-Model.IOledger.IOledger-votingexample.html#11454" class="Bound">i</a><a id="11455" class="Symbol">}</a> <a id="11457" class="Symbol">→</a> <a id="11459" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a>  <a id="11468" class="Symbol">→</a> <a id="11470" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="11476" href="basicDataStructure.html#405" class="Function">Address</a> <a id="11484" class="Symbol">→</a> <a id="11486" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="11496" href="Complex-Model.IOledger.IOledger-votingexample.html#11454" class="Bound">i</a> <a id="11498" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="11505" href="Complex-Model.IOledger.IOledger-votingexample.html#11421" class="Function">executeLedger-purefunStep1-2</a> <a id="11534" href="Complex-Model.IOledger.IOledger-votingexample.html#11534" class="Bound">stIO</a> <a id="11539" class="Symbol">(</a><a id="11540" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="11545" href="Complex-Model.IOledger.IOledger-votingexample.html#11545" class="Bound">calledAddr</a><a id="11555" class="Symbol">)</a> <a id="11557" class="Symbol">.</a><a id="11558" href="interface.Base.html#689" class="Field">force</a> <a id="11564" class="Symbol">=</a>
                             <a id="11595" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="11601" class="Symbol">(</a><a id="11602" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="11611" class="String">&quot;Enter the pure function as counter or checkVoter&quot;</a><a id="11661" class="Symbol">)</a>
                             <a id="11692" class="Symbol">λ</a> <a id="11694" href="Complex-Model.IOledger.IOledger-votingexample.html#11694" class="Bound">_</a> <a id="11696" class="Symbol">→</a> <a id="11698" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="11705" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> <a id="11713" class="Symbol">λ</a> <a id="11715" href="Complex-Model.IOledger.IOledger-votingexample.html#11715" class="Bound">line</a> <a id="11720" class="Symbol">→</a>  
                             <a id="11753" href="Complex-Model.IOledger.IOledger-votingexample.html#12045" class="Function">executeLedger-purefunStep1-3</a> <a id="11782" href="Complex-Model.IOledger.IOledger-votingexample.html#11534" class="Bound">stIO</a> <a id="11787" href="Complex-Model.IOledger.IOledger-votingexample.html#11545" class="Bound">calledAddr</a> <a id="11798" class="Symbol">(</a><a id="11799" href="libraries.IOlibrary.html#769" class="Function">string2FunctionName</a> <a id="11819" href="Complex-Model.IOledger.IOledger-votingexample.html#11715" class="Bound">line</a><a id="11823" class="Symbol">)</a>
  <a id="11827" href="Complex-Model.IOledger.IOledger-votingexample.html#11421" class="Function">executeLedger-purefunStep1-2</a> <a id="11856" href="Complex-Model.IOledger.IOledger-votingexample.html#11856" class="Bound">stIO</a> <a id="11861" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="11869" class="Symbol">.</a><a id="11870" href="interface.Base.html#689" class="Field">force</a> <a id="11876" class="Symbol">=</a>
                             <a id="11907" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="11913" class="Symbol">(</a><a id="11914" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="11923" class="String">&quot;Please enter an address as a natural number&quot;</a><a id="11968" class="Symbol">)</a>
                             <a id="11999" class="Symbol">λ</a> <a id="12001" href="Complex-Model.IOledger.IOledger-votingexample.html#12001" class="Bound">_</a> <a id="12003" class="Symbol">→</a> <a id="12005" href="Complex-Model.IOledger.IOledger-votingexample.html#11071" class="Function">executeLedger-purefunction1</a> <a id="12033" href="Complex-Model.IOledger.IOledger-votingexample.html#11856" class="Bound">stIO</a>


  
  <a id="executeLedger-purefunStep1-3"></a><a id="12045" href="Complex-Model.IOledger.IOledger-votingexample.html#12045" class="Function">executeLedger-purefunStep1-3</a> <a id="12074" class="Symbol">:</a> <a id="12076" class="Symbol">∀{</a><a id="12078" href="Complex-Model.IOledger.IOledger-votingexample.html#12078" class="Bound">i</a><a id="12079" class="Symbol">}</a> <a id="12081" class="Symbol">→</a> <a id="12083" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="12091" class="Symbol">→</a> <a id="12093" class="Symbol">(</a><a id="12094" href="Complex-Model.IOledger.IOledger-votingexample.html#12094" class="Bound">calledAddr</a> <a id="12105" class="Symbol">:</a> <a id="12107" href="basicDataStructure.html#405" class="Function">Address</a><a id="12114" class="Symbol">)</a> <a id="12116" class="Symbol">→</a> <a id="12118" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="12124" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="12137" class="Symbol">→</a> <a id="12139" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="12149" href="Complex-Model.IOledger.IOledger-votingexample.html#12078" class="Bound">i</a> <a id="12151" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="12158" href="Complex-Model.IOledger.IOledger-votingexample.html#12045" class="Function">executeLedger-purefunStep1-3</a> <a id="12187" href="Complex-Model.IOledger.IOledger-votingexample.html#12187" class="Bound">stIO</a> <a id="12192" href="Complex-Model.IOledger.IOledger-votingexample.html#12192" class="Bound">calledAddr</a> <a id="12203" class="Symbol">(</a><a id="12204" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="12209" href="Complex-Model.IOledger.IOledger-votingexample.html#12209" class="Bound">f</a><a id="12210" class="Symbol">)</a> <a id="12212" class="Symbol">.</a><a id="12213" href="interface.Base.html#689" class="Field">force</a>
                            <a id="12247" class="Symbol">=</a> <a id="12249" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="12255" class="Symbol">(</a><a id="12256" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="12265" class="String">&quot;Enter the argument of the function name as a natural number&quot;</a><a id="12326" class="Symbol">)</a>
                              <a id="12358" class="Symbol">λ</a> <a id="12360" href="Complex-Model.IOledger.IOledger-votingexample.html#12360" class="Bound">_</a> <a id="12362" class="Symbol">→</a> <a id="12364" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="12371" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> <a id="12379" class="Symbol">λ</a> <a id="12381" href="Complex-Model.IOledger.IOledger-votingexample.html#12381" class="Bound">line</a> <a id="12386" class="Symbol">→</a>  
                              <a id="12420" href="Complex-Model.IOledger.IOledger-votingexample.html#12732" class="Function">executeLedger-purefunStep1-4</a> <a id="12449" href="Complex-Model.IOledger.IOledger-votingexample.html#12187" class="Bound">stIO</a> <a id="12454" href="Complex-Model.IOledger.IOledger-votingexample.html#12192" class="Bound">calledAddr</a> <a id="12465" href="Complex-Model.IOledger.IOledger-votingexample.html#12209" class="Bound">f</a> <a id="12467" class="Symbol">(</a><a id="12468" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="12478" class="Number">10</a> <a id="12481" href="Complex-Model.IOledger.IOledger-votingexample.html#12381" class="Bound">line</a><a id="12485" class="Symbol">)</a>
  <a id="12489" href="Complex-Model.IOledger.IOledger-votingexample.html#12045" class="Function">executeLedger-purefunStep1-3</a> <a id="12518" href="Complex-Model.IOledger.IOledger-votingexample.html#12518" class="Bound">stIO</a> <a id="12523" href="Complex-Model.IOledger.IOledger-votingexample.html#12523" class="Bound">calledAddr</a> <a id="12534" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="12543" class="Symbol">.</a><a id="12544" href="interface.Base.html#689" class="Field">force</a>
                            <a id="12578" class="Symbol">=</a> <a id="12580" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="12586" class="Symbol">(</a><a id="12587" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="12596" class="String">&quot;Please enter a functionname as string&quot;</a><a id="12635" class="Symbol">)</a>
                              <a id="12667" class="Symbol">λ</a> <a id="12669" href="Complex-Model.IOledger.IOledger-votingexample.html#12669" class="Bound">_</a> <a id="12671" class="Symbol">→</a> <a id="12673" href="Complex-Model.IOledger.IOledger-votingexample.html#11421" class="Function">executeLedger-purefunStep1-2</a> <a id="12702" href="Complex-Model.IOledger.IOledger-votingexample.html#12518" class="Bound">stIO</a> <a id="12707" class="Symbol">(</a><a id="12708" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="12713" href="Complex-Model.IOledger.IOledger-votingexample.html#12523" class="Bound">calledAddr</a><a id="12723" class="Symbol">)</a>


  
  <a id="executeLedger-purefunStep1-4"></a><a id="12732" href="Complex-Model.IOledger.IOledger-votingexample.html#12732" class="Function">executeLedger-purefunStep1-4</a> <a id="12761" class="Symbol">:</a> <a id="12763" class="Symbol">∀{</a><a id="12765" href="Complex-Model.IOledger.IOledger-votingexample.html#12765" class="Bound">i</a><a id="12766" class="Symbol">}</a> <a id="12768" class="Symbol">→</a> <a id="12770" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="12778" class="Symbol">→</a> <a id="12780" class="Symbol">(</a><a id="12781" href="Complex-Model.IOledger.IOledger-votingexample.html#12781" class="Bound">calledAddr</a> <a id="12792" class="Symbol">:</a> <a id="12794" href="basicDataStructure.html#405" class="Function">Address</a><a id="12801" class="Symbol">)</a> <a id="12803" class="Symbol">→</a> <a id="12805" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="12818" class="Symbol">→</a> <a id="12820" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="12826" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="12828" class="Symbol">→</a> <a id="12830" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="12840" href="Complex-Model.IOledger.IOledger-votingexample.html#12765" class="Bound">i</a> <a id="12842" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="12849" href="Complex-Model.IOledger.IOledger-votingexample.html#12732" class="Function">executeLedger-purefunStep1-4</a> <a id="12878" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="12880" href="Complex-Model.IOledger.IOledger-votingexample.html#12880" class="Bound">ledger</a> <a id="12887" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="12895" href="Complex-Model.IOledger.IOledger-votingexample.html#12895" class="Bound">initialAddr</a> <a id="12907" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="12920" href="Complex-Model.IOledger.IOledger-votingexample.html#12920" class="Bound">gas</a> <a id="12924" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a> <a id="12929" href="Complex-Model.IOledger.IOledger-votingexample.html#12929" class="Bound">calledAddr</a> <a id="12940" href="Complex-Model.IOledger.IOledger-votingexample.html#12940" class="Bound">f</a> <a id="12942" class="Symbol">(</a><a id="12943" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="12948" href="Complex-Model.IOledger.IOledger-votingexample.html#12948" class="Bound">m</a><a id="12949" class="Symbol">)</a> <a id="12951" class="Symbol">.</a><a id="12952" href="interface.Base.html#689" class="Field">force</a>
                                    <a id="12994" class="Symbol">=</a> <a id="12996" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="13002" class="Symbol">(</a><a id="13003" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="13012" class="String">&quot;The information you get is below:  &quot;</a><a id="13049" class="Symbol">)</a>
                                    <a id="13087" class="Symbol">λ</a> <a id="13089" href="Complex-Model.IOledger.IOledger-votingexample.html#13089" class="Bound">_</a> <a id="13091" class="Symbol">→</a> <a id="13093" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="13100" class="Symbol">(</a><a id="13101" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="13110" class="Symbol">(</a><a id="13111" class="String">&quot;\n The initial address is &quot;</a> <a id="13140" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="13143" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="13148" href="Complex-Model.IOledger.IOledger-votingexample.html#12895" class="Bound">initialAddr</a> <a id="13160" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                                    <a id="13199" class="String">&quot;\n The called address is &quot;</a>  <a id="13228" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="13231" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="13236" href="Complex-Model.IOledger.IOledger-votingexample.html#12929" class="Bound">calledAddr</a> <a id="13247" href="Data.String.Base.html#2366" class="Function Operator">++</a>
                                    <a id="13286" class="String">&quot;\n The pure function returns &quot;</a> <a id="13318" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="13321" href="Complex-Model.IOledger.IOledger-votingexample.html#1212" class="Function">initialfun2Str</a> <a id="13336" class="Symbol">(</a><a id="13337" href="Complex-Model.IOledger.IOledger-votingexample.html#12880" class="Bound">ledger</a> <a id="13344" href="Complex-Model.IOledger.IOledger-votingexample.html#12929" class="Bound">calledAddr</a> <a id="13355" class="Symbol">.</a><a id="13356" href="libraries.Mainlibrary.html#931" class="Field">purefunction</a> <a id="13369" href="Complex-Model.IOledger.IOledger-votingexample.html#12940" class="Bound">f</a> <a id="13371" class="Symbol">(</a><a id="13372" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="13376" href="Complex-Model.IOledger.IOledger-votingexample.html#12948" class="Bound">m</a><a id="13377" class="Symbol">))))</a>
                                    <a id="13418" class="Symbol">λ</a> <a id="13420" href="Complex-Model.IOledger.IOledger-votingexample.html#13420" class="Bound">_</a> <a id="13422" class="Symbol">→</a>  <a id="13425" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="13434" class="Symbol">(</a><a id="13435" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨</a> <a id="13437" href="Complex-Model.IOledger.IOledger-votingexample.html#12880" class="Bound">ledger</a> <a id="13444" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">ledger,</a> <a id="13452" href="Complex-Model.IOledger.IOledger-votingexample.html#12895" class="Bound">initialAddr</a> <a id="13464" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">initialAddr,</a> <a id="13477" href="Complex-Model.IOledger.IOledger-votingexample.html#12920" class="Bound">gas</a> <a id="13481" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">gas⟩</a><a id="13485" class="Symbol">)</a>
  <a id="13489" href="Complex-Model.IOledger.IOledger-votingexample.html#12732" class="Function">executeLedger-purefunStep1-4</a> <a id="13518" href="Complex-Model.IOledger.IOledger-votingexample.html#13518" class="Bound">stIO</a> <a id="13523" href="Complex-Model.IOledger.IOledger-votingexample.html#13523" class="Bound">calledAddr</a> <a id="13534" href="Complex-Model.IOledger.IOledger-votingexample.html#13534" class="Bound">f</a> <a id="13536" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a>  <a id="13545" class="Symbol">.</a><a id="13546" href="interface.Base.html#689" class="Field">force</a>
                                    <a id="13588" class="Symbol">=</a> <a id="13590" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="13596" class="Symbol">(</a><a id="13597" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="13606" class="String">&quot;Please enter the argument of the function name as a natural number&quot;</a><a id="13674" class="Symbol">)</a> <a id="13676" class="Symbol">λ</a> <a id="13678" href="Complex-Model.IOledger.IOledger-votingexample.html#13678" class="Bound">_</a> <a id="13680" class="Symbol">→</a>
                                      <a id="13720" href="Complex-Model.IOledger.IOledger-votingexample.html#12045" class="Function">executeLedger-purefunStep1-3</a> <a id="13749" href="Complex-Model.IOledger.IOledger-votingexample.html#13518" class="Bound">stIO</a>  <a id="13755" href="Complex-Model.IOledger.IOledger-votingexample.html#13523" class="Bound">calledAddr</a> <a id="13766" class="Symbol">(</a><a id="13767" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="13772" href="Complex-Model.IOledger.IOledger-votingexample.html#13534" class="Bound">f</a><a id="13773" class="Symbol">)</a>



<a id="13778" class="Comment">-- define our interface</a>
  <a id="mainBody"></a><a id="13804" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="13813" class="Symbol">:</a> <a id="13815" class="Symbol">∀{</a><a id="13817" href="Complex-Model.IOledger.IOledger-votingexample.html#13817" class="Bound">i</a><a id="13818" class="Symbol">}</a> <a id="13820" class="Symbol">→</a> <a id="13822" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a> <a id="13830" class="Symbol">→</a> <a id="13832" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="13842" href="Complex-Model.IOledger.IOledger-votingexample.html#13817" class="Bound">i</a> <a id="13844" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="13851" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="13860" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a> <a id="13865" class="Symbol">.</a><a id="13866" href="interface.Base.html#689" class="Field">force</a>
    <a id="13876" class="Symbol">=</a> <a id="13878" href="interface.ConsoleLib.html#536" class="Function">WriteString&#39;</a> <a id="13891" class="Symbol">(</a><a id="13892" class="String">&quot;Please choose one of them:
                    1- Execute a function of a contract.
                    2- Look up the balance of one contract.
                    3- Change the calling address.
                    4- Update the gas limit.
                    5- Check the gas limit.
                    6- Check the pure function.
                    7- Terminate the program.&quot;</a><a id="14271" class="Symbol">)</a>
     <a id="14278" class="Symbol">λ</a> <a id="14280" href="Complex-Model.IOledger.IOledger-votingexample.html#14280" class="Bound">str</a> <a id="14284" class="Symbol">→</a> <a id="14286" class="Symbol">(</a><a id="14287" href="interface.ConsoleLib.html#698" class="Function">GetLine</a> <a id="14295" href="interface.Base.html#1801" class="Function Operator">&gt;&gt;=</a> <a id="14299" class="Symbol">λ</a> <a id="14301" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14305" class="Symbol">→</a>
     <a id="14312" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14315" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a>  <a id="14320" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14323" class="String">&quot;1&quot;</a> <a id="14327" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="14332" href="Complex-Model.IOledger.IOledger-votingexample.html#1497" class="Function">executeLedger</a> <a id="14346" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a>
     <a id="14356" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14361" class="Symbol">(</a><a id="14362" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14365" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14369" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14372" class="String">&quot;2&quot;</a> <a id="14376" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>  <a id="14382" href="Complex-Model.IOledger.IOledger-votingexample.html#6605" class="Function">executeLedger-CheckBalance</a> <a id="14409" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a>
     <a id="14419" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14424" class="Symbol">(</a><a id="14425" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14428" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14432" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14435" class="String">&quot;3&quot;</a>
                  <a id="14457" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="14462" href="Complex-Model.IOledger.IOledger-votingexample.html#7949" class="Function">executeLedger-ChangeCallingAddress</a> <a id="14497" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a>
     <a id="14507" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14512" class="Symbol">(</a><a id="14513" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14516" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14520" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14523" class="String">&quot;4&quot;</a> <a id="14527" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="14532" href="Complex-Model.IOledger.IOledger-votingexample.html#8831" class="Function">executeLedger-updateGas</a> <a id="14556" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a>
     <a id="14566" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14571" class="Symbol">(</a><a id="14572" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14575" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14579" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14582" class="String">&quot;5&quot;</a> <a id="14586" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="14591" href="Complex-Model.IOledger.IOledger-votingexample.html#9898" class="Function">executeLedger-checkGas</a> <a id="14614" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a>
     <a id="14624" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14629" class="Symbol">(</a><a id="14630" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14633" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14637" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14640" class="String">&quot;6&quot;</a> <a id="14644" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="14649" href="Complex-Model.IOledger.IOledger-votingexample.html#10266" class="Function">executeLedger-purefunction</a> <a id="14676" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a>
     <a id="14686" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14691" class="Symbol">(</a><a id="14692" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="14695" href="Complex-Model.IOledger.IOledger-votingexample.html#14301" class="Bound">str</a> <a id="14699" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="14702" class="String">&quot;7&quot;</a>
                  <a id="14724" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="14729" href="interface.ConsoleLib.html#375" class="Function">WriteString</a> <a id="14741" class="String">&quot;The program is terminated&quot;</a>
     <a id="14774" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="14779" href="Complex-Model.IOledger.IOledger-votingexample.html#13804" class="Function">mainBody</a> <a id="14788" href="Complex-Model.IOledger.IOledger-votingexample.html#13860" class="Bound">stIO</a><a id="14792" class="Symbol">)))))))</a>




</pre></body></html>