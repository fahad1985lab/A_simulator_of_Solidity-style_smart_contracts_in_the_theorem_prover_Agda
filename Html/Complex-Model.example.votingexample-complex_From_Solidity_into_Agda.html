<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.votingexample-complex_From_Solidity_into_Agda</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html" class="Module Operator">Complex-Model.example.votingexample-complex_From_Solidity_into_Agda</a>  <a id="109" class="Keyword">where</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Data.List.html" class="Module">Data.List</a>
<a id="137" class="Keyword">open</a> <a id="142" class="Keyword">import</a> <a id="149" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="194" class="Keyword">open</a> <a id="199" class="Keyword">import</a> <a id="206" href="Data.Product.html" class="Module">Data.Product</a> <a id="219" class="Keyword">renaming</a> <a id="228" class="Symbol">(</a><a id="229" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="233" class="Symbol">to</a> <a id="236" class="InductiveConstructor Operator">_,,_</a> <a id="241" class="Symbol">)</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="266" class="Keyword">hiding</a> <a id="273" class="Symbol">(</a><a id="274" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="279" class="Symbol">)</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="359" class="Keyword">hiding</a> <a id="366" class="Symbol">(</a><a id="367" href="Data.Fin.Base.html#5404" class="Function Operator">_+_</a><a id="370" class="Symbol">;</a> <a id="372" href="Data.Fin.Base.html#5540" class="Function Operator">_-_</a><a id="375" class="Symbol">)</a>
<a id="377" class="Keyword">import</a> <a id="384" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="422" class="Symbol">as</a> <a id="425" class="Module">Eq</a>
<a id="428" class="Keyword">open</a> <a id="433" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="436" class="Keyword">using</a> <a id="442" class="Symbol">(</a><a id="443" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a> <a id="447" class="Symbol">;</a> <a id="449" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="454" class="Symbol">;</a> <a id="456" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="460" class="Symbol">;</a> <a id="462" href="Relation.Binary.PropositionalEquality.Core.html#1130" class="Function">cong</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="497" class="Keyword">using</a> <a id="503" class="Symbol">(</a><a id="504" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="507" class="Symbol">;</a> <a id="509" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="512" class="Symbol">)</a>


<a id="516" class="Comment">--our work</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a>  <a id="540" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="Complex-Model.ledgerversion.Ledger-Complex-Model.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model</a> <a id="622" href="constantparameters.html#837" class="Function">exampleParameters</a>
<a id="640" class="Keyword">open</a> <a id="645" class="Keyword">import</a> <a id="652" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="694" class="Keyword">open</a> <a id="699" class="Keyword">import</a> <a id="706" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="725" class="Keyword">open</a> <a id="730" class="Keyword">import</a> <a id="737" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>
<a id="758" class="Keyword">open</a> <a id="763" class="Keyword">import</a> <a id="770" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a>
<a id="790" class="Keyword">open</a> <a id="795" class="Keyword">import</a> <a id="802" href="Complex-Model.IOledger.IOledger-votingexample.html" class="Module">Complex-Model.IOledger.IOledger-votingexample</a>
<a id="848" class="Keyword">open</a> <a id="853" class="Keyword">import</a> <a id="860" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>



<a id="885" class="Comment">--define increment aux</a>
<a id="incrementAux"></a><a id="908" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#908" class="Function">incrementAux</a> <a id="921" class="Symbol">:</a> <a id="923" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a> <a id="934" class="Symbol">→</a> <a id="936" href="Complex-Model.ccomand.ccommands-cresponse.html#1546" class="Datatype">SmartContract</a> <a id="950" href="basicDataStructure.html#523" class="Datatype">Msg</a>
<a id="954" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#908" class="Function">incrementAux</a> <a id="967" class="Symbol">(</a><a id="968" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="975" class="Symbol">(</a><a id="976" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="980" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#980" class="Bound">n</a><a id="981" class="Symbol">))</a> <a id="984" class="Symbol">=</a> <a id="986" class="Symbol">(</a><a id="987" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="992" class="Symbol">(</a><a id="993" href="Complex-Model.ccomand.ccommands-cresponse.html#550" class="InductiveConstructor">updatec</a> <a id="1001" class="String">&quot;counter&quot;</a> <a id="1011" class="Symbol">(λ</a> <a id="1014" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1014" class="Bound">_</a> <a id="1016" class="Symbol">→</a> <a id="1018" class="Symbol">λ</a> <a id="1020" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1020" class="Bound">msg</a> <a id="1024" class="Symbol">→</a> <a id="1026" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="1033" class="Symbol">(</a><a id="1034" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1038" class="Symbol">(</a><a id="1039" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1043" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#980" class="Bound">n</a><a id="1044" class="Symbol">)))</a> <a id="1048" class="Symbol">λ</a> <a id="1050" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1050" class="Bound">oldFun</a> <a id="1057" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1057" class="Bound">oldcost</a> <a id="1065" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1065" class="Bound">msg</a> <a id="1069" class="Symbol">→</a> <a id="1071" class="Number">1</a><a id="1072" class="Symbol">)</a>
                                                          <a id="1132" class="Symbol">(λ</a> <a id="1135" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1135" class="Bound">n</a> <a id="1137" class="Symbol">→</a> <a id="1139" class="Number">1</a><a id="1140" class="Symbol">))</a> <a id="1143" class="Symbol">λ</a> <a id="1145" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1145" class="Bound">x</a> <a id="1147" class="Symbol">→</a> <a id="1149" href="Complex-Model.ccomand.ccommands-cresponse.html#1586" class="InductiveConstructor">return</a> <a id="1156" class="Number">1</a> <a id="1158" class="Symbol">(</a><a id="1159" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1163" class="Symbol">(</a><a id="1164" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1168" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#980" class="Bound">n</a><a id="1169" class="Symbol">))</a>
<a id="1172" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#908" class="CatchallClause Function">incrementAux</a><a id="1184" class="CatchallClause"> </a><a id="1185" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1185" class="CatchallClause Bound">ow</a> <a id="1188" class="Symbol">=</a> <a id="1190" href="Complex-Model.ccomand.ccommands-cresponse.html#1624" class="InductiveConstructor">error</a> <a id="1196" class="Symbol">(</a><a id="1197" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="1204" class="String">&quot;counter returns not a number&quot;</a><a id="1234" class="Symbol">)</a> <a id="1236" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1238" class="Number">0</a> <a id="1240" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1243" class="Number">0</a> <a id="1245" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="1247" class="String">&quot;increment&quot;</a> <a id="1259" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="1261" class="Symbol">(</a><a id="1262" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1266" class="Number">0</a><a id="1267" class="Symbol">)</a> <a id="1269" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a>

<a id="1273" class="Comment">--add voter function</a>
<a id="addVoterAux"></a><a id="1294" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1294" class="Function">addVoterAux</a> <a id="1306" class="Symbol">:</a> <a id="1308" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1312" class="Symbol">→</a> <a id="1314" class="Symbol">(</a><a id="1315" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1319" class="Symbol">→</a> <a id="1321" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a><a id="1331" class="Symbol">)</a> <a id="1333" class="Symbol">→</a> <a id="1335" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1339" class="Symbol">→</a> <a id="1341" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a>
<a id="1352" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1294" class="Function">addVoterAux</a> <a id="1364" class="Symbol">(</a><a id="1365" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1369" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1369" class="Bound">newaddr</a><a id="1376" class="Symbol">)</a> <a id="1378" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1378" class="Bound">oldCheckVoter</a> <a id="1392" class="Symbol">(</a><a id="1393" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1397" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1397" class="Bound">addr</a><a id="1401" class="Symbol">)</a> <a id="1403" class="Symbol">=</a>
    <a id="1409" href="Data.Bool.Base.html#1283" class="Function Operator">if</a>    <a id="1415" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1369" class="Bound">newaddr</a> <a id="1423" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1426" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1397" class="Bound">addr</a>
    <a id="1435" href="Data.Bool.Base.html#1283" class="Function Operator">then</a>  <a id="1441" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="1448" class="Symbol">(</a><a id="1449" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1453" class="Number">1</a><a id="1454" class="Symbol">)</a> <a id="1456" class="Comment">-- return 1 for true</a>
    <a id="1481" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>  <a id="1487" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1378" class="Bound">oldCheckVoter</a> <a id="1501" class="Symbol">(</a><a id="1502" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1506" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1397" class="Bound">addr</a><a id="1510" class="Symbol">)</a>
<a id="1512" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1294" class="CatchallClause Function">addVoterAux</a><a id="1523" class="CatchallClause"> </a><a id="1524" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1524" class="CatchallClause Bound">ow</a><a id="1526" class="CatchallClause"> </a><a id="1527" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1527" class="CatchallClause Bound">ow&#39;</a><a id="1530" class="CatchallClause"> </a><a id="1531" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1531" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1536" class="Symbol">=</a>
    <a id="1542" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="1546" class="Symbol">(</a><a id="1547" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="1554" class="String">&quot; You cannot add voter &quot;</a><a id="1578" class="Symbol">)</a>


<a id="1582" class="Comment">--delete voter function</a>
<a id="deleteVoterAux"></a><a id="1606" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1606" class="Function">deleteVoterAux</a> <a id="1621" class="Symbol">:</a> <a id="1623" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1627" class="Symbol">→</a> <a id="1629" class="Symbol">(</a><a id="1630" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1634" class="Symbol">→</a> <a id="1636" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a><a id="1646" class="Symbol">)</a> <a id="1648" class="Symbol">→</a> <a id="1650" class="Symbol">(</a><a id="1651" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1655" class="Symbol">→</a> <a id="1657" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a><a id="1667" class="Symbol">)</a>
<a id="1669" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1606" class="Function">deleteVoterAux</a> <a id="1684" class="Symbol">(</a><a id="1685" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1689" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1689" class="Bound">newaddr</a><a id="1696" class="Symbol">)</a> <a id="1698" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1698" class="Bound">oldCheckVoter</a> <a id="1712" class="Symbol">(</a><a id="1713" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1717" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1717" class="Bound">addr</a><a id="1721" class="Symbol">)</a> <a id="1723" class="Symbol">=</a>
     <a id="1730" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1733" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1689" class="Bound">newaddr</a> <a id="1741" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="1744" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1717" class="Bound">addr</a>
     <a id="1754" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1759" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="1766" class="Symbol">(</a><a id="1767" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1771" class="Number">0</a><a id="1772" class="Symbol">)</a> <a id="1774" class="Comment">--return 0 for true (means delete)  </a>
     <a id="1816" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1821" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1698" class="Bound">oldCheckVoter</a> <a id="1835" class="Symbol">(</a><a id="1836" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1840" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1717" class="Bound">addr</a><a id="1844" class="Symbol">)</a>
<a id="1846" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1606" class="CatchallClause Function">deleteVoterAux</a><a id="1860" class="CatchallClause"> </a><a id="1861" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1861" class="CatchallClause Bound">ow</a><a id="1863" class="CatchallClause"> </a><a id="1864" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1864" class="CatchallClause Bound">ow&#39;</a><a id="1867" class="CatchallClause"> </a><a id="1868" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1868" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="1873" class="Symbol">=</a> <a id="1875" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="1879" class="Symbol">(</a><a id="1880" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="1887" class="String">&quot; You cannot delete voter &quot;</a><a id="1914" class="Symbol">)</a>



<a id="mysuc"></a><a id="1919" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1919" class="Function">mysuc</a> <a id="1925" class="Symbol">:</a> <a id="1927" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a> <a id="1938" class="Symbol">→</a> <a id="1940" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a>
<a id="1951" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1919" class="Function">mysuc</a> <a id="1957" class="Symbol">(</a><a id="1958" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="1965" class="Symbol">(</a><a id="1966" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1970" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1970" class="Bound">n</a><a id="1971" class="Symbol">))</a> <a id="1974" class="Symbol">=</a> <a id="1976" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="1983" class="Symbol">(</a><a id="1984" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1988" class="Symbol">(</a><a id="1989" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1993" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1970" class="Bound">n</a><a id="1994" class="Symbol">))</a>
<a id="1997" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1919" class="CatchallClause Function">mysuc</a><a id="2002" class="CatchallClause"> </a><a id="2003" class="CatchallClause Symbol">(</a><a id="2004" href="basicDataStructure.html#1455" class="CatchallClause InductiveConstructor">theMsg</a><a id="2010" class="CatchallClause">  </a><a id="2012" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2012" class="CatchallClause Bound">ow</a><a id="2014" class="CatchallClause Symbol">)</a><a id="2015" class="Symbol">=</a> <a id="2017" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="2021" class="Symbol">(</a><a id="2022" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="2029" class="String">&quot; You cannot increment &quot;</a><a id="2053" class="Symbol">)</a>
<a id="2055" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1919" class="CatchallClause Function">mysuc</a><a id="2060" class="CatchallClause"> </a><a id="2061" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2061" class="CatchallClause Bound">ow</a> <a id="2064" class="Symbol">=</a> <a id="2066" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2061" class="Bound">ow</a>


<a id="2071" class="Comment">-- incrementAux for many candidates</a>
<a id="incrementcandidates"></a><a id="2107" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2107" class="Function">incrementcandidates</a> <a id="2127" class="Symbol">:</a> <a id="2129" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2131" class="Symbol">→</a> <a id="2133" class="Symbol">(</a><a id="2134" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="2138" class="Symbol">→</a> <a id="2140" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a><a id="2150" class="Symbol">)</a> <a id="2152" class="Symbol">→</a> <a id="2154" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="2158" class="Symbol">→</a> <a id="2160" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a>
<a id="2171" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2107" class="Function">incrementcandidates</a> <a id="2191" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2191" class="Bound">candidateVotedFor</a> <a id="2209" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2209" class="Bound">oldCounter</a> <a id="2220" class="Symbol">(</a><a id="2221" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="2225" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2225" class="Bound">candidate</a><a id="2234" class="Symbol">)</a> <a id="2236" class="Symbol">=</a> <a id="2238" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2241" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2191" class="Bound">candidateVotedFor</a> <a id="2259" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="2262" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2225" class="Bound">candidate</a>
                                                                   <a id="2339" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2344" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1919" class="Function">mysuc</a> <a id="2350" class="Symbol">(</a><a id="2351" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2209" class="Bound">oldCounter</a> <a id="2362" class="Symbol">(</a><a id="2363" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="2367" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2225" class="Bound">candidate</a><a id="2376" class="Symbol">))</a>
                                                                   <a id="2446" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2451" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2209" class="Bound">oldCounter</a> <a id="2462" class="Symbol">(</a><a id="2463" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="2467" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2225" class="Bound">candidate</a><a id="2476" class="Symbol">)</a>
<a id="2478" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2107" class="CatchallClause Function">incrementcandidates</a><a id="2497" class="CatchallClause"> </a><a id="2498" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2498" class="CatchallClause Bound">ow</a><a id="2500" class="CatchallClause"> </a><a id="2501" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2501" class="CatchallClause Bound">ow&#39;</a><a id="2504" class="CatchallClause"> </a><a id="2505" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2505" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="2510" class="Symbol">=</a> <a id="2512" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="2516" class="Symbol">(</a><a id="2517" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="2524" class="String">&quot; You cannot delete voter &quot;</a><a id="2551" class="Symbol">)</a>


<a id="incrementAux1"></a><a id="2555" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2555" class="Function">incrementAux1</a> <a id="2569" class="Symbol">:</a> <a id="2571" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a> <a id="2582" class="Symbol">→</a> <a id="2584" href="Complex-Model.ccomand.ccommands-cresponse.html#1546" class="Datatype">SmartContract</a> <a id="2598" href="basicDataStructure.html#523" class="Datatype">Msg</a>
<a id="2602" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2555" class="Function">incrementAux1</a> <a id="2616" class="Symbol">(</a><a id="2617" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="2624" class="Symbol">(</a><a id="2625" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="2629" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2629" class="Bound">candidate</a><a id="2638" class="Symbol">))</a> <a id="2641" class="Symbol">=</a> <a id="2643" class="Symbol">(</a><a id="2644" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="2649" class="Symbol">(</a><a id="2650" href="Complex-Model.ccomand.ccommands-cresponse.html#550" class="InductiveConstructor">updatec</a> <a id="2658" class="String">&quot;counter&quot;</a> <a id="2668" class="Symbol">(</a><a id="2669" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2107" class="Function">incrementcandidates</a> <a id="2689" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2629" class="Bound">candidate</a><a id="2698" class="Symbol">)</a> <a id="2700" class="Symbol">λ</a> <a id="2702" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2702" class="Bound">oldFun</a> <a id="2709" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2709" class="Bound">oldcost</a> <a id="2717" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2717" class="Bound">msg</a> <a id="2721" class="Symbol">→</a> <a id="2723" class="Number">1</a><a id="2724" class="Symbol">)</a>
                                                          <a id="2784" class="Symbol">(λ</a> <a id="2787" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2787" class="Bound">n</a> <a id="2789" class="Symbol">→</a> <a id="2791" class="Number">1</a><a id="2792" class="Symbol">))</a> <a id="2795" class="Symbol">λ</a> <a id="2797" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2797" class="Bound">x</a> <a id="2799" class="Symbol">→</a> <a id="2801" href="Complex-Model.ccomand.ccommands-cresponse.html#1586" class="InductiveConstructor">return</a> <a id="2808" class="Number">1</a> <a id="2810" class="Symbol">(</a><a id="2811" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="2815" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2629" class="Bound">candidate</a><a id="2824" class="Symbol">)</a>
<a id="2826" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2555" class="CatchallClause Function">incrementAux1</a><a id="2839" class="CatchallClause"> </a><a id="2840" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2840" class="CatchallClause Bound">ow</a> <a id="2843" class="Symbol">=</a> <a id="2845" href="Complex-Model.ccomand.ccommands-cresponse.html#1624" class="InductiveConstructor">error</a> <a id="2851" class="Symbol">(</a><a id="2852" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="2859" class="String">&quot;counter returns not a number&quot;</a><a id="2889" class="Symbol">)</a> <a id="2891" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="2893" class="Number">0</a> <a id="2895" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="2898" class="Number">0</a> <a id="2900" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="2902" class="String">&quot;increment&quot;</a> <a id="2914" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="2916" class="Symbol">(</a><a id="2917" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="2921" class="Number">0</a><a id="2922" class="Symbol">)</a> <a id="2924" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a>


<a id="2929" class="Comment">-- the voteAux function, we use it in case to check voter is allowed to vote or not</a>
<a id="3013" class="Comment">-- We have four cases as follows:</a>

<a id="3048" class="Comment">-- in case nat 0 it will return error and not allow to vote</a>
<a id="3108" class="Comment">-- in case suc (nat 1) it will allow to vote and it will call incrementAux to increment the counter</a>
<a id="3208" class="Comment">-- in case (nat (suc (suc _)))), it will return an error because the number not a boolean 0 (false) or 1 (true).</a>
<a id="3321" class="Comment">-- in case the result of checkvoter not a number, it will return an error message.</a>

<a id="voteAux"></a><a id="3405" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="Function">voteAux</a> <a id="3413" class="Symbol">:</a> <a id="3415" href="basicDataStructure.html#405" class="Function">Address</a> <a id="3423" class="Symbol">→</a> <a id="3425" href="basicDataStructure.html#1431" class="Datatype">MsgOrError</a> <a id="3436" class="Symbol">→</a> <a id="3438" class="Symbol">(</a><a id="3439" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3439" class="Bound">candidate</a> <a id="3449" class="Symbol">:</a> <a id="3451" href="basicDataStructure.html#523" class="Datatype">Msg</a><a id="3454" class="Symbol">)</a> <a id="3456" class="Symbol">→</a> <a id="3458" href="Complex-Model.ccomand.ccommands-cresponse.html#1546" class="Datatype">SmartContract</a> <a id="3472" href="basicDataStructure.html#523" class="Datatype">Msg</a>
<a id="3476" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="Function">voteAux</a> <a id="3484" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3484" class="Bound">addr</a> <a id="3489" class="Symbol">(</a><a id="3490" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="3497" class="Symbol">(</a><a id="3498" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="3502" class="Number">0</a><a id="3503" class="Symbol">))</a> <a id="3506" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3506" class="Bound">candidate</a>  <a id="3517" class="Symbol">=</a> <a id="3519" href="Complex-Model.ccomand.ccommands-cresponse.html#1624" class="InductiveConstructor">error</a> <a id="3525" class="Symbol">(</a><a id="3526" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="3533" class="String">&quot;The voter is not allowed to vote&quot;</a><a id="3567" class="Symbol">)</a>
                                           <a id="3612" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="3614" class="Number">0</a> <a id="3616" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="3619" class="Number">0</a> <a id="3621" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="3623" class="String">&quot;Voter is not allowed to vote&quot;</a> <a id="3654" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="3656" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="3660" class="Number">0</a> <a id="3662" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a>
                                           
<a id="3709" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="Function">voteAux</a> <a id="3717" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3717" class="Bound">addr</a> <a id="3722" class="Symbol">(</a><a id="3723" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="3730" class="Symbol">(</a><a id="3731" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="3735" class="Number">1</a><a id="3736" class="Symbol">))</a> <a id="3739" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3739" class="Bound">candidate</a> <a id="3749" class="Symbol">=</a> <a id="3751" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="3756" class="Symbol">(</a><a id="3757" href="Complex-Model.ccomand.ccommands-cresponse.html#550" class="InductiveConstructor">updatec</a> <a id="3765" class="String">&quot;checkVoter&quot;</a> <a id="3778" class="Symbol">(</a><a id="3779" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1606" class="Function">deleteVoterAux</a> <a id="3794" class="Symbol">(</a><a id="3795" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="3799" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3717" class="Bound">addr</a><a id="3803" class="Symbol">))</a> <a id="3806" class="Symbol">λ</a> <a id="3808" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3808" class="Bound">oldFun</a> <a id="3815" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3815" class="Bound">oldcost</a> <a id="3823" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3823" class="Bound">msg</a> <a id="3827" class="Symbol">→</a> <a id="3829" class="Number">1</a><a id="3830" class="Symbol">)</a>
                                          <a id="3874" class="Symbol">(λ</a> <a id="3877" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3877" class="Bound">_</a> <a id="3879" class="Symbol">→</a> <a id="3881" class="Number">1</a><a id="3882" class="Symbol">)</a> <a id="3884" class="Symbol">(λ</a> <a id="3887" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3887" class="Bound">x</a> <a id="3889" class="Symbol">→</a> <a id="3891" class="Symbol">(</a><a id="3892" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#2555" class="Function">incrementAux1</a> <a id="3906" class="Symbol">(</a><a id="3907" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="3914" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3739" class="Bound">candidate</a><a id="3923" class="Symbol">)))</a>
                                          
<a id="3970" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="Function">voteAux</a> <a id="3978" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3978" class="Bound">addr</a> <a id="3983" class="Symbol">(</a><a id="3984" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="3991" class="Symbol">(</a><a id="3992" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="3996" class="Symbol">(</a><a id="3997" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4001" class="Symbol">(</a><a id="4002" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="4006" class="Symbol">_))))</a> <a id="4012" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4012" class="Bound">candidate</a> <a id="4022" class="Symbol">=</a> <a id="4024" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="4029" class="Symbol">(</a><a id="4030" href="Complex-Model.ccomand.ccommands-cresponse.html#711" class="InductiveConstructor">raiseException</a> <a id="4045" class="Number">1</a> <a id="4047" class="String">&quot;checkVoter doesn&#39;t return Bool&quot;</a><a id="4079" class="Symbol">)(λ</a> <a id="4083" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4083" class="Bound">_</a> <a id="4085" class="Symbol">→</a> <a id="4087" class="Number">1</a><a id="4088" class="Symbol">)(λ</a> <a id="4092" class="Symbol">())</a>

<a id="4097" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="CatchallClause Function">voteAux</a><a id="4104" class="CatchallClause"> </a><a id="4105" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4105" class="CatchallClause Bound">addr</a><a id="4109" class="CatchallClause"> </a><a id="4110" class="CatchallClause Symbol">(</a><a id="4111" href="basicDataStructure.html#1455" class="CatchallClause InductiveConstructor">theMsg</a><a id="4117" class="CatchallClause"> </a><a id="4118" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4118" class="CatchallClause Bound">ow</a><a id="4120" class="CatchallClause Symbol">)</a><a id="4121" class="CatchallClause"> </a><a id="4122" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4122" class="CatchallClause Bound">candidate</a> <a id="4132" class="Symbol">=</a>  <a id="4135" href="Complex-Model.ccomand.ccommands-cresponse.html#1624" class="InductiveConstructor">error</a> <a id="4141" class="Symbol">(</a><a id="4142" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="4149" class="String">&quot;checkvoter doesn&#39;t return number&quot;</a><a id="4183" class="Symbol">)</a>
                                      <a id="4223" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="4225" class="Number">0</a> <a id="4227" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4230" class="Number">0</a> <a id="4232" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="4234" class="String">&quot;Voter is not allowed to vote&quot;</a> <a id="4265" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="4267" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="4271" class="Number">0</a> <a id="4273" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a>

<a id="4277" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="Function">voteAux</a> <a id="4285" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4285" class="Bound">addr</a> <a id="4290" class="Symbol">(</a><a id="4291" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="4295" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4295" class="Bound">x</a><a id="4296" class="Symbol">)</a> <a id="4298" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4298" class="Bound">candidate</a> <a id="4308" class="Symbol">=</a>  <a id="4311" href="Complex-Model.ccomand.ccommands-cresponse.html#1624" class="InductiveConstructor">error</a> <a id="4317" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4295" class="Bound">x</a>  <a id="4320" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="4322" class="Number">0</a> <a id="4324" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="4327" class="Number">0</a> <a id="4329" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="4331" class="Symbol">(</a><a id="4332" href="libraries.IOlibrary.html#1613" class="Function">error2Str</a> <a id="4342" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4295" class="Bound">x</a><a id="4343" class="Symbol">)</a> <a id="4345" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="4347" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="4351" class="Number">0</a> <a id="4353" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a>





<a id="4361" class="Comment">-- Example</a>
<a id="testLedger"></a><a id="4372" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4383" class="Symbol">:</a> <a id="4385" href="libraries.Mainlibrary.html#1075" class="Function">Ledger</a>
<a id="4392" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4403" class="Number">1</a> <a id="4405" class="Symbol">.</a><a id="4406" href="libraries.Mainlibrary.html#839" class="Field">amount</a> <a id="4413" class="Symbol">=</a> <a id="4415" class="Number">100</a>
<a id="4419" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4430" class="Number">1</a> <a id="4432" class="Symbol">.</a><a id="4433" href="libraries.Mainlibrary.html#934" class="Field">purefunction</a> <a id="4446" class="String">&quot;counter&quot;</a> <a id="4456" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4456" class="Bound">msg</a>     <a id="4464" class="Symbol">=</a> <a id="4466" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="4473" class="Symbol">(</a><a id="4474" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="4478" class="Number">0</a><a id="4479" class="Symbol">)</a>
<a id="4481" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4492" class="Number">1</a> <a id="4494" class="Symbol">.</a><a id="4495" href="libraries.Mainlibrary.html#934" class="Field">purefunction</a> <a id="4508" class="String">&quot;checkVoter&quot;</a> <a id="4521" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4521" class="Bound">msg</a>  <a id="4526" class="Symbol">=</a> <a id="4528" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="4535" class="Symbol">(</a><a id="4536" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="4540" class="Number">0</a><a id="4541" class="Symbol">)</a>
<a id="4543" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4554" class="Number">1</a> <a id="4556" class="Symbol">.</a><a id="4557" href="libraries.Mainlibrary.html#992" class="Field">purefunctionCost</a> <a id="4574" class="String">&quot;checkVoter&quot;</a> <a id="4587" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4587" class="Bound">msg</a> <a id="4591" class="Symbol">=</a> <a id="4593" class="Number">1</a>
<a id="4595" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4606" class="Number">1</a> <a id="4608" class="Symbol">.</a><a id="4609" href="libraries.Mainlibrary.html#865" class="Field">fun</a> <a id="4613" class="String">&quot;addVoter&quot;</a> <a id="4624" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4624" class="Bound">msg</a>    <a id="4631" class="Symbol">=</a> <a id="4633" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="4638" class="Symbol">(</a><a id="4639" href="Complex-Model.ccomand.ccommands-cresponse.html#550" class="InductiveConstructor">updatec</a> <a id="4647" class="String">&quot;checkVoter&quot;</a> <a id="4660" class="Symbol">(</a><a id="4661" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1294" class="Function">addVoterAux</a> <a id="4673" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4624" class="Bound">msg</a><a id="4676" class="Symbol">)</a> <a id="4678" class="Symbol">λ</a> <a id="4680" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4680" class="Bound">oldFun</a> <a id="4687" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4687" class="Bound">oldcost</a> <a id="4695" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4695" class="Bound">msg</a> <a id="4699" class="Symbol">→</a> <a id="4701" class="Number">1</a><a id="4702" class="Symbol">)</a>
                                      <a id="4742" class="Symbol">(λ</a> <a id="4745" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4745" class="Bound">_</a> <a id="4747" class="Symbol">→</a> <a id="4749" class="Number">1</a><a id="4750" class="Symbol">)</a> <a id="4752" class="Symbol">λ</a> <a id="4754" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4754" class="Bound">_</a> <a id="4756" class="Symbol">→</a> <a id="4758" href="Complex-Model.ccomand.ccommands-cresponse.html#1586" class="InductiveConstructor">return</a> <a id="4765" class="Number">1</a> <a id="4767" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4624" class="Bound">msg</a>
<a id="4771" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4782" class="Number">1</a> <a id="4784" class="Symbol">.</a><a id="4785" href="libraries.Mainlibrary.html#865" class="Field">fun</a> <a id="4789" class="String">&quot;deleteVoter&quot;</a> <a id="4803" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4803" class="Bound">msg</a> <a id="4807" class="Symbol">=</a> <a id="4809" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="4814" class="Symbol">(</a><a id="4815" href="Complex-Model.ccomand.ccommands-cresponse.html#550" class="InductiveConstructor">updatec</a> <a id="4823" class="String">&quot;checkVoter&quot;</a> <a id="4836" class="Symbol">(</a><a id="4837" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#1606" class="Function">deleteVoterAux</a> <a id="4852" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4803" class="Bound">msg</a><a id="4855" class="Symbol">)</a> <a id="4857" class="Symbol">λ</a> <a id="4859" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4859" class="Bound">oldFun</a> <a id="4866" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4866" class="Bound">oldcost</a> <a id="4874" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4874" class="Bound">msg</a> <a id="4878" class="Symbol">→</a> <a id="4880" class="Number">1</a><a id="4881" class="Symbol">)</a>
                                      <a id="4921" class="Symbol">(λ</a> <a id="4924" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4924" class="Bound">_</a> <a id="4926" class="Symbol">→</a> <a id="4928" class="Number">1</a><a id="4929" class="Symbol">)</a> <a id="4931" class="Symbol">λ</a> <a id="4933" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4933" class="Bound">_</a> <a id="4935" class="Symbol">→</a> <a id="4937" href="Complex-Model.ccomand.ccommands-cresponse.html#1586" class="InductiveConstructor">return</a> <a id="4944" class="Number">1</a> <a id="4946" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4803" class="Bound">msg</a>
<a id="4950" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="4961" class="Number">1</a> <a id="4963" class="Symbol">.</a><a id="4964" href="libraries.Mainlibrary.html#865" class="Field">fun</a> <a id="4968" class="String">&quot;vote&quot;</a> <a id="4975" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4975" class="Bound">msg</a>        <a id="4986" class="Symbol">=</a>  <a id="4989" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="4994" href="Complex-Model.ccomand.ccommands-cresponse.html#895" class="InductiveConstructor">callAddrLookupc</a>  <a id="5011" class="Symbol">(λ</a> <a id="5014" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5014" class="Bound">_</a> <a id="5016" class="Symbol">→</a> <a id="5018" class="Number">1</a><a id="5019" class="Symbol">)</a>
                                       <a id="5060" class="Symbol">λ</a> <a id="5062" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5062" class="Bound">addr</a> <a id="5067" class="Symbol">→</a> <a id="5069" href="Complex-Model.ccomand.ccommands-cresponse.html#1677" class="InductiveConstructor">exec</a> <a id="5074" class="Symbol">(</a><a id="5075" href="Complex-Model.ccomand.ccommands-cresponse.html#491" class="InductiveConstructor">callPure</a> <a id="5084" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5062" class="Bound">addr</a> <a id="5089" class="String">&quot;checkVoter&quot;</a> <a id="5102" class="Symbol">(</a><a id="5103" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="5107" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5062" class="Bound">addr</a><a id="5111" class="Symbol">))</a>
                                       <a id="5153" class="Symbol">(λ</a> <a id="5156" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5156" class="Bound">_</a> <a id="5158" class="Symbol">→</a> <a id="5160" class="Number">1</a><a id="5161" class="Symbol">)</a> <a id="5163" class="Symbol">λ</a> <a id="5165" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5165" class="Bound">checkvoterResult</a> <a id="5182" class="Symbol">→</a> <a id="5184" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#3405" class="Function">voteAux</a> <a id="5192" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5062" class="Bound">addr</a> <a id="5197" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5165" class="Bound">checkvoterResult</a> <a id="5214" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4975" class="Bound">msg</a>

<a id="5219" class="Comment">--- The amount for address 0 and 3</a>
<a id="5254" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="5265" class="Number">0</a> <a id="5267" class="Symbol">.</a><a id="5268" href="libraries.Mainlibrary.html#839" class="Field">amount</a>   <a id="5277" class="Symbol">=</a> <a id="5279" class="Number">100</a>
<a id="5283" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="5294" class="Number">3</a> <a id="5296" class="Symbol">.</a><a id="5297" href="libraries.Mainlibrary.html#839" class="Field">amount</a>   <a id="5306" class="Symbol">=</a> <a id="5308" class="Number">100</a>

<a id="5313" class="Comment">-- For other addresses</a>
<a id="5336" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="CatchallClause Function">testLedger</a><a id="5346" class="CatchallClause"> </a><a id="5347" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5347" class="CatchallClause Bound">ow</a><a id="5349" class="CatchallClause"> </a><a id="5350" class="CatchallClause Symbol">.</a><a id="5351" href="libraries.Mainlibrary.html#839" class="CatchallClause Field">amount</a>  <a id="5359" class="Symbol">=</a> <a id="5361" class="Number">0</a>
<a id="5363" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="CatchallClause Function">testLedger</a><a id="5373" class="CatchallClause"> </a><a id="5374" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5374" class="CatchallClause Bound">ow</a><a id="5376" class="CatchallClause"> </a><a id="5377" class="CatchallClause Symbol">.</a><a id="5378" href="libraries.Mainlibrary.html#865" class="CatchallClause Field">fun</a><a id="5381" class="CatchallClause"> </a><a id="5382" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5382" class="CatchallClause Bound">ow&#39;</a><a id="5385" class="CatchallClause"> </a><a id="5386" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5386" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="5391" class="Symbol">=</a> <a id="5393" href="Complex-Model.ccomand.ccommands-cresponse.html#1624" class="InductiveConstructor">error</a> <a id="5399" class="Symbol">(</a><a id="5400" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="5407" class="String">&quot;Undefined&quot;</a><a id="5418" class="Symbol">)</a> <a id="5420" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="5422" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5374" class="Bound">ow</a> <a id="5425" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="5428" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5374" class="Bound">ow</a> <a id="5431" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="5433" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5382" class="Bound">ow&#39;</a> <a id="5437" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="5439" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5386" class="Bound">ow&#39;&#39;</a> <a id="5444" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a>
<a id="5447" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="CatchallClause Function">testLedger</a><a id="5457" class="CatchallClause"> </a><a id="5458" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5458" class="CatchallClause Bound">ow</a><a id="5460" class="CatchallClause"> </a><a id="5461" class="CatchallClause Symbol">.</a><a id="5462" href="libraries.Mainlibrary.html#934" class="CatchallClause Field">purefunction</a><a id="5474" class="CatchallClause"> </a><a id="5475" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5475" class="CatchallClause Bound">ow&#39;</a><a id="5478" class="CatchallClause"> </a><a id="5479" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5479" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="5484" class="Symbol">=</a> <a id="5486" href="basicDataStructure.html#1483" class="InductiveConstructor">err</a> <a id="5490" class="Symbol">(</a><a id="5491" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="5498" class="String">&quot;Undefined&quot;</a><a id="5509" class="Symbol">)</a>
<a id="5511" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="CatchallClause Function">testLedger</a><a id="5521" class="CatchallClause"> </a><a id="5522" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5522" class="CatchallClause Bound">ow</a><a id="5524" class="CatchallClause"> </a><a id="5525" class="CatchallClause Symbol">.</a><a id="5526" href="libraries.Mainlibrary.html#992" class="CatchallClause Field">purefunctionCost</a><a id="5542" class="CatchallClause"> </a><a id="5543" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5543" class="CatchallClause Bound">ow&#39;</a><a id="5546" class="CatchallClause"> </a><a id="5547" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5547" class="CatchallClause Bound">ow&#39;&#39;</a> <a id="5552" class="Symbol">=</a> <a id="5554" class="Number">1</a>

<a id="5557" class="Comment">--main program IO</a>

<a id="main"></a><a id="5576" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5576" class="Function">main</a>  <a id="5582" class="Symbol">:</a> <a id="5584" href="interface.ConsoleLib.html#904" class="Function">ConsoleProg</a>
<a id="5596" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#5576" class="Function">main</a>  <a id="5602" class="Symbol">=</a> <a id="5604" href="interface.ConsoleLib.html#224" class="Function">run</a> <a id="5608" class="Symbol">(</a><a id="5609" href="Complex-Model.IOledger.IOledger-votingexample.html#13683" class="Function">mainBody</a> <a id="5618" class="Symbol">(</a><a id="5619" href="libraries.IOlibrary.html#2203" class="InductiveConstructor Operator">⟨</a> <a id="5621" href="Complex-Model.example.votingexample-complex_From_Solidity_into_Agda.html#4372" class="Function">testLedger</a> <a id="5632" href="libraries.IOlibrary.html#2203" class="InductiveConstructor Operator">ledger,</a> <a id="5640" class="Number">0</a> <a id="5642" href="libraries.IOlibrary.html#2203" class="InductiveConstructor Operator">initialAddr,</a> <a id="5655" class="Number">20</a> <a id="5658" href="libraries.IOlibrary.html#2203" class="InductiveConstructor Operator">gas⟩</a><a id="5662" class="Symbol">))</a>
</pre></body></html>