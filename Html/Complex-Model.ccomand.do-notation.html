<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.ccomand.do-notation</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>


<a id="34" class="Keyword">module</a> <a id="41" href="Complex-Model.ccomand.do-notation.html" class="Module">Complex-Model.ccomand.do-notation</a> <a id="75" class="Symbol">(</a><a id="76" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a> <a id="82" class="Symbol">:</a> <a id="84" href="constantparameters.html#235" class="Record">ConstantParameters</a><a id="102" class="Symbol">)</a> <a id="104" class="Keyword">where</a>

<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="161" class="Keyword">using</a> <a id="167" class="Symbol">(</a><a id="168" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="171" class="Symbol">)</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Data.List.html" class="Module">Data.List</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="239" class="Keyword">open</a> <a id="244" class="Keyword">import</a> <a id="251" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="292" class="Keyword">open</a> <a id="297" class="Keyword">import</a> <a id="304" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="316" class="Keyword">hiding</a> <a id="323" class="Symbol">(</a><a id="324" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="329" class="Symbol">)</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.String.html" class="Module">Data.String</a> <a id="355" class="Keyword">hiding</a> <a id="362" class="Symbol">(</a><a id="363" href="Data.String.Base.html#2430" class="Function">length</a><a id="369" class="Symbol">)</a>


<a id="373" class="Comment">--our work</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>


<a id="504" class="Comment">--- theses functions below we use them with do notation</a>
<a id="560" class="Comment">--functionofreturn : CResponse (callc addr fname msg) → ℕ</a>

<a id="call"></a><a id="619" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="624" class="Symbol">:</a> <a id="626" class="Symbol">(</a><a id="627" href="Complex-Model.ccomand.do-notation.html#627" class="Bound">addr</a> <a id="632" class="Symbol">:</a> <a id="634" href="basicDataStructure.html#405" class="Function">Address</a><a id="641" class="Symbol">)</a>  <a id="644" class="Symbol">→</a> <a id="646" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="659" class="Symbol">→</a> <a id="661" class="Symbol">(</a><a id="662" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="669" class="Symbol">)</a> <a id="671" class="Symbol">→</a> <a id="673" class="Symbol">(</a><a id="674" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="678" class="Symbol">→</a> <a id="680" href="Complex-Model.ccomand.ccommands-cresponse.html#1513" class="Datatype">SmartContract</a> <a id="694" href="basicDataStructure.html#523" class="Datatype">Msg</a><a id="697" class="Symbol">)</a>
<a id="699" href="Complex-Model.ccomand.do-notation.html#619" class="Function">call</a> <a id="704" href="Complex-Model.ccomand.do-notation.html#704" class="Bound">addr</a> <a id="709" href="Complex-Model.ccomand.do-notation.html#709" class="Bound">fname</a> <a id="715" href="Complex-Model.ccomand.do-notation.html#715" class="Bound">cost</a> <a id="720" href="Complex-Model.ccomand.do-notation.html#720" class="Bound">msg</a>  <a id="725" class="Symbol">=</a> <a id="727" href="Complex-Model.ccomand.ccommands-cresponse.html#1644" class="InductiveConstructor">exec</a> <a id="732" class="Symbol">(</a><a id="733" href="Complex-Model.ccomand.ccommands-cresponse.html#769" class="InductiveConstructor">callc</a> <a id="739" href="Complex-Model.ccomand.do-notation.html#704" class="Bound">addr</a> <a id="744" href="Complex-Model.ccomand.do-notation.html#709" class="Bound">fname</a> <a id="750" href="Complex-Model.ccomand.do-notation.html#720" class="Bound">msg</a><a id="753" class="Symbol">)</a> <a id="755" class="Symbol">(</a><a id="756" href="constantparameters.html#529" class="Field">costcallc</a> <a id="766" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="771" class="Symbol">)</a> <a id="773" class="Symbol">λ</a> <a id="775" href="Complex-Model.ccomand.do-notation.html#775" class="Bound">r</a> <a id="777" class="Symbol">→</a> <a id="779" href="Complex-Model.ccomand.ccommands-cresponse.html#1553" class="InductiveConstructor">return</a> <a id="786" class="Symbol">(</a><a id="787" href="Complex-Model.ccomand.do-notation.html#715" class="Bound">cost</a> <a id="792" href="Complex-Model.ccomand.do-notation.html#775" class="Bound">r</a><a id="793" class="Symbol">)</a> <a id="795" href="Complex-Model.ccomand.do-notation.html#775" class="Bound">r</a>  

<a id="update"></a><a id="800" href="Complex-Model.ccomand.do-notation.html#800" class="Function">update</a> <a id="807" class="Symbol">:</a> <a id="809" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="822" class="Symbol">→</a> <a id="824" class="Symbol">(</a><a id="825" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="829" class="Symbol">→</a> <a id="831" href="Complex-Model.ccomand.ccommands-cresponse.html#1513" class="Datatype">SmartContract</a> <a id="845" href="basicDataStructure.html#523" class="Datatype">Msg</a><a id="848" class="Symbol">)</a> <a id="850" class="Symbol">→</a> <a id="852" class="Symbol">(</a><a id="853" href="Complex-Model.ccomand.do-notation.html#853" class="Bound">cost₁</a>  <a id="860" href="Complex-Model.ccomand.do-notation.html#860" class="Bound">cost₂</a> <a id="866" class="Symbol">:</a> <a id="868" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="870" class="Symbol">)</a> <a id="872" class="Symbol">→</a> <a id="874" href="Complex-Model.ccomand.ccommands-cresponse.html#1513" class="Datatype">SmartContract</a> <a id="888" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="890" href="Complex-Model.ccomand.do-notation.html#800" class="Function">update</a> <a id="897" href="Complex-Model.ccomand.do-notation.html#897" class="Bound">fname</a> <a id="903" href="Complex-Model.ccomand.do-notation.html#903" class="Bound">fdef</a> <a id="908" href="Complex-Model.ccomand.do-notation.html#908" class="Bound">cost₁</a> <a id="914" href="Complex-Model.ccomand.do-notation.html#914" class="Bound">cost₂</a> <a id="920" class="Symbol">=</a> <a id="922" href="Complex-Model.ccomand.ccommands-cresponse.html#1644" class="InductiveConstructor">exec</a> <a id="927" class="Symbol">(</a><a id="928" href="Complex-Model.ccomand.ccommands-cresponse.html#550" class="InductiveConstructor">updatec</a> <a id="936" href="Complex-Model.ccomand.do-notation.html#897" class="Bound">fname</a> <a id="942" class="Symbol">(λ</a> <a id="945" href="Complex-Model.ccomand.do-notation.html#945" class="Bound">_</a> <a id="947" href="Complex-Model.ccomand.do-notation.html#947" class="Bound">fdef</a> <a id="952" class="Symbol">→</a> <a id="954" href="basicDataStructure.html#1455" class="InductiveConstructor">theMsg</a> <a id="961" href="Complex-Model.ccomand.do-notation.html#947" class="Bound">fdef</a><a id="965" class="Symbol">)</a> <a id="967" class="Symbol">λ</a> <a id="969" href="Complex-Model.ccomand.do-notation.html#969" class="Bound">_</a> <a id="971" class="Symbol">→</a> <a id="973" href="Complex-Model.ccomand.do-notation.html#908" class="Bound">cost₁</a><a id="978" class="Symbol">)</a> <a id="980" class="Symbol">(λ</a> <a id="983" href="Complex-Model.ccomand.do-notation.html#983" class="Bound">_</a> <a id="985" class="Symbol">→</a> <a id="987" href="Complex-Model.ccomand.do-notation.html#908" class="Bound">cost₁</a><a id="992" class="Symbol">)</a> <a id="994" class="Symbol">(</a><a id="995" href="Complex-Model.ccomand.ccommands-cresponse.html#1553" class="InductiveConstructor">return</a> <a id="1002" href="Complex-Model.ccomand.do-notation.html#914" class="Bound">cost₂</a><a id="1007" class="Symbol">)</a> 

<a id="currentAddrLookup"></a><a id="1011" href="Complex-Model.ccomand.do-notation.html#1011" class="Function">currentAddrLookup</a> <a id="1029" class="Symbol">:</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Complex-Model.ccomand.do-notation.html#1032" class="Bound">cost</a> <a id="1037" class="Symbol">:</a> <a id="1039" href="basicDataStructure.html#405" class="Function">Address</a> <a id="1047" class="Symbol">→</a> <a id="1049" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1050" class="Symbol">)</a> <a id="1052" class="Symbol">→</a> <a id="1054" href="Complex-Model.ccomand.ccommands-cresponse.html#1513" class="Datatype">SmartContract</a> <a id="1068" href="basicDataStructure.html#405" class="Function">Address</a>
<a id="1076" href="Complex-Model.ccomand.do-notation.html#1011" class="Function">currentAddrLookup</a> <a id="1094" href="Complex-Model.ccomand.do-notation.html#1094" class="Bound">cost</a> <a id="1099" class="Symbol">=</a> <a id="1101" href="Complex-Model.ccomand.ccommands-cresponse.html#1644" class="InductiveConstructor">exec</a> <a id="1106" href="Complex-Model.ccomand.ccommands-cresponse.html#827" class="InductiveConstructor">currentAddrLookupc</a> <a id="1125" class="Symbol">(λ</a> <a id="1128" href="Complex-Model.ccomand.do-notation.html#1128" class="Bound">_</a> <a id="1130" class="Symbol">→</a> <a id="1132" href="constantparameters.html#467" class="Field">costcurrentAddrLookupc</a> <a id="1155" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1160" class="Symbol">)</a> <a id="1162" class="Symbol">λ</a> <a id="1164" href="Complex-Model.ccomand.do-notation.html#1164" class="Bound">addr</a> <a id="1169" class="Symbol">→</a> <a id="1171" href="Complex-Model.ccomand.ccommands-cresponse.html#1553" class="InductiveConstructor">return</a> <a id="1178" class="Symbol">(</a><a id="1179" href="Complex-Model.ccomand.do-notation.html#1094" class="Bound">cost</a> <a id="1184" href="Complex-Model.ccomand.do-notation.html#1164" class="Bound">addr</a><a id="1188" class="Symbol">)</a> <a id="1190" href="Complex-Model.ccomand.do-notation.html#1164" class="Bound">addr</a>

<a id="callAddrLookup"></a><a id="1196" href="Complex-Model.ccomand.do-notation.html#1196" class="Function">callAddrLookup</a> <a id="1211" class="Symbol">:</a> <a id="1213" class="Symbol">(</a><a id="1214" href="Complex-Model.ccomand.do-notation.html#1214" class="Bound">cost</a> <a id="1219" class="Symbol">:</a> <a id="1221" href="basicDataStructure.html#405" class="Function">Address</a> <a id="1229" class="Symbol">→</a> <a id="1231" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1232" class="Symbol">)</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Complex-Model.ccomand.ccommands-cresponse.html#1513" class="Datatype">SmartContract</a> <a id="1250" href="basicDataStructure.html#405" class="Function">Address</a>
<a id="1258" href="Complex-Model.ccomand.do-notation.html#1196" class="Function">callAddrLookup</a> <a id="1273" href="Complex-Model.ccomand.do-notation.html#1273" class="Bound">cost</a> <a id="1278" class="Symbol">=</a> <a id="1280" href="Complex-Model.ccomand.ccommands-cresponse.html#1644" class="InductiveConstructor">exec</a> <a id="1285" href="Complex-Model.ccomand.ccommands-cresponse.html#862" class="InductiveConstructor">callAddrLookupc</a> <a id="1301" class="Symbol">(λ</a> <a id="1304" href="Complex-Model.ccomand.do-notation.html#1304" class="Bound">_</a> <a id="1306" class="Symbol">→</a> <a id="1308" href="constantparameters.html#498" class="Field">costcallAddrLookupc</a> <a id="1328" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1333" class="Symbol">)</a> <a id="1335" class="Symbol">λ</a> <a id="1337" href="Complex-Model.ccomand.do-notation.html#1337" class="Bound">addr</a> <a id="1342" class="Symbol">→</a> <a id="1344" href="Complex-Model.ccomand.ccommands-cresponse.html#1553" class="InductiveConstructor">return</a> <a id="1351" class="Symbol">(</a><a id="1352" href="Complex-Model.ccomand.do-notation.html#1273" class="Bound">cost</a> <a id="1357" href="Complex-Model.ccomand.do-notation.html#1337" class="Bound">addr</a><a id="1361" class="Symbol">)</a> <a id="1363" href="Complex-Model.ccomand.do-notation.html#1337" class="Bound">addr</a> 

<a id="transfer"></a><a id="1370" href="Complex-Model.ccomand.do-notation.html#1370" class="Function">transfer</a> <a id="1379" class="Symbol">:</a> <a id="1381" href="basicDataStructure.html#378" class="Function">Amount</a> <a id="1388" class="Symbol">→</a> <a id="1390" href="basicDataStructure.html#405" class="Function">Address</a> <a id="1398" class="Symbol">→</a> <a id="1400" class="Symbol">(</a><a id="1401" href="Complex-Model.ccomand.do-notation.html#1401" class="Bound">cost</a> <a id="1406" class="Symbol">:</a> <a id="1408" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1409" class="Symbol">)</a> <a id="1411" class="Symbol">→</a> <a id="1413" href="Complex-Model.ccomand.ccommands-cresponse.html#1513" class="Datatype">SmartContract</a> <a id="1427" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1429" href="Complex-Model.ccomand.do-notation.html#1370" class="Function">transfer</a> <a id="1438" href="Complex-Model.ccomand.do-notation.html#1438" class="Bound">amount</a> <a id="1445" href="Complex-Model.ccomand.do-notation.html#1445" class="Bound">addr</a> <a id="1450" href="Complex-Model.ccomand.do-notation.html#1450" class="Bound">cost</a> <a id="1455" class="Symbol">=</a>  <a id="1458" href="Complex-Model.ccomand.ccommands-cresponse.html#1644" class="InductiveConstructor">exec</a> <a id="1463" class="Symbol">(</a><a id="1464" href="Complex-Model.ccomand.ccommands-cresponse.html#723" class="InductiveConstructor">transferc</a> <a id="1474" href="Complex-Model.ccomand.do-notation.html#1438" class="Bound">amount</a> <a id="1481" href="Complex-Model.ccomand.do-notation.html#1445" class="Bound">addr</a><a id="1485" class="Symbol">)</a> <a id="1487" class="Symbol">(λ</a> <a id="1490" href="Complex-Model.ccomand.do-notation.html#1490" class="Bound">_</a> <a id="1492" class="Symbol">→</a> <a id="1494" href="constantparameters.html#566" class="Field">costtransfer</a> <a id="1507" href="Complex-Model.ccomand.do-notation.html#76" class="Bound">param</a><a id="1512" class="Symbol">)</a> <a id="1514" class="Symbol">(</a><a id="1515" href="Complex-Model.ccomand.ccommands-cresponse.html#1553" class="InductiveConstructor">return</a> <a id="1522" href="Complex-Model.ccomand.do-notation.html#1450" class="Bound">cost</a><a id="1526" class="Symbol">)</a> 
</pre></body></html>