<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>libraries.IOlibrary</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a> <a id="60" class="Keyword">where</a>

<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.List.html" class="Module">Data.List</a> <a id="110" class="Keyword">hiding</a> <a id="117" class="Symbol">(</a><a id="118" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="153" class="Keyword">using</a> <a id="159" class="Symbol">(</a><a id="160" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="163" class="Symbol">;</a> <a id="165" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">_*_</a><a id="168" class="Symbol">)</a>
<a id="170" class="Keyword">open</a> <a id="175" class="Keyword">import</a> <a id="182" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="290" class="Keyword">hiding</a> <a id="297" class="Symbol">(</a><a id="298" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="303" class="Symbol">)</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.String.html" class="Module">Data.String</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.String.Base.html#2430" class="Function">length</a><a id="343" class="Symbol">;</a><a id="344" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="348" class="Symbol">)</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="404" class="Symbol">as</a> <a id="407" class="Module">Maybe</a> <a id="413" class="Keyword">using</a> <a id="419" class="Symbol">(</a><a id="420" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="425" class="Symbol">;</a> <a id="427" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="434" class="Symbol">;</a> <a id="436" href="Data.Maybe.Base.html#2335" class="Function Operator">_&lt;∣&gt;_</a><a id="441" class="Symbol">;</a> <a id="443" href="Data.Maybe.Base.html#2450" class="Function">when</a><a id="447" class="Symbol">)</a>
<a id="449" class="Keyword">import</a> <a id="456" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="479" class="Symbol">as</a> <a id="482" class="Module">Maybe</a>
<a id="488" class="Keyword">open</a> <a id="493" class="Keyword">import</a> <a id="500" href="Data.Product.html" class="Module">Data.Product</a> <a id="513" class="Keyword">renaming</a> <a id="522" class="Symbol">(</a><a id="523" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="527" class="Symbol">to</a> <a id="530" class="InductiveConstructor Operator">_,,_</a> <a id="535" class="Symbol">)</a>
<a id="537" class="Keyword">open</a> <a id="542" class="Keyword">import</a> <a id="549" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="570" class="Comment">--our work</a>
<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>
<a id="681" class="Keyword">open</a> <a id="686" class="Keyword">import</a> <a id="693" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="735" class="Keyword">open</a> <a id="740" class="Keyword">import</a> <a id="747" href="basicDataStructure.html" class="Module">basicDataStructure</a>



<a id="string2FunctionName"></a><a id="769" href="libraries.IOlibrary.html#769" class="Function">string2FunctionName</a> <a id="789" class="Symbol">:</a> <a id="791" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="798" class="Symbol">→</a> <a id="800" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="806" href="basicDataStructure.html#190" class="Function">FunctionName</a>
<a id="819" href="libraries.IOlibrary.html#769" class="Function">string2FunctionName</a> <a id="839" href="libraries.IOlibrary.html#839" class="Bound">str</a> <a id="843" class="Symbol">=</a> <a id="845" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="850" href="libraries.IOlibrary.html#839" class="Bound">str</a>




<a id="funname2string"></a><a id="858" href="libraries.IOlibrary.html#858" class="Function">funname2string</a> <a id="873" class="Symbol">:</a> <a id="875" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="888" class="Symbol">→</a> <a id="890" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="897" href="libraries.IOlibrary.html#858" class="Function">funname2string</a> <a id="912" href="libraries.IOlibrary.html#912" class="Bound">x</a> <a id="914" class="Symbol">=</a> <a id="916" href="libraries.IOlibrary.html#912" class="Bound">x</a>



<a id="921" class="Keyword">mutual</a>
  <a id="msgList2String"></a><a id="930" href="libraries.IOlibrary.html#930" class="Function">msgList2String</a> <a id="945" class="Symbol">:</a> <a id="947" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="952" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="956" class="Symbol">→</a> <a id="958" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="967" href="libraries.IOlibrary.html#930" class="Function">msgList2String</a> <a id="982" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="985" class="Symbol">=</a> <a id="987" class="String">&quot;&quot;</a>
  <a id="992" href="libraries.IOlibrary.html#930" class="Function">msgList2String</a> <a id="1007" class="Symbol">(</a><a id="1008" href="libraries.IOlibrary.html#1008" class="Bound">msg</a> <a id="1012" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1014" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1016" class="Symbol">)</a> <a id="1018" class="Symbol">=</a> <a id="1020" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1031" href="libraries.IOlibrary.html#1008" class="Bound">msg</a>
  <a id="1037" href="libraries.IOlibrary.html#930" class="CatchallClause Function">msgList2String</a><a id="1051" class="CatchallClause"> </a><a id="1052" class="CatchallClause Symbol">(</a><a id="1053" href="libraries.IOlibrary.html#1053" class="CatchallClause Bound">msg</a><a id="1056" class="CatchallClause"> </a><a id="1057" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1058" class="CatchallClause"> </a><a id="1059" href="libraries.IOlibrary.html#1059" class="CatchallClause Bound">rest</a><a id="1063" class="CatchallClause Symbol">)</a> <a id="1065" class="Symbol">=</a> <a id="1067" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1078" href="libraries.IOlibrary.html#1053" class="Bound">msg</a>  <a id="1083" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1086" class="String">&quot; , &quot;</a> <a id="1092" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1095" href="libraries.IOlibrary.html#930" class="Function">msgList2String</a> <a id="1110" href="libraries.IOlibrary.html#1059" class="Bound">rest</a>


  <a id="msg2string"></a><a id="1119" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1130" class="Symbol">:</a> <a id="1132" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
  <a id="1147" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1158" class="Symbol">(</a><a id="1159" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1163" href="libraries.IOlibrary.html#1163" class="Bound">n</a><a id="1164" class="Symbol">)</a>         <a id="1174" class="Symbol">=</a> <a id="1176" class="String">&quot;(nat &quot;</a> <a id="1184" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1187" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1192" href="libraries.IOlibrary.html#1163" class="Bound">n</a> <a id="1194" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1197" class="String">&quot;)&quot;</a>
  <a id="1203" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1214" class="Symbol">(</a><a id="1215" href="libraries.IOlibrary.html#1215" class="Bound">msg</a> <a id="1219" href="basicDataStructure.html#578" class="InductiveConstructor Operator">+msg</a> <a id="1224" href="libraries.IOlibrary.html#1224" class="Bound">msg₁</a><a id="1228" class="Symbol">)</a> <a id="1230" class="Symbol">=</a>  <a id="1233" class="String">&quot;(&quot;</a> <a id="1237" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1240" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1251" href="libraries.IOlibrary.html#1215" class="Bound">msg</a> <a id="1255" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1258" class="String">&quot; , &quot;</a> <a id="1264" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1267" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1278" href="libraries.IOlibrary.html#1224" class="Bound">msg₁</a> <a id="1283" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1286" class="String">&quot;)&quot;</a>
  <a id="1292" href="libraries.IOlibrary.html#1119" class="Function">msg2string</a> <a id="1303" class="Symbol">(</a><a id="1304" href="basicDataStructure.html#615" class="InductiveConstructor">list</a> <a id="1309" href="libraries.IOlibrary.html#1309" class="Bound">l</a><a id="1310" class="Symbol">)</a>        <a id="1319" class="Symbol">=</a> <a id="1321" class="String">&quot;[&quot;</a> <a id="1325" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1328" href="libraries.IOlibrary.html#930" class="Function">msgList2String</a> <a id="1343" href="libraries.IOlibrary.html#1309" class="Bound">l</a> <a id="1345" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="1348" class="String">&quot;]&quot;</a>


<a id="1354" class="Comment">-- Test cases</a>
<a id="1368" class="Comment">-- msg2string (nat 5)</a>
<a id="1390" class="Comment">--    &quot;(nat 5)&quot;&quot;(nat 5)&quot;</a>
<a id="1415" class="Comment">-- msg2string (list ((nat 3)  ∷ (nat 7) ∷ []))</a>
<a id="1462" class="Comment">--    &quot;[(nat 3) , (nat 7) ]&quot;</a>
<a id="1491" class="Comment">-- msg2string (list ((nat 3)  ∷ ((nat 7) +msg (nat 8) ) ∷ []))</a>
<a id="1554" class="Comment">--    &quot;[(nat 3) , ((nat 7) , (nat 8))]&quot;</a>


<a id="errorMsg2Str"></a><a id="1596" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="1609" class="Symbol">:</a> <a id="1611" href="basicDataStructure.html#1074" class="Datatype">NatOrError</a> <a id="1622" class="Symbol">→</a> <a id="1624" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="1631" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="1644" class="Symbol">(</a><a id="1645" href="basicDataStructure.html#1098" class="InductiveConstructor">nat</a> <a id="1649" href="libraries.IOlibrary.html#1649" class="Bound">n</a><a id="1650" class="Symbol">)</a> <a id="1652" class="Symbol">=</a> <a id="1654" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1659" href="libraries.IOlibrary.html#1649" class="Bound">n</a>
<a id="1661" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="1674" class="Symbol">(</a><a id="1675" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="1679" class="Symbol">(</a><a id="1680" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="1687" href="libraries.IOlibrary.html#1687" class="Bound">s</a><a id="1688" class="Symbol">)</a> <a id="1690" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1692" href="libraries.IOlibrary.html#1692" class="Bound">lastcalladdr</a> <a id="1705" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1708" href="libraries.IOlibrary.html#1708" class="Bound">curraddr</a> <a id="1717" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="1719" href="libraries.IOlibrary.html#1719" class="Bound">lastfunname</a> <a id="1731" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="1733" href="libraries.IOlibrary.html#1733" class="Bound">lastmsg</a> <a id="1741" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="1743" class="Symbol">)</a> <a id="1745" class="Symbol">=</a> <a id="1747" href="libraries.IOlibrary.html#1687" class="Bound">s</a>
<a id="1749" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="1762" class="Symbol">(</a><a id="1763" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="1767" class="Symbol">(</a><a id="1768" href="basicDataStructure.html#726" class="InductiveConstructor">numErr</a> <a id="1775" href="libraries.IOlibrary.html#1775" class="Bound">n</a><a id="1776" class="Symbol">)</a> <a id="1778" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1780" href="libraries.IOlibrary.html#1780" class="Bound">lastcalladdr</a> <a id="1793" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1796" href="libraries.IOlibrary.html#1796" class="Bound">curraddr</a> <a id="1805" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="1807" href="libraries.IOlibrary.html#1807" class="Bound">lastfunname</a> <a id="1819" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="1821" href="libraries.IOlibrary.html#1821" class="Bound">lastmsg</a> <a id="1829" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="1831" class="Symbol">)</a> <a id="1833" class="Symbol">=</a> <a id="1835" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1840" href="libraries.IOlibrary.html#1775" class="Bound">n</a>
<a id="1842" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="1855" class="Symbol">(</a><a id="1856" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="1860" href="basicDataStructure.html#753" class="InductiveConstructor">undefined</a> <a id="1870" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1872" href="libraries.IOlibrary.html#1872" class="Bound">lastcalladdr</a> <a id="1885" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1888" href="libraries.IOlibrary.html#1888" class="Bound">curraddr</a> <a id="1897" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="1899" href="libraries.IOlibrary.html#1899" class="Bound">lastfunname</a> <a id="1911" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="1913" href="libraries.IOlibrary.html#1913" class="Bound">lastmsg</a> <a id="1921" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="1923" class="Symbol">)</a> <a id="1925" class="Symbol">=</a> <a id="1927" class="String">&quot;Error undefined&quot;</a>
<a id="1945" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="1958" class="Symbol">(</a><a id="1959" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="1963" href="basicDataStructure.html#776" class="InductiveConstructor">outOfGasError</a> <a id="1977" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1979" href="libraries.IOlibrary.html#1979" class="Bound">lastcalladdr</a> <a id="1992" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1995" href="libraries.IOlibrary.html#1995" class="Bound">curraddr</a> <a id="2004" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="2006" href="libraries.IOlibrary.html#2006" class="Bound">lastfunname</a> <a id="2018" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="2020" href="libraries.IOlibrary.html#2020" class="Bound">lastmsg</a> <a id="2028" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="2030" class="Symbol">)</a> <a id="2032" class="Symbol">=</a> <a id="2034" class="String">&quot;Out of gas error&quot;</a>
<a id="2053" href="libraries.IOlibrary.html#1596" class="Function">errorMsg2Str</a> <a id="2066" href="basicDataStructure.html#1161" class="InductiveConstructor">invalidtransaction</a> <a id="2085" class="Symbol">=</a> <a id="2087" class="String">&quot;invalidtransaction&quot;</a>


<a id="checkamount"></a><a id="2110" href="libraries.IOlibrary.html#2110" class="Function">checkamount</a> <a id="2122" class="Symbol">:</a> <a id="2124" href="libraries.Mainlibrary.html#1012" class="Function">Ledger</a> <a id="2131" class="Symbol">→</a> <a id="2133" href="basicDataStructure.html#405" class="Function">Address</a> <a id="2141" class="Symbol">→</a> <a id="2143" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2145" href="libraries.IOlibrary.html#2110" class="Function">checkamount</a> <a id="2157" href="libraries.IOlibrary.html#2157" class="Bound">ledger</a> <a id="2164" href="libraries.IOlibrary.html#2164" class="Bound">addr</a> <a id="2169" class="Symbol">=</a> <a id="2171" href="libraries.IOlibrary.html#2157" class="Bound">ledger</a> <a id="2178" href="libraries.IOlibrary.html#2164" class="Bound">addr</a> <a id="2183" class="Symbol">.</a><a id="2184" href="libraries.Mainlibrary.html#839" class="Field">amount</a>




<a id="2195" class="Comment">-- define state for IO</a>
<a id="2218" class="Keyword">record</a> <a id="StateIO"></a><a id="2225" href="libraries.IOlibrary.html#2225" class="Record">StateIO</a>  <a id="2234" class="Symbol">:</a> <a id="2236" href="Agda.Primitive.html#326" class="Primitive">Set</a>  <a id="2241" class="Keyword">where</a>
       <a id="2254" class="Keyword">constructor</a> <a id="⟨_ledger,_initialAddr,_gas⟩"></a><a id="2266" href="libraries.IOlibrary.html#2266" class="InductiveConstructor Operator">⟨_ledger,_initialAddr,_gas⟩</a>
       <a id="2301" class="Keyword">field</a>
        <a id="StateIO.ledger"></a><a id="2315" href="libraries.IOlibrary.html#2315" class="Field">ledger</a>       <a id="2328" class="Symbol">:</a> <a id="2330" href="libraries.Mainlibrary.html#1012" class="Function">Ledger</a>
        <a id="StateIO.initialAddr"></a><a id="2345" href="libraries.IOlibrary.html#2345" class="Field">initialAddr</a>  <a id="2358" class="Symbol">:</a> <a id="2360" href="basicDataStructure.html#405" class="Function">Address</a>
        <a id="StateIO.gas"></a><a id="2376" href="libraries.IOlibrary.html#2376" class="Field">gas</a>          <a id="2389" class="Symbol">:</a> <a id="2391" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2393" class="Keyword">open</a> <a id="2398" href="libraries.IOlibrary.html#2225" class="Module">StateIO</a> <a id="2406" class="Keyword">public</a>




</pre></body></html>