<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.example.examplecounter_from_Solidity_into_Agda</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html" class="Module Operator">Simple-Model.example.examplecounter_from_Solidity_into_Agda</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="97" class="Keyword">hiding</a> <a id="104" class="Symbol">(</a><a id="105" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a><a id="108" class="Symbol">)</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Data.List.html" class="Module">Data.List</a>
<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="154" class="Keyword">hiding</a> <a id="161" class="Symbol">(</a><a id="162" href="Data.Bool.Base.html#751" class="Datatype Operator">_&lt;_</a><a id="165" class="Symbol">)</a> <a id="167" class="Comment">--hiding (_&lt;_)</a>
<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>   <a id="211" class="Keyword">hiding</a> <a id="218" class="Symbol">(</a><a id="219" href="Data.Bool.Base.html#751" class="Datatype Operator">_&lt;_</a><a id="222" class="Symbol">)</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="250" class="Keyword">hiding</a> <a id="257" class="Symbol">(</a><a id="258" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a><a id="261" class="Symbol">)</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="286" class="Keyword">hiding</a> <a id="293" class="Symbol">(</a><a id="294" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="299" class="Symbol">)</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Data.String.html" class="Module">Data.String</a> <a id="325" class="Keyword">hiding</a> <a id="332" class="Symbol">(</a><a id="333" href="Data.String.Base.html#2430" class="Function">length</a><a id="339" class="Symbol">;</a> <a id="341" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="345" class="Symbol">;</a> <a id="347" href="Data.String.Base.html#1807" class="Function Operator">_&lt;_</a><a id="350" class="Symbol">)</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>


<a id="380" class="Comment">--simple model</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a>

<a id="455" class="Comment">--library</a>
<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>
<a id="545" class="Keyword">open</a> <a id="550" class="Keyword">import</a> <a id="557" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>

<a id="579" class="Comment">--IOledger</a>
<a id="590" class="Keyword">open</a> <a id="595" class="Keyword">import</a> <a id="602" href="Simple-Model.IOledger.IOledger-counter.html" class="Module">Simple-Model.IOledger.IOledger-counter</a>



<a id="644" class="Comment">--compare</a>
<a id="_&lt;_"></a><a id="654" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#654" class="Function Operator">_&lt;_</a> <a id="658" class="Symbol">:</a> <a id="660" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="662" class="Symbol">→</a> <a id="664" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="673" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="678" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#654" class="Function Operator">&lt;</a> <a id="680" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#680" class="Bound">m</a> <a id="682" class="Symbol">=</a> <a id="684" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
<a id="689" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="693" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#693" class="Bound">n</a> <a id="695" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#654" class="Function Operator">&lt;</a> <a id="697" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="702" class="Symbol">=</a> <a id="704" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="710" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="714" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#714" class="Bound">n</a> <a id="716" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#654" class="Function Operator">&lt;</a> <a id="718" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="722" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#722" class="Bound">m</a> <a id="724" class="Symbol">=</a> <a id="726" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#714" class="Bound">n</a> <a id="728" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#654" class="Function Operator">&lt;</a> <a id="730" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#722" class="Bound">m</a>



<a id="735" class="Comment">--Example of a simple counter</a>
<a id="const"></a><a id="765" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#765" class="Function">const</a> <a id="771" class="Symbol">:</a> <a id="773" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="775" class="Symbol">→</a> <a id="777" class="Symbol">(</a><a id="778" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="782" class="Symbol">→</a> <a id="784" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="798" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="801" class="Symbol">)</a>
<a id="803" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#765" class="Function">const</a> <a id="809" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#809" class="Bound">n</a> <a id="811" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#811" class="Bound">msg</a> <a id="815" class="Symbol">=</a> <a id="817" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="824" class="Symbol">(</a><a id="825" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="829" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#809" class="Bound">n</a><a id="830" class="Symbol">)</a>

<a id="833" class="Comment">-- Similar to Solidity</a>
<a id="856" class="Comment">-- in Solidity, we used Uint16 and in Agda we defined it.</a>
<a id="Max_Uint"></a><a id="914" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#914" class="Function Operator">Max_Uint</a> <a id="923" class="Symbol">:</a> <a id="925" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="927" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#914" class="Function Operator">Max_Uint</a> <a id="936" class="Symbol">=</a> <a id="938" class="Number">65535</a> 



<a id="948" class="Comment">-- test our ledger with our example</a>
<a id="testLedger"></a><a id="984" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="Function">testLedger</a> <a id="995" class="Symbol">:</a> <a id="997" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a>

<a id="1005" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="Function">testLedger</a> <a id="1016" class="Number">1</a> <a id="1018" class="Symbol">.</a><a id="1019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>             <a id="1038" class="Symbol">=</a> <a id="1040" class="Number">40</a>
<a id="1043" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="Function">testLedger</a> <a id="1054" class="Number">1</a> <a id="1056" class="Symbol">.</a><a id="1057" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="1061" class="String">&quot;counter&quot;</a> <a id="1071" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1071" class="Bound">m</a>   <a id="1075" class="Symbol">=</a> <a id="1077" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#765" class="Function">const</a> <a id="1083" class="Number">0</a> <a id="1085" class="Symbol">(</a><a id="1086" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1090" class="Number">0</a><a id="1091" class="Symbol">)</a>
<a id="1093" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="Function">testLedger</a> <a id="1104" class="Number">1</a> <a id="1106" class="Symbol">.</a><a id="1107" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="1111" class="String">&quot;increment&quot;</a> <a id="1123" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1123" class="Bound">m</a>  <a id="1126" class="Symbol">=</a>  <a id="1129" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1134" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#758" class="InductiveConstructor">currentAddrLookupc</a>  <a id="1154" class="Symbol">λ</a> <a id="1156" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1156" class="Bound">addr</a> <a id="1161" class="Symbol">→</a>
                                    <a id="1199" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1204" class="Symbol">(</a><a id="1205" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a> <a id="1211" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1156" class="Bound">addr</a> <a id="1216" class="String">&quot;counter&quot;</a> <a id="1226" class="Symbol">(</a><a id="1227" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1231" class="Number">0</a><a id="1232" class="Symbol">))</a>
                                    <a id="1271" class="Symbol">λ{(</a><a id="1274" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1278" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1278" class="Bound">oldcounter</a><a id="1288" class="Symbol">)</a> <a id="1290" class="Symbol">→</a>
                                      <a id="1330" class="Symbol">(</a><a id="1331" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1334" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1278" class="Bound">oldcounter</a> <a id="1345" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#654" class="Function Operator">&lt;</a> <a id="1347" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#914" class="Function Operator">Max_Uint</a>
                                      <a id="1394" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1399" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1404" class="Symbol">(</a><a id="1405" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a> <a id="1413" class="String">&quot;counter&quot;</a> <a id="1423" class="Symbol">(</a><a id="1424" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#765" class="Function">const</a> <a id="1430" class="Symbol">(</a><a id="1431" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1435" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1278" class="Bound">oldcounter</a><a id="1445" class="Symbol">)))</a>
                                      <a id="1487" class="Symbol">(λ</a> <a id="1490" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1490" class="Bound">_</a> <a id="1492" class="Symbol">→</a> <a id="1494" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="1501" class="Symbol">(</a><a id="1502" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1506" class="Symbol">(</a><a id="1507" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1511" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1278" class="Bound">oldcounter</a><a id="1521" class="Symbol">)))</a>
                                      <a id="1563" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1568" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1574" class="Symbol">(</a><a id="1575" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1582" class="String">&quot;out of range error&quot;</a><a id="1602" class="Symbol">));</a>
                                    <a id="1642" class="CatchallClause Symbol">_</a> <a id="1644" class="Symbol">→</a> <a id="1646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1652" class="Symbol">(</a><a id="1653" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1660" class="String">&quot;counter returns not a number&quot;</a><a id="1690" class="Symbol">)}</a>

<a id="1694" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="CatchallClause Function">testLedger</a><a id="1704" class="CatchallClause"> </a><a id="1705" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1705" class="CatchallClause Bound">ow</a><a id="1707" class="CatchallClause"> </a><a id="1708" class="CatchallClause Symbol">.</a><a id="1709" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="CatchallClause Field">amount</a>           <a id="1726" class="Symbol">=</a> <a id="1728" class="Number">0</a>
<a id="1730" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="CatchallClause Function">testLedger</a><a id="1740" class="CatchallClause"> </a><a id="1741" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1741" class="CatchallClause Bound">ow</a><a id="1743" class="CatchallClause"> </a><a id="1744" class="CatchallClause Symbol">.</a><a id="1745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="CatchallClause Field">fun</a><a id="1748" class="CatchallClause"> </a><a id="1749" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1749" class="CatchallClause Bound">ow&#39;</a><a id="1752" class="CatchallClause"> </a><a id="1753" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1753" class="CatchallClause Bound">ow&#39;&#39;</a>     <a id="1762" class="Symbol">=</a> <a id="1764" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1778" class="String">&quot;Undefined&quot;</a><a id="1789" class="Symbol">)</a>


<a id="1793" class="Comment">-- To run IO</a>
<a id="main"></a><a id="1806" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1806" class="Function">main</a>  <a id="1812" class="Symbol">:</a>  <a id="1815" href="interface.ConsoleLib.html#904" class="Function">ConsoleProg</a> 
<a id="1828" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#1806" class="Function">main</a>  <a id="1834" class="Symbol">=</a>  <a id="1837" href="interface.ConsoleLib.html#224" class="Function">run</a>  <a id="1842" class="Symbol">(</a><a id="1843" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="1852" href="Simple-Model.example.examplecounter_from_Solidity_into_Agda.html#984" class="Function">testLedger</a> <a id="1863" class="Number">0</a><a id="1864" class="Symbol">)</a>
</pre></body></html>