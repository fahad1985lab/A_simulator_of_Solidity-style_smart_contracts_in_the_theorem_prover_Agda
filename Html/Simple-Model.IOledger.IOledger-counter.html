<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.IOledger.IOledger-counter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.IOledger.IOledger-counter.html" class="Module">Simple-Model.IOledger.IOledger-counter</a> <a id="47" class="Keyword">where</a>

<a id="54" class="Keyword">open</a> <a id="59" class="Keyword">import</a> <a id="66" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Data.List.html" class="Module">Data.List</a> <a id="97" class="Keyword">hiding</a> <a id="104" class="Symbol">(</a><a id="105" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="109" class="Symbol">)</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="155" class="Keyword">open</a> <a id="160" class="Keyword">import</a> <a id="167" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="208" class="Keyword">open</a> <a id="213" class="Keyword">import</a> <a id="220" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="231" class="Keyword">hiding</a> <a id="238" class="Symbol">(</a><a id="239" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="244" class="Symbol">)</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Data.String.html" class="Module">Data.String</a> <a id="270" class="Keyword">hiding</a> <a id="277" class="Symbol">(</a><a id="278" href="Data.String.Base.html#2430" class="Function">length</a><a id="284" class="Symbol">;</a><a id="285" href="Data.String.Base.html#1561" class="Primitive">show</a><a id="289" class="Symbol">)</a>
<a id="291" class="Keyword">open</a> <a id="296" class="Keyword">import</a> <a id="303" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>


<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>

<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="interface.Console.html" class="Module">interface.Console</a> <a id="515" class="Keyword">hiding</a> <a id="522" class="Symbol">(</a><a id="523" href="interface.Console.html#1258" class="Function">main</a><a id="527" class="Symbol">)</a>
<a id="529" class="Keyword">open</a> <a id="534" class="Keyword">import</a> <a id="541" href="interface.Unit.html" class="Module">interface.Unit</a>
<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="interface.NativeIO.html" class="Module">interface.NativeIO</a>
<a id="587" class="Keyword">open</a> <a id="592" class="Keyword">import</a> <a id="599" href="interface.Base.html" class="Module">interface.Base</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="642" class="Symbol">as</a> <a id="645" class="Module">Maybe</a> <a id="651" class="Keyword">using</a> <a id="657" class="Symbol">(</a><a id="658" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="663" class="Symbol">;</a> <a id="665" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="672" class="Symbol">;</a> <a id="674" href="Data.Maybe.Base.html#2335" class="Function Operator">_&lt;∣&gt;_</a><a id="679" class="Symbol">;</a> <a id="681" href="Data.Maybe.Base.html#2450" class="Function">when</a><a id="685" class="Symbol">)</a>
<a id="687" class="Keyword">import</a> <a id="694" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="717" class="Symbol">as</a> <a id="720" class="Module">Maybe</a>
<a id="726" class="Keyword">open</a> <a id="731" class="Keyword">import</a> <a id="738" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>



<a id="762" class="Comment">-- string to function name</a>
<a id="string2FunctionName"></a><a id="789" href="Simple-Model.IOledger.IOledger-counter.html#789" class="Function">string2FunctionName</a> <a id="809" class="Symbol">:</a> <a id="811" href="Agda.Builtin.String.html#336" class="Postulate">String</a> <a id="818" class="Symbol">→</a> <a id="820" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="826" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
<a id="839" href="Simple-Model.IOledger.IOledger-counter.html#789" class="Function">string2FunctionName</a> <a id="859" href="Simple-Model.IOledger.IOledger-counter.html#859" class="Bound">str</a> <a id="863" class="Symbol">=</a>  <a id="866" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="869" href="Simple-Model.IOledger.IOledger-counter.html#859" class="Bound">str</a>  <a id="874" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="877" class="String">&quot;counter&quot;</a>   <a id="889" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="894" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="899" class="String">&quot;counter&quot;</a>   <a id="911" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
                          <a id="942" class="Symbol">(</a><a id="943" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="946" href="Simple-Model.IOledger.IOledger-counter.html#859" class="Bound">str</a>  <a id="951" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="954" class="String">&quot;increment&quot;</a> <a id="966" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="971" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="976" class="String">&quot;increment&quot;</a> <a id="988" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
                          <a id="1019" class="Symbol">(</a><a id="1020" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1023" href="Simple-Model.IOledger.IOledger-counter.html#859" class="Bound">str</a>  <a id="1028" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="1031" class="String">&quot;transfer&quot;</a>  <a id="1043" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1048" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1053" class="String">&quot;transfer&quot;</a>  <a id="1065" href="Data.Bool.Base.html#1283" class="Function Operator">else</a>
                          <a id="1096" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a><a id="1103" class="Symbol">))</a>
                          
<a id="1133" class="Comment">-- define a function to convert error message to string</a>
<a id="errorMsg2Str"></a><a id="1189" href="Simple-Model.IOledger.IOledger-counter.html#1189" class="Function">errorMsg2Str</a> <a id="1202" class="Symbol">:</a> <a id="1204" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#572" class="Datatype">ErrorMsg</a> <a id="1213" class="Symbol">→</a> <a id="1215" href="Agda.Builtin.String.html#336" class="Postulate">String</a>
<a id="1222" href="Simple-Model.IOledger.IOledger-counter.html#1189" class="Function">errorMsg2Str</a> <a id="1235" class="Symbol">(</a><a id="1236" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1243" href="Simple-Model.IOledger.IOledger-counter.html#1243" class="Bound">s</a><a id="1244" class="Symbol">)</a>  <a id="1247" class="Symbol">=</a> <a id="1249" href="Simple-Model.IOledger.IOledger-counter.html#1243" class="Bound">s</a>
<a id="1251" href="Simple-Model.IOledger.IOledger-counter.html#1189" class="Function">errorMsg2Str</a> <a id="1264" class="Symbol">(</a><a id="1265" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#628" class="InductiveConstructor">numErr</a> <a id="1272" href="Simple-Model.IOledger.IOledger-counter.html#1272" class="Bound">n</a><a id="1273" class="Symbol">)</a>  <a id="1276" class="Symbol">=</a> <a id="1278" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="1283" href="Simple-Model.IOledger.IOledger-counter.html#1272" class="Bound">n</a>
<a id="1285" href="Simple-Model.IOledger.IOledger-counter.html#1189" class="Function">errorMsg2Str</a> <a id="1298" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#656" class="InductiveConstructor">undefined</a>   <a id="1310" class="Symbol">=</a> <a id="1312" class="String">&quot;undefined&quot;</a>

<a id="1325" class="Keyword">mutual</a>

<a id="1333" class="Comment">-- first program to execute a function of a contract</a>
  <a id="executeLedger"></a><a id="1388" href="Simple-Model.IOledger.IOledger-counter.html#1388" class="Function">executeLedger</a>      <a id="1407" class="Symbol">:</a> <a id="1409" class="Symbol">∀{</a><a id="1411" href="Simple-Model.IOledger.IOledger-counter.html#1411" class="Bound">i</a><a id="1412" class="Symbol">}</a> <a id="1414" class="Symbol">→</a> <a id="1416" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="1423" class="Symbol">→</a> <a id="1425" class="Symbol">(</a><a id="1426" href="Simple-Model.IOledger.IOledger-counter.html#1426" class="Bound">callAddr</a> <a id="1435" class="Symbol">:</a> <a id="1437" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="1444" class="Symbol">)</a> <a id="1446" class="Symbol">→</a> <a id="1448" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="1458" href="Simple-Model.IOledger.IOledger-counter.html#1411" class="Bound">i</a> <a id="1460" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="1467" href="Simple-Model.IOledger.IOledger-counter.html#1388" class="Function">executeLedger</a> <a id="1481" href="Simple-Model.IOledger.IOledger-counter.html#1481" class="Bound">ledger</a> <a id="1488" href="Simple-Model.IOledger.IOledger-counter.html#1488" class="Bound">callAddr</a> <a id="1497" class="Symbol">.</a><a id="1498" href="interface.Base.html#689" class="Field">force</a>
      <a id="1510" class="Symbol">=</a> <a id="1512" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="1518" class="Symbol">(</a><a id="1519" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="1528" class="String">&quot;Enter the calling address&quot;</a><a id="1555" class="Symbol">)</a>
        <a id="1565" class="Symbol">λ</a> <a id="1567" href="Simple-Model.IOledger.IOledger-counter.html#1567" class="Bound">_</a> <a id="1569" class="Symbol">→</a> <a id="1571" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="1578" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> 
        <a id="1595" class="Symbol">λ</a> <a id="1597" href="Simple-Model.IOledger.IOledger-counter.html#1597" class="Bound">line</a> <a id="1602" class="Symbol">→</a> <a id="1604" href="Simple-Model.IOledger.IOledger-counter.html#1662" class="Function">executeLedgerStep2</a> <a id="1623" href="Simple-Model.IOledger.IOledger-counter.html#1481" class="Bound">ledger</a> <a id="1630" href="Simple-Model.IOledger.IOledger-counter.html#1488" class="Bound">callAddr</a> <a id="1639" class="Symbol">(</a><a id="1640" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="1650" class="Number">10</a> <a id="1653" href="Simple-Model.IOledger.IOledger-counter.html#1597" class="Bound">line</a><a id="1657" class="Symbol">)</a>

  <a id="executeLedgerStep2"></a><a id="1662" href="Simple-Model.IOledger.IOledger-counter.html#1662" class="Function">executeLedgerStep2</a> <a id="1681" class="Symbol">:</a> <a id="1683" class="Symbol">∀{</a><a id="1685" href="Simple-Model.IOledger.IOledger-counter.html#1685" class="Bound">i</a><a id="1686" class="Symbol">}</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="1697" class="Symbol">→</a> <a id="1699" class="Symbol">(</a><a id="1700" href="Simple-Model.IOledger.IOledger-counter.html#1700" class="Bound">callAddr</a> <a id="1709" class="Symbol">:</a> <a id="1711" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="1718" class="Symbol">)</a> <a id="1720" class="Symbol">→</a> <a id="1722" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1728" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1730" class="Symbol">→</a> <a id="1732" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="1742" href="Simple-Model.IOledger.IOledger-counter.html#1685" class="Bound">i</a> <a id="1744" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="1751" href="Simple-Model.IOledger.IOledger-counter.html#1662" class="Function">executeLedgerStep2</a> <a id="1770" href="Simple-Model.IOledger.IOledger-counter.html#1770" class="Bound">ledger</a> <a id="1777" href="Simple-Model.IOledger.IOledger-counter.html#1777" class="Bound">callAddr</a> <a id="1786" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="1794" class="Symbol">.</a><a id="1795" href="interface.Base.html#689" class="Field">force</a>
                   <a id="1820" class="Symbol">=</a> <a id="1822" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="1828" class="Symbol">(</a><a id="1829" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="1838" class="String">&quot;Enter the calling cddress&quot;</a><a id="1865" class="Symbol">)</a>
                     <a id="1888" class="Symbol">λ</a> <a id="1890" href="Simple-Model.IOledger.IOledger-counter.html#1890" class="Bound">_</a> <a id="1892" class="Symbol">→</a> <a id="1894" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="1901" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>
                     <a id="1930" class="Symbol">λ</a> <a id="1932" href="Simple-Model.IOledger.IOledger-counter.html#1932" class="Bound">_</a> <a id="1934" class="Symbol">→</a>  <a id="1937" href="Simple-Model.IOledger.IOledger-counter.html#1388" class="Function">executeLedger</a> <a id="1951" href="Simple-Model.IOledger.IOledger-counter.html#1770" class="Bound">ledger</a> <a id="1958" href="Simple-Model.IOledger.IOledger-counter.html#1777" class="Bound">callAddr</a>
  <a id="1969" href="Simple-Model.IOledger.IOledger-counter.html#1662" class="Function">executeLedgerStep2</a> <a id="1988" href="Simple-Model.IOledger.IOledger-counter.html#1988" class="Bound">ledger</a> <a id="1995" href="Simple-Model.IOledger.IOledger-counter.html#1995" class="Bound">callAddr</a> <a id="2004" class="Symbol">(</a><a id="2005" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2010" href="Simple-Model.IOledger.IOledger-counter.html#2010" class="Bound">n</a><a id="2011" class="Symbol">)</a> <a id="2013" class="Symbol">.</a><a id="2014" href="interface.Base.html#689" class="Field">force</a>
   <a id="2023" class="Symbol">=</a> <a id="2025" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="2031" class="Symbol">(</a><a id="2032" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2041" class="String">&quot;Enter the function name (e.g. counter, increment, transfer)&quot;</a><a id="2102" class="Symbol">)</a>
     <a id="2109" class="Symbol">λ</a> <a id="2111" href="Simple-Model.IOledger.IOledger-counter.html#2111" class="Bound">_</a> <a id="2113" class="Symbol">→</a> <a id="2115" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="2122" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> 
     <a id="2136" class="Symbol">λ</a> <a id="2138" href="Simple-Model.IOledger.IOledger-counter.html#2138" class="Bound">line</a> <a id="2143" class="Symbol">→</a> <a id="2145" href="Simple-Model.IOledger.IOledger-counter.html#2193" class="Function">executeLedgerStep3</a> <a id="2164" href="Simple-Model.IOledger.IOledger-counter.html#1988" class="Bound">ledger</a> <a id="2171" href="Simple-Model.IOledger.IOledger-counter.html#1995" class="Bound">callAddr</a> <a id="2180" href="Simple-Model.IOledger.IOledger-counter.html#2010" class="Bound">n</a> <a id="2182" href="Simple-Model.IOledger.IOledger-counter.html#2138" class="Bound">line</a>

  
  <a id="executeLedgerStep3"></a><a id="2193" href="Simple-Model.IOledger.IOledger-counter.html#2193" class="Function">executeLedgerStep3</a> <a id="2212" class="Symbol">:</a> <a id="2214" class="Symbol">∀{</a><a id="2216" href="Simple-Model.IOledger.IOledger-counter.html#2216" class="Bound">i</a><a id="2217" class="Symbol">}</a> <a id="2219" class="Symbol">→</a> <a id="2221" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="2228" class="Symbol">→</a> <a id="2230" class="Symbol">(</a><a id="2231" href="Simple-Model.IOledger.IOledger-counter.html#2231" class="Bound">callAddr</a> <a id="2240" class="Symbol">:</a> <a id="2242" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="2249" class="Symbol">)</a> <a id="2251" class="Symbol">→</a> <a id="2253" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2255" class="Symbol">→</a> <a id="2257" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2270" class="Symbol">→</a> <a id="2272" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="2282" href="Simple-Model.IOledger.IOledger-counter.html#2216" class="Bound">i</a> <a id="2284" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="2291" href="Simple-Model.IOledger.IOledger-counter.html#2193" class="Function">executeLedgerStep3</a> <a id="2310" href="Simple-Model.IOledger.IOledger-counter.html#2310" class="Bound">ledger</a> <a id="2317" href="Simple-Model.IOledger.IOledger-counter.html#2317" class="Bound">callAddr</a> <a id="2326" href="Simple-Model.IOledger.IOledger-counter.html#2326" class="Bound">n</a> <a id="2328" href="Simple-Model.IOledger.IOledger-counter.html#2328" class="Bound">f</a> <a id="2330" class="Symbol">.</a><a id="2331" href="interface.Base.html#689" class="Field">force</a>
   <a id="2340" class="Symbol">=</a> <a id="2342" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="2348" class="Symbol">(</a><a id="2349" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2358" class="String">&quot;Enter the argument of the function as a natural number&quot;</a><a id="2414" class="Symbol">)</a>
     <a id="2421" class="Symbol">λ</a> <a id="2423" href="Simple-Model.IOledger.IOledger-counter.html#2423" class="Bound">_</a> <a id="2425" class="Symbol">→</a> <a id="2427" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="2434" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>
     <a id="2447" class="Symbol">λ</a> <a id="2449" href="Simple-Model.IOledger.IOledger-counter.html#2449" class="Bound">line</a> <a id="2454" class="Symbol">→</a> <a id="2456" href="Simple-Model.IOledger.IOledger-counter.html#2526" class="Function">executeLedgerStep4</a> <a id="2475" href="Simple-Model.IOledger.IOledger-counter.html#2310" class="Bound">ledger</a> <a id="2482" href="Simple-Model.IOledger.IOledger-counter.html#2317" class="Bound">callAddr</a> <a id="2491" href="Simple-Model.IOledger.IOledger-counter.html#2326" class="Bound">n</a> <a id="2493" href="Simple-Model.IOledger.IOledger-counter.html#2328" class="Bound">f</a> <a id="2495" class="Symbol">(</a><a id="2496" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="2506" class="Number">10</a> <a id="2509" href="Simple-Model.IOledger.IOledger-counter.html#2449" class="Bound">line</a><a id="2513" class="Symbol">)</a>
     
  
  <a id="executeLedgerStep4"></a><a id="2526" href="Simple-Model.IOledger.IOledger-counter.html#2526" class="Function">executeLedgerStep4</a> <a id="2545" class="Symbol">:</a> <a id="2547" class="Symbol">∀{</a><a id="2549" href="Simple-Model.IOledger.IOledger-counter.html#2549" class="Bound">i</a><a id="2550" class="Symbol">}</a> <a id="2552" class="Symbol">→</a> <a id="2554" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="2561" class="Symbol">→</a> <a id="2563" class="Symbol">(</a><a id="2564" href="Simple-Model.IOledger.IOledger-counter.html#2564" class="Bound">callAddr</a> <a id="2573" class="Symbol">:</a> <a id="2575" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="2582" class="Symbol">)</a> <a id="2584" class="Symbol">→</a> <a id="2586" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2588" class="Symbol">→</a> <a id="2590" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2603" class="Symbol">→</a> <a id="2605" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2611" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2613" class="Symbol">→</a> <a id="2615" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="2625" href="Simple-Model.IOledger.IOledger-counter.html#2549" class="Bound">i</a> <a id="2627" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="2634" href="Simple-Model.IOledger.IOledger-counter.html#2526" class="Function">executeLedgerStep4</a> <a id="2653" href="Simple-Model.IOledger.IOledger-counter.html#2653" class="Bound">ledger</a> <a id="2660" href="Simple-Model.IOledger.IOledger-counter.html#2660" class="Bound">callAddr</a> <a id="2669" href="Simple-Model.IOledger.IOledger-counter.html#2669" class="Bound">n</a> <a id="2671" href="Simple-Model.IOledger.IOledger-counter.html#2671" class="Bound">f</a> <a id="2673" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="2681" class="Symbol">.</a><a id="2682" href="interface.Base.html#689" class="Field">force</a>
   <a id="2691" class="Symbol">=</a> <a id="2693" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="2699" class="Symbol">(</a><a id="2700" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="2709" class="String">&quot;Please enter a natural number&quot;</a><a id="2740" class="Symbol">)</a>
     <a id="2747" class="Symbol">λ</a> <a id="2749" href="Simple-Model.IOledger.IOledger-counter.html#2749" class="Bound">_</a> <a id="2751" class="Symbol">→</a> <a id="2753" href="Simple-Model.IOledger.IOledger-counter.html#2193" class="Function">executeLedgerStep3</a> <a id="2772" href="Simple-Model.IOledger.IOledger-counter.html#2653" class="Bound">ledger</a> <a id="2779" href="Simple-Model.IOledger.IOledger-counter.html#2660" class="Bound">callAddr</a>  <a id="2789" href="Simple-Model.IOledger.IOledger-counter.html#2669" class="Bound">n</a> <a id="2791" href="Simple-Model.IOledger.IOledger-counter.html#2671" class="Bound">f</a>

  <a id="2796" href="Simple-Model.IOledger.IOledger-counter.html#2526" class="Function">executeLedgerStep4</a> <a id="2815" href="Simple-Model.IOledger.IOledger-counter.html#2815" class="Bound">ledger</a> <a id="2822" href="Simple-Model.IOledger.IOledger-counter.html#2822" class="Bound">callAddr</a> <a id="2831" href="Simple-Model.IOledger.IOledger-counter.html#2831" class="Bound">n</a> <a id="2833" href="Simple-Model.IOledger.IOledger-counter.html#2833" class="Bound">f</a> <a id="2835" class="Symbol">(</a><a id="2836" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="2841" href="Simple-Model.IOledger.IOledger-counter.html#2841" class="Bound">m</a><a id="2842" class="Symbol">)</a> <a id="2844" class="Symbol">.</a><a id="2845" href="interface.Base.html#689" class="Field">force</a>
   <a id="2854" class="Symbol">=</a> <a id="2856" href="Simple-Model.IOledger.IOledger-counter.html#2958" class="Function">executeLedgerStep5</a> <a id="2875" class="Symbol">(</a><a id="2876" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10144" class="Function">evaluateNonTerminatingWithLedger</a>
     <a id="2914" href="Simple-Model.IOledger.IOledger-counter.html#2815" class="Bound">ledger</a> <a id="2921" href="Simple-Model.IOledger.IOledger-counter.html#2822" class="Bound">callAddr</a> <a id="2930" href="Simple-Model.IOledger.IOledger-counter.html#2831" class="Bound">n</a> <a id="2932" href="Simple-Model.IOledger.IOledger-counter.html#2833" class="Bound">f</a> <a id="2934" class="Symbol">(</a><a id="2935" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="2939" href="Simple-Model.IOledger.IOledger-counter.html#2841" class="Bound">m</a><a id="2940" class="Symbol">))</a> <a id="2943" href="Simple-Model.IOledger.IOledger-counter.html#2822" class="Bound">callAddr</a>

  
  <a id="executeLedgerStep5"></a><a id="2958" href="Simple-Model.IOledger.IOledger-counter.html#2958" class="Function">executeLedgerStep5</a> <a id="2977" class="Symbol">:</a> <a id="2979" class="Symbol">∀{</a><a id="2981" href="Simple-Model.IOledger.IOledger-counter.html#2981" class="Bound">i</a><a id="2982" class="Symbol">}</a> <a id="2984" class="Symbol">→</a> <a id="2986" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9495" class="Record">MsgAndLedger</a> <a id="2999" class="Symbol">→</a> <a id="3001" class="Symbol">(</a><a id="3002" href="Simple-Model.IOledger.IOledger-counter.html#3002" class="Bound">callAddr</a> <a id="3011" class="Symbol">:</a> <a id="3013" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="3020" class="Symbol">)</a> <a id="3022" class="Symbol">→</a> <a id="3024" href="interface.Base.html#731" class="Datatype">IO&#39;</a> <a id="3028" href="interface.Console.html#511" class="Function">consoleI</a> <a id="3037" href="Simple-Model.IOledger.IOledger-counter.html#2981" class="Bound">i</a> <a id="3039" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="3046" href="Simple-Model.IOledger.IOledger-counter.html#2958" class="Function">executeLedgerStep5</a> <a id="3065" class="Symbol">(</a><a id="3066" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9534" class="InductiveConstructor">msgAndLedger</a> <a id="3079" href="Simple-Model.IOledger.IOledger-counter.html#3079" class="Bound">newLedger</a> <a id="3089" class="Symbol">(</a><a id="3090" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#931" class="InductiveConstructor">theMsg</a> <a id="3097" class="Symbol">(</a><a id="3098" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="3102" href="Simple-Model.IOledger.IOledger-counter.html#3102" class="Bound">n</a><a id="3103" class="Symbol">)))</a> <a id="3107" href="Simple-Model.IOledger.IOledger-counter.html#3107" class="Bound">callAddr</a>
    <a id="3120" class="Symbol">=</a> <a id="3122" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="3128" class="Symbol">(</a><a id="3129" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="3138" class="Symbol">(</a><a id="3139" class="String">&quot;The result of execution is nat &quot;</a> <a id="3173" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="3182" href="Simple-Model.IOledger.IOledger-counter.html#3102" class="Bound">n</a><a id="3183" class="Symbol">)))</a>
      <a id="3193" class="Symbol">λ</a> <a id="3195" href="Simple-Model.IOledger.IOledger-counter.html#3195" class="Bound">_</a> <a id="3197" class="Symbol">→</a> <a id="3199" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="3208" href="Simple-Model.IOledger.IOledger-counter.html#3079" class="Bound">newLedger</a> <a id="3218" href="Simple-Model.IOledger.IOledger-counter.html#3107" class="Bound">callAddr</a>
  <a id="3229" href="Simple-Model.IOledger.IOledger-counter.html#2958" class="Function">executeLedgerStep5</a> <a id="3248" class="Symbol">(</a><a id="3249" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9534" class="InductiveConstructor">msgAndLedger</a> <a id="3262" href="Simple-Model.IOledger.IOledger-counter.html#3262" class="Bound">newLedger</a> <a id="3272" class="Symbol">(</a><a id="3273" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#931" class="InductiveConstructor">theMsg</a> <a id="3280" class="Symbol">(</a><a id="3281" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#451" class="InductiveConstructor">list</a> <a id="3286" href="Simple-Model.IOledger.IOledger-counter.html#3286" class="Bound">l</a><a id="3287" class="Symbol">)))</a> <a id="3291" href="Simple-Model.IOledger.IOledger-counter.html#3291" class="Bound">callAddr</a>
    <a id="3304" class="Symbol">=</a> <a id="3306" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="3312" class="Symbol">(</a><a id="3313" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="3322" class="String">&quot;The result of execution is of the form list l &quot;</a><a id="3370" class="Symbol">)</a>
      <a id="3378" class="Symbol">λ</a> <a id="3380" href="Simple-Model.IOledger.IOledger-counter.html#3380" class="Bound">_</a> <a id="3382" class="Symbol">→</a> <a id="3384" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="3393" href="Simple-Model.IOledger.IOledger-counter.html#3262" class="Bound">newLedger</a> <a id="3403" href="Simple-Model.IOledger.IOledger-counter.html#3291" class="Bound">callAddr</a>
  <a id="3414" href="Simple-Model.IOledger.IOledger-counter.html#2958" class="Function">executeLedgerStep5</a> <a id="3433" class="Symbol">(</a><a id="3434" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9534" class="InductiveConstructor">msgAndLedger</a> <a id="3447" href="Simple-Model.IOledger.IOledger-counter.html#3447" class="Bound">newLedger</a> <a id="3457" class="Symbol">(</a><a id="3458" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#959" class="InductiveConstructor">err</a> <a id="3462" href="Simple-Model.IOledger.IOledger-counter.html#3462" class="Bound">e</a><a id="3463" class="Symbol">))</a> <a id="3466" href="Simple-Model.IOledger.IOledger-counter.html#3466" class="Bound">callAddr</a>
    <a id="3479" class="Symbol">=</a> <a id="3481" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="3487" class="Symbol">(</a><a id="3488" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="3497" class="String">&quot;Error&quot;</a><a id="3504" class="Symbol">)</a>
      <a id="3512" class="Symbol">λ</a> <a id="3514" href="Simple-Model.IOledger.IOledger-counter.html#3514" class="Bound">_</a> <a id="3516" class="Symbol">→</a> <a id="3518" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="3525" class="Symbol">(</a><a id="3526" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="3535" class="Symbol">(</a><a id="3536" href="Simple-Model.IOledger.IOledger-counter.html#1189" class="Function">errorMsg2Str</a> <a id="3549" href="Simple-Model.IOledger.IOledger-counter.html#3462" class="Bound">e</a><a id="3550" class="Symbol">))</a>
      <a id="3559" class="Symbol">λ</a> <a id="3561" href="Simple-Model.IOledger.IOledger-counter.html#3561" class="Bound">_</a> <a id="3563" class="Symbol">→</a> <a id="3565" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="3574" href="Simple-Model.IOledger.IOledger-counter.html#3447" class="Bound">newLedger</a> <a id="3584" href="Simple-Model.IOledger.IOledger-counter.html#3466" class="Bound">callAddr</a>



<a id="3596" class="Comment">-- Second program to look up the balance of one contract</a>
  <a id="executeLedgercheckamount"></a><a id="3655" href="Simple-Model.IOledger.IOledger-counter.html#3655" class="Function">executeLedgercheckamount</a>    <a id="3683" class="Symbol">:</a> <a id="3685" class="Symbol">∀{</a><a id="3687" href="Simple-Model.IOledger.IOledger-counter.html#3687" class="Bound">i</a><a id="3688" class="Symbol">}</a> <a id="3690" class="Symbol">→</a> <a id="3692" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="3699" class="Symbol">→</a> <a id="3701" class="Symbol">(</a><a id="3702" href="Simple-Model.IOledger.IOledger-counter.html#3702" class="Bound">callAddr</a> <a id="3711" class="Symbol">:</a> <a id="3713" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="3720" class="Symbol">)</a> <a id="3722" class="Symbol">→</a> <a id="3724" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="3734" href="Simple-Model.IOledger.IOledger-counter.html#3687" class="Bound">i</a> <a id="3736" href="interface.Unit.html#38" class="Record">Unit</a>                              
  <a id="3773" href="Simple-Model.IOledger.IOledger-counter.html#3655" class="Function">executeLedgercheckamount</a> <a id="3798" href="Simple-Model.IOledger.IOledger-counter.html#3798" class="Bound">ledger</a> <a id="3805" href="Simple-Model.IOledger.IOledger-counter.html#3805" class="Bound">callAddr</a> <a id="3814" class="Symbol">.</a><a id="3815" href="interface.Base.html#689" class="Field">force</a>
   <a id="3824" class="Symbol">=</a> <a id="3826" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="3832" class="Symbol">(</a><a id="3833" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="3842" class="String">&quot;Enter the address of the contract you want to look up the balance&quot;</a><a id="3909" class="Symbol">)</a>
     <a id="3916" class="Symbol">λ</a> <a id="3918" href="Simple-Model.IOledger.IOledger-counter.html#3918" class="Bound">_</a> <a id="3920" class="Symbol">→</a> <a id="3922" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="3929" href="interface.Console.html#311" class="InductiveConstructor">getLine</a> 
     <a id="3943" class="Symbol">λ</a> <a id="3945" href="Simple-Model.IOledger.IOledger-counter.html#3945" class="Bound">line</a> <a id="3950" class="Symbol">→</a> <a id="3952" href="Simple-Model.IOledger.IOledger-counter.html#4020" class="Function">executeLedgercheckamountAux</a> <a id="3980" href="Simple-Model.IOledger.IOledger-counter.html#3798" class="Bound">ledger</a> <a id="3987" href="Simple-Model.IOledger.IOledger-counter.html#3805" class="Bound">callAddr</a> <a id="3996" class="Symbol">(</a><a id="3997" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="4007" class="Number">10</a> <a id="4010" href="Simple-Model.IOledger.IOledger-counter.html#3945" class="Bound">line</a><a id="4014" class="Symbol">)</a>


  <a id="executeLedgercheckamountAux"></a><a id="4020" href="Simple-Model.IOledger.IOledger-counter.html#4020" class="Function">executeLedgercheckamountAux</a> <a id="4048" class="Symbol">:</a> <a id="4050" class="Symbol">∀{</a><a id="4052" href="Simple-Model.IOledger.IOledger-counter.html#4052" class="Bound">i</a><a id="4053" class="Symbol">}</a> <a id="4055" class="Symbol">→</a> <a id="4057" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a>  <a id="4065" class="Symbol">→</a> <a id="4067" class="Symbol">(</a><a id="4068" href="Simple-Model.IOledger.IOledger-counter.html#4068" class="Bound">callAddr</a> <a id="4077" class="Symbol">:</a> <a id="4079" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4086" class="Symbol">)</a> <a id="4088" class="Symbol">→</a> <a id="4090" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="4096" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="4098" class="Symbol">→</a> <a id="4100" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="4110" href="Simple-Model.IOledger.IOledger-counter.html#4052" class="Bound">i</a> <a id="4112" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="4119" href="Simple-Model.IOledger.IOledger-counter.html#4020" class="Function">executeLedgercheckamountAux</a> <a id="4147" href="Simple-Model.IOledger.IOledger-counter.html#4147" class="Bound">ledger</a> <a id="4154" href="Simple-Model.IOledger.IOledger-counter.html#4154" class="Bound">callAddr</a> <a id="4163" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="4171" class="Symbol">.</a><a id="4172" href="interface.Base.html#689" class="Field">force</a>
   <a id="4181" class="Symbol">=</a> <a id="4183" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="4189" class="Symbol">(</a><a id="4190" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="4199" class="String">&quot;Please enter a natural number&quot;</a><a id="4230" class="Symbol">)</a>
     <a id="4237" class="Symbol">λ</a> <a id="4239" href="Simple-Model.IOledger.IOledger-counter.html#4239" class="Bound">_</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="Simple-Model.IOledger.IOledger-counter.html#3655" class="Function">executeLedgercheckamount</a> <a id="4268" href="Simple-Model.IOledger.IOledger-counter.html#4147" class="Bound">ledger</a> <a id="4275" href="Simple-Model.IOledger.IOledger-counter.html#4154" class="Bound">callAddr</a>
  <a id="4286" href="Simple-Model.IOledger.IOledger-counter.html#4020" class="Function">executeLedgercheckamountAux</a> <a id="4314" href="Simple-Model.IOledger.IOledger-counter.html#4314" class="Bound">ledger</a> <a id="4321" href="Simple-Model.IOledger.IOledger-counter.html#4321" class="Bound">callAddr</a> <a id="4330" class="Symbol">(</a><a id="4331" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="4336" href="Simple-Model.IOledger.IOledger-counter.html#4336" class="Bound">calledAddr</a><a id="4346" class="Symbol">)</a> <a id="4348" class="Symbol">.</a><a id="4349" href="interface.Base.html#689" class="Field">force</a>
   <a id="4358" class="Symbol">=</a> <a id="4360" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="4366" class="Symbol">(</a><a id="4367" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a>
            <a id="4388" class="Symbol">(</a><a id="4389" class="String">&quot;The available money is &quot;</a> <a id="4415" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4418" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="4423" class="Symbol">(</a><a id="4424" href="Simple-Model.IOledger.IOledger-counter.html#4314" class="Bound">ledger</a> <a id="4431" href="Simple-Model.IOledger.IOledger-counter.html#4336" class="Bound">calledAddr</a> <a id="4442" class="Symbol">.</a><a id="4443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a><a id="4449" class="Symbol">)</a>
             <a id="4464" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4467" class="String">&quot; wei in address &quot;</a> <a id="4486" href="Data.String.Base.html#2366" class="Function Operator">++</a> <a id="4489" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="4494" href="Simple-Model.IOledger.IOledger-counter.html#4336" class="Bound">calledAddr</a><a id="4504" class="Symbol">))</a>
     <a id="4512" class="Symbol">λ</a> <a id="4514" href="Simple-Model.IOledger.IOledger-counter.html#4514" class="Bound">line</a> <a id="4519" class="Symbol">→</a> <a id="4521" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="4530" href="Simple-Model.IOledger.IOledger-counter.html#4314" class="Bound">ledger</a> <a id="4537" href="Simple-Model.IOledger.IOledger-counter.html#4321" class="Bound">callAddr</a>



<a id="4549" class="Comment">--- third program to change the calling address</a>
  <a id="executeLedgerChangeCallingAddress"></a><a id="4599" href="Simple-Model.IOledger.IOledger-counter.html#4599" class="Function">executeLedgerChangeCallingAddress</a> <a id="4633" class="Symbol">:</a> <a id="4635" class="Symbol">∀{</a><a id="4637" href="Simple-Model.IOledger.IOledger-counter.html#4637" class="Bound">i</a><a id="4638" class="Symbol">}</a> <a id="4640" class="Symbol">→</a> <a id="4642" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="4649" class="Symbol">→</a> <a id="4651" class="Symbol">(</a><a id="4652" href="Simple-Model.IOledger.IOledger-counter.html#4652" class="Bound">callAddr</a> <a id="4661" class="Symbol">:</a> <a id="4663" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4670" class="Symbol">)</a> <a id="4672" class="Symbol">→</a> <a id="4674" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="4684" href="Simple-Model.IOledger.IOledger-counter.html#4637" class="Bound">i</a> <a id="4686" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="4693" href="Simple-Model.IOledger.IOledger-counter.html#4599" class="Function">executeLedgerChangeCallingAddress</a> <a id="4727" href="Simple-Model.IOledger.IOledger-counter.html#4727" class="Bound">ledger</a> <a id="4734" href="Simple-Model.IOledger.IOledger-counter.html#4734" class="Bound">callAddr</a> <a id="4743" class="Symbol">.</a><a id="4744" href="interface.Base.html#689" class="Field">force</a>
   <a id="4753" class="Symbol">=</a> <a id="4755" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="4761" class="Symbol">(</a><a id="4762" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="4771" class="String">&quot;Enter the new calling address&quot;</a><a id="4802" class="Symbol">)</a>
     <a id="4809" class="Symbol">λ</a> <a id="4811" href="Simple-Model.IOledger.IOledger-counter.html#4811" class="Bound">_</a> <a id="4813" class="Symbol">→</a> <a id="4815" href="interface.Base.html#1415" class="Function">IOexec</a> <a id="4822" href="interface.Console.html#311" class="InductiveConstructor">getLine</a>
     <a id="4835" class="Symbol">λ</a> <a id="4837" href="Simple-Model.IOledger.IOledger-counter.html#4837" class="Bound">line</a> <a id="4842" class="Symbol">→</a> <a id="4844" href="Simple-Model.IOledger.IOledger-counter.html#4921" class="Function">executeLedgerChangeCallingAddressAux</a> <a id="4881" href="Simple-Model.IOledger.IOledger-counter.html#4727" class="Bound">ledger</a> <a id="4888" href="Simple-Model.IOledger.IOledger-counter.html#4734" class="Bound">callAddr</a> <a id="4897" class="Symbol">(</a><a id="4898" href="Data.Nat.Show.html#923" class="Function">readMaybe</a> <a id="4908" class="Number">10</a> <a id="4911" href="Simple-Model.IOledger.IOledger-counter.html#4837" class="Bound">line</a><a id="4915" class="Symbol">)</a>


  <a id="executeLedgerChangeCallingAddressAux"></a><a id="4921" href="Simple-Model.IOledger.IOledger-counter.html#4921" class="Function">executeLedgerChangeCallingAddressAux</a> <a id="4958" class="Symbol">:</a> <a id="4960" class="Symbol">∀{</a><a id="4962" href="Simple-Model.IOledger.IOledger-counter.html#4962" class="Bound">i</a><a id="4963" class="Symbol">}</a> <a id="4965" class="Symbol">→</a> <a id="4967" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="4974" class="Symbol">→</a> <a id="4976" class="Symbol">(</a><a id="4977" href="Simple-Model.IOledger.IOledger-counter.html#4977" class="Bound">callAddr</a> <a id="4986" class="Symbol">:</a> <a id="4988" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4995" class="Symbol">)</a> <a id="4997" class="Symbol">→</a> <a id="4999" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5005" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="5013" class="Symbol">→</a> <a id="5015" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="5025" href="Simple-Model.IOledger.IOledger-counter.html#4962" class="Bound">i</a> <a id="5027" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="5034" href="Simple-Model.IOledger.IOledger-counter.html#4921" class="Function">executeLedgerChangeCallingAddressAux</a> <a id="5071" href="Simple-Model.IOledger.IOledger-counter.html#5071" class="Bound">ledger</a> <a id="5078" href="Simple-Model.IOledger.IOledger-counter.html#5078" class="Bound">callAddr</a> <a id="5087" class="Symbol">(</a><a id="5088" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5093" href="Simple-Model.IOledger.IOledger-counter.html#5093" class="Bound">callingAddr</a><a id="5104" class="Symbol">)</a>
      <a id="5112" class="Symbol">=</a> <a id="5114" href="Simple-Model.IOledger.IOledger-counter.html#1388" class="Function">executeLedger</a> <a id="5128" href="Simple-Model.IOledger.IOledger-counter.html#5071" class="Bound">ledger</a> <a id="5135" href="Simple-Model.IOledger.IOledger-counter.html#5078" class="Bound">callAddr</a>
  <a id="5146" href="Simple-Model.IOledger.IOledger-counter.html#4921" class="Function">executeLedgerChangeCallingAddressAux</a> <a id="5183" href="Simple-Model.IOledger.IOledger-counter.html#5183" class="Bound">ledger</a> <a id="5190" href="Simple-Model.IOledger.IOledger-counter.html#5190" class="Bound">callAddr</a> <a id="5199" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="5207" class="Symbol">.</a><a id="5208" href="interface.Base.html#689" class="Field">force</a>
      <a id="5220" class="Symbol">=</a> <a id="5222" href="interface.Base.html#775" class="InductiveConstructor">exec&#39;</a> <a id="5228" class="Symbol">(</a><a id="5229" href="interface.Console.html#273" class="InductiveConstructor">putStrLn</a> <a id="5238" class="String">&quot;Please enter a number&quot;</a><a id="5261" class="Symbol">)</a>
      <a id="5269" class="Symbol">λ</a> <a id="5271" href="Simple-Model.IOledger.IOledger-counter.html#5271" class="Bound">_</a> <a id="5273" class="Symbol">→</a> <a id="5275" href="Simple-Model.IOledger.IOledger-counter.html#4599" class="Function">executeLedgerChangeCallingAddress</a> <a id="5309" href="Simple-Model.IOledger.IOledger-counter.html#5183" class="Bound">ledger</a> <a id="5316" href="Simple-Model.IOledger.IOledger-counter.html#5190" class="Bound">callAddr</a>




<a id="5329" class="Comment">-- define our interface  </a>
  <a id="mainBody"></a><a id="5357" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="5366" class="Symbol">:</a> <a id="5368" class="Symbol">∀{</a><a id="5370" href="Simple-Model.IOledger.IOledger-counter.html#5370" class="Bound">i</a><a id="5371" class="Symbol">}</a> <a id="5373" class="Symbol">→</a> <a id="5375" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="5382" class="Symbol">→</a> <a id="5384" class="Symbol">(</a><a id="5385" href="Simple-Model.IOledger.IOledger-counter.html#5385" class="Bound">callAddr</a> <a id="5394" class="Symbol">:</a> <a id="5396" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5403" class="Symbol">)</a> <a id="5405" class="Symbol">→</a> <a id="5407" href="interface.Console.html#610" class="Function">IOConsole</a> <a id="5417" href="Simple-Model.IOledger.IOledger-counter.html#5370" class="Bound">i</a>  <a id="5420" href="interface.Unit.html#38" class="Record">Unit</a>
  <a id="5427" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="5436" href="Simple-Model.IOledger.IOledger-counter.html#5436" class="Bound">ledger</a> <a id="5443" href="Simple-Model.IOledger.IOledger-counter.html#5443" class="Bound">callAddr</a> <a id="5452" class="Symbol">.</a><a id="5453" href="interface.Base.html#689" class="Field">force</a>
    <a id="5463" class="Symbol">=</a>  <a id="5466" href="interface.ConsoleLib.html#689" class="Function">WriteString&#39;</a>
       <a id="5486" class="String">&quot;Please choose one of the following options:
             1- Execute a function of a contract.
             2- Look up the balance of a contract.
             3- Change the calling address.
             4- Terminate the program.&quot;</a> <a id="5716" class="Symbol">λ</a> <a id="5718" href="Simple-Model.IOledger.IOledger-counter.html#5718" class="Bound">_</a> <a id="5720" class="Symbol">→</a> 
      <a id="5729" class="Symbol">(</a><a id="5730" href="interface.ConsoleLib.html#851" class="Function">GetLine</a> <a id="5738" href="interface.Base.html#1801" class="Function Operator">&gt;&gt;=</a> <a id="5742" class="Symbol">λ</a> <a id="5744" href="Simple-Model.IOledger.IOledger-counter.html#5744" class="Bound">str</a> <a id="5748" class="Symbol">→</a>
      <a id="5756" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="5759" href="Simple-Model.IOledger.IOledger-counter.html#5744" class="Bound">str</a>       <a id="5769" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="5772" class="String">&quot;1&quot;</a>  <a id="5777" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="5782" href="Simple-Model.IOledger.IOledger-counter.html#1388" class="Function">executeLedger</a> <a id="5796" href="Simple-Model.IOledger.IOledger-counter.html#5436" class="Bound">ledger</a> <a id="5803" href="Simple-Model.IOledger.IOledger-counter.html#5443" class="Bound">callAddr</a>
      <a id="5818" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="5823" class="Symbol">(</a><a id="5824" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="5827" href="Simple-Model.IOledger.IOledger-counter.html#5744" class="Bound">str</a> <a id="5831" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="5834" class="String">&quot;2&quot;</a>  <a id="5839" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="5844" href="Simple-Model.IOledger.IOledger-counter.html#3655" class="Function">executeLedgercheckamount</a> <a id="5869" href="Simple-Model.IOledger.IOledger-counter.html#5436" class="Bound">ledger</a> <a id="5876" href="Simple-Model.IOledger.IOledger-counter.html#5443" class="Bound">callAddr</a>
      <a id="5891" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="5896" class="Symbol">(</a><a id="5897" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="5900" href="Simple-Model.IOledger.IOledger-counter.html#5744" class="Bound">str</a> <a id="5904" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="5907" class="String">&quot;3&quot;</a>  <a id="5912" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="5917" href="Simple-Model.IOledger.IOledger-counter.html#4599" class="Function">executeLedgerChangeCallingAddress</a> <a id="5951" href="Simple-Model.IOledger.IOledger-counter.html#5436" class="Bound">ledger</a> <a id="5958" href="Simple-Model.IOledger.IOledger-counter.html#5443" class="Bound">callAddr</a>
      <a id="5973" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="5978" class="Symbol">(</a><a id="5979" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="5982" href="Simple-Model.IOledger.IOledger-counter.html#5744" class="Bound">str</a> <a id="5986" href="Data.String.Properties.html#4029" class="Function Operator">==</a> <a id="5989" class="String">&quot;4&quot;</a>  <a id="5994" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="5999" href="interface.ConsoleLib.html#375" class="Function">WriteString</a> <a id="6011" class="String">&quot;The program will be terminated&quot;</a>
      <a id="6050" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="6055" href="interface.ConsoleLib.html#464" class="Function">WriteStringWithCont</a> <a id="6075" class="String">&quot;Please enter 1,2,3 or 4&quot;</a>
      <a id="6107" class="Symbol">λ</a> <a id="6109" href="Simple-Model.IOledger.IOledger-counter.html#6109" class="Bound">_</a> <a id="6111" class="Symbol">→</a> <a id="6113" href="Simple-Model.IOledger.IOledger-counter.html#5357" class="Function">mainBody</a> <a id="6122" href="Simple-Model.IOledger.IOledger-counter.html#5436" class="Bound">ledger</a> <a id="6129" href="Simple-Model.IOledger.IOledger-counter.html#5443" class="Bound">callAddr</a><a id="6137" class="Symbol">))))</a>

<a id="6143" class="Comment">-- The main function is defined in the example files e.g.</a>
<a id="6201" class="Comment">-- Agdacode/agda/Simple-Model/IOledger/IOledger-counter.agda</a>

</pre></body></html>