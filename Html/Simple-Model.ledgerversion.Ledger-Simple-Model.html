<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.ledgerversion.Ledger-Simple-Model</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--@PREFIX@simpleModelledger</a>
<a id="29" class="Keyword">module</a> <a id="36" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="140" class="Keyword">using</a> <a id="146" class="Symbol">(</a><a id="147" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="150" class="Symbol">)</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.List.html" class="Module">Data.List</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="295" class="Keyword">hiding</a> <a id="302" class="Symbol">(</a><a id="303" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="308" class="Symbol">)</a>
<a id="310" class="Keyword">open</a> <a id="315" class="Keyword">import</a> <a id="322" href="Data.String.html" class="Module">Data.String</a> <a id="334" class="Keyword">hiding</a> <a id="341" class="Symbol">(</a><a id="342" href="Data.String.Base.html#2430" class="Function">length</a><a id="348" class="Symbol">)</a>

<a id="351" class="Comment">--library for simple model</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>

<a id="459" class="Comment">-- main library</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>




<a id="512" class="Keyword">mutual</a>


<a id="521" class="Comment">-- smart contract-comands:</a>
  <a id="550" class="Keyword">data</a> <a id="CCommands"></a><a id="555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a> <a id="565" class="Symbol">:</a> <a id="567" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="571" class="Keyword">where</a>
    <a id="CCommands.transferc"></a><a id="581" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="InductiveConstructor">transferc</a>  <a id="592" class="Symbol">:</a>  <a id="595" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a> <a id="602" class="Symbol">→</a> <a id="604" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="612" class="Symbol">→</a> <a id="614" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.callc"></a><a id="628" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a>      <a id="639" class="Symbol">:</a>  <a id="642" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="650" class="Symbol">→</a> <a id="652" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="665" class="Symbol">→</a> <a id="667" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="671" class="Symbol">→</a> <a id="673" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.updatec"></a><a id="687" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a>    <a id="698" class="Symbol">:</a>  <a id="701" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="714" class="Symbol">→</a> <a id="716" class="Symbol">(</a><a id="717" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="721" class="Symbol">→</a> <a id="723" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="741" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="744" class="Symbol">)</a> <a id="746" class="Symbol">→</a> <a id="748" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.currentAddrLookupc"></a><a id="762" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#762" class="InductiveConstructor">currentAddrLookupc</a>  <a id="782" class="Symbol">:</a> <a id="784" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="798" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#798" class="InductiveConstructor">callAddrLookupc</a>     <a id="818" class="Symbol">:</a> <a id="820" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#834" class="InductiveConstructor">getAmountc</a>          <a id="854" class="Symbol">:</a> <a id="856" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="864" class="Symbol">→</a> <a id="866" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>


<a id="878" class="Comment">-- smart contract response</a>
  <a id="CResponse"></a><a id="907" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="917" class="Symbol">:</a> <a id="919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a> <a id="929" class="Symbol">→</a> <a id="931" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="937" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="947" class="Symbol">(</a><a id="948" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="InductiveConstructor">transferc</a> <a id="958" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#958" class="Bound">amount</a> <a id="965" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#965" class="Bound">addr</a><a id="969" class="Symbol">)</a>  <a id="972" class="Symbol">=</a>  <a id="975" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="979" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="989" class="Symbol">(</a><a id="990" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a> <a id="996" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#996" class="Bound">addr</a> <a id="1001" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1001" class="Bound">fname</a> <a id="1007" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1007" class="Bound">msg</a><a id="1010" class="Symbol">)</a>   <a id="1014" class="Symbol">=</a>  <a id="1017" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
  <a id="1023" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="1033" class="Symbol">(</a><a id="1034" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a> <a id="1042" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1042" class="Bound">fname</a> <a id="1048" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1048" class="Bound">fdef</a><a id="1052" class="Symbol">)</a>     <a id="1058" class="Symbol">=</a>  <a id="1061" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="1065" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="1075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#762" class="InductiveConstructor">currentAddrLookupc</a>       <a id="1100" class="Symbol">=</a> <a id="1102" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
  <a id="1112" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="1122" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#798" class="InductiveConstructor">callAddrLookupc</a>          <a id="1147" class="Symbol">=</a> <a id="1149" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
  <a id="1159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="1169" class="Symbol">(</a><a id="1170" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#834" class="InductiveConstructor">getAmountc</a> <a id="1181" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1181" class="Bound">addr</a><a id="1185" class="Symbol">)</a>        <a id="1194" class="Symbol">=</a> <a id="1196" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a>



<a id="1206" class="Comment">--SmartContractExec is datatype of what happens when a function is applied to its arguments.</a>
  <a id="1301" class="Keyword">data</a> <a id="SmartContractExec"></a><a id="1306" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1325" class="Bound">A</a> <a id="1327" class="Symbol">:</a> <a id="1329" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1332" class="Symbol">)</a> <a id="1334" class="Symbol">:</a> <a id="1336" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1340" class="Keyword">where</a>
    <a id="SmartContractExec.return"></a><a id="1350" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a>  <a id="1358" class="Symbol">:</a>  <a id="1361" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1325" class="Bound">A</a> <a id="1363" class="Symbol">→</a> <a id="1365" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1383" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1325" class="Bound">A</a>
    <a id="SmartContractExec.error"></a><a id="1389" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a>   <a id="1397" class="Symbol">:</a>  <a id="1400" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#572" class="Datatype">ErrorMsg</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1429" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1325" class="Bound">A</a>
    <a id="SmartContractExec.exec"></a><a id="1435" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a>    <a id="1443" class="Symbol">:</a>  <a id="1446" class="Symbol">(</a><a id="1447" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1447" class="Bound">c</a> <a id="1449" class="Symbol">:</a> <a id="1451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a><a id="1460" class="Symbol">)</a> <a id="1462" class="Symbol">→</a> <a id="1464" class="Symbol">(</a><a id="1465" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#907" class="Function">CResponse</a> <a id="1475" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1447" class="Bound">c</a> <a id="1477" class="Symbol">→</a> <a id="1479" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1497" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1325" class="Bound">A</a><a id="1498" class="Symbol">)</a>
            <a id="1512" class="Symbol">→</a> <a id="1514" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1532" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1325" class="Bound">A</a>


<a id="_&gt;&gt;==_"></a><a id="1536" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1536" class="Function Operator">_&gt;&gt;==_</a> <a id="1543" class="Symbol">:</a> <a id="1545" class="Symbol">{</a><a id="1546" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1546" class="Bound">A</a> <a id="1548" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1548" class="Bound">B</a> <a id="1550" class="Symbol">:</a> <a id="1552" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1555" class="Symbol">}</a> <a id="1557" class="Symbol">→</a> <a id="1559" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1546" class="Bound">A</a> <a id="1579" class="Symbol">→</a> <a id="1581" class="Symbol">(</a><a id="1582" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1546" class="Bound">A</a> <a id="1584" class="Symbol">→</a> <a id="1586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1604" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1548" class="Bound">B</a><a id="1605" class="Symbol">)</a> <a id="1607" class="Symbol">→</a> <a id="1609" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1627" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1548" class="Bound">B</a>
<a id="1629" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a> <a id="1636" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1636" class="Bound">x</a> <a id="1638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1536" class="Function Operator">&gt;&gt;==</a> <a id="1643" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1643" class="Bound">q</a> <a id="1645" class="Symbol">=</a> <a id="1647" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1643" class="Bound">q</a> <a id="1649" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1636" class="Bound">x</a>
<a id="1651" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a> <a id="1657" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1657" class="Bound">x</a> <a id="1659" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1536" class="Function Operator">&gt;&gt;==</a> <a id="1664" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1664" class="Bound">q</a> <a id="1666" class="Symbol">=</a> <a id="1668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a> <a id="1674" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1657" class="Bound">x</a>
<a id="1676" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="1681" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1681" class="Bound">c</a> <a id="1683" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1683" class="Bound">x</a> <a id="1685" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1536" class="Function Operator">&gt;&gt;==</a> <a id="1690" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1690" class="Bound">q</a> <a id="1692" class="Symbol">=</a> <a id="1694" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="1699" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1681" class="Bound">c</a> <a id="1701" class="Symbol">(λ</a> <a id="1704" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1704" class="Bound">r</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1683" class="Bound">x</a> <a id="1710" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1704" class="Bound">r</a> <a id="1712" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1536" class="Function Operator">&gt;&gt;==</a> <a id="1717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1690" class="Bound">q</a><a id="1718" class="Symbol">)</a>


<a id="_&gt;&gt;_"></a><a id="1722" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1722" class="Function Operator">_&gt;&gt;_</a> <a id="1727" class="Symbol">:</a> <a id="1729" class="Symbol">{</a><a id="1730" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1730" class="Bound">A</a> <a id="1732" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1732" class="Bound">B</a> <a id="1734" class="Symbol">:</a> <a id="1736" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1739" class="Symbol">}</a> <a id="1741" class="Symbol">→</a> <a id="1743" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1761" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1730" class="Bound">A</a> <a id="1763" class="Symbol">→</a> <a id="1765" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1783" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1732" class="Bound">B</a> <a id="1785" class="Symbol">→</a> <a id="1787" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="1805" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1732" class="Bound">B</a>
<a id="1807" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a> <a id="1814" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1814" class="Bound">x</a> <a id="1816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1722" class="Function Operator">&gt;&gt;</a> <a id="1819" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1819" class="Bound">q</a> <a id="1821" class="Symbol">=</a> <a id="1823" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1819" class="Bound">q</a>
<a id="1825" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a> <a id="1831" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1831" class="Bound">x</a> <a id="1833" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1722" class="Function Operator">&gt;&gt;</a> <a id="1836" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1836" class="Bound">q</a> <a id="1838" class="Symbol">=</a> <a id="1840" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a> <a id="1846" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1831" class="Bound">x</a>
<a id="1848" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="1853" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1853" class="Bound">c</a> <a id="1855" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1855" class="Bound">x</a> <a id="1857" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1722" class="Function Operator">&gt;&gt;</a> <a id="1860" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1860" class="Bound">q</a> <a id="1862" class="Symbol">=</a> <a id="1864" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="1869" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1853" class="Bound">c</a> <a id="1871" class="Symbol">(λ</a> <a id="1874" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1874" class="Bound">r</a> <a id="1876" class="Symbol">→</a> <a id="1878" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1855" class="Bound">x</a> <a id="1880" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1874" class="Bound">r</a> <a id="1882" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1722" class="Function Operator">&gt;&gt;</a> <a id="1885" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1860" class="Bound">q</a><a id="1886" class="Symbol">)</a>



<a id="1891" class="Comment">-- Definition of simple contract</a>
<a id="1924" class="Keyword">record</a> <a id="Contract"></a><a id="1931" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1931" class="Record">Contract</a> <a id="1940" class="Symbol">:</a> <a id="1942" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1946" class="Keyword">where</a>
  <a id="1954" class="Keyword">constructor</a> <a id="contract"></a><a id="1966" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1966" class="InductiveConstructor">contract</a>
  <a id="1977" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="1987" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a>  <a id="1995" class="Symbol">:</a>  <a id="1998" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="2009" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a>     <a id="2017" class="Symbol">:</a>  <a id="2020" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2033" class="Symbol">→</a> <a id="2035" class="Symbol">(</a><a id="2036" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2040" class="Symbol">→</a> <a id="2042" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2060" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2063" class="Symbol">)</a>
<a id="2065" class="Keyword">open</a> <a id="2070" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1931" class="Module">Contract</a> <a id="2079" class="Keyword">public</a>



<a id="2089" class="Comment">-- ledger</a>
<a id="Ledger"></a><a id="2099" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="2106" class="Symbol">:</a> <a id="2108" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2112" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="2119" class="Symbol">=</a> <a id="2121" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>  <a id="2130" class="Symbol">→</a> <a id="2132" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1931" class="Record">Contract</a>


<a id="2143" class="Comment">--- theses functions below we use them with do notation</a>
<a id="call"></a><a id="2199" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2199" class="Function">call</a> <a id="2204" class="Symbol">:</a> <a id="2206" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>  <a id="2215" class="Symbol">→</a> <a id="2217" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2230" class="Symbol">→</a> <a id="2232" class="Symbol">(</a><a id="2233" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2237" class="Symbol">→</a> <a id="2239" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2257" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2260" class="Symbol">)</a>
<a id="2262" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2199" class="Function">call</a> <a id="2267" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2267" class="Bound">addr</a> <a id="2272" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2272" class="Bound">fname</a> <a id="2278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2278" class="Bound">msg</a> <a id="2282" class="Symbol">=</a> <a id="2284" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="2289" class="Symbol">(</a><a id="2290" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a> <a id="2296" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2267" class="Bound">addr</a> <a id="2301" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2272" class="Bound">fname</a> <a id="2307" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2278" class="Bound">msg</a><a id="2310" class="Symbol">)</a> <a id="2312" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a>

<a id="update"></a><a id="2320" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2320" class="Function">update</a> <a id="2327" class="Symbol">:</a> <a id="2329" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2342" class="Symbol">→</a> <a id="2344" class="Symbol">(</a><a id="2345" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2349" class="Symbol">→</a> <a id="2351" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2369" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2372" class="Symbol">)</a> <a id="2374" class="Symbol">→</a> <a id="2376" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2394" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2396" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2320" class="Function">update</a> <a id="2403" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2403" class="Bound">fname</a> <a id="2409" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2409" class="Bound">fdef</a> <a id="2414" class="Symbol">=</a> <a id="2416" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="2421" class="Symbol">(</a><a id="2422" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a> <a id="2430" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2403" class="Bound">fname</a> <a id="2436" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2409" class="Bound">fdef</a><a id="2440" class="Symbol">)</a> <a id="2442" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a>

<a id="currentAddrLookup"></a><a id="2450" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2450" class="Function">currentAddrLookup</a> <a id="2468" class="Symbol">:</a> <a id="2470" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2488" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
<a id="2496" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2450" class="Function">currentAddrLookup</a> <a id="2514" class="Symbol">=</a> <a id="2516" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="2521" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#762" class="InductiveConstructor">currentAddrLookupc</a> <a id="2540" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a>

<a id="callAddrLookup"></a><a id="2548" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2548" class="Function">callAddrLookup</a> <a id="2563" class="Symbol">:</a> <a id="2565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2583" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
<a id="2591" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2548" class="Function">callAddrLookup</a> <a id="2606" class="Symbol">=</a> <a id="2608" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="2613" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#798" class="InductiveConstructor">callAddrLookupc</a> <a id="2629" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a>

<a id="transfer"></a><a id="2637" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2637" class="Function">transfer</a> <a id="2646" class="Symbol">:</a> <a id="2648" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a> <a id="2655" class="Symbol">→</a> <a id="2657" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="2665" class="Symbol">→</a> <a id="2667" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2685" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2687" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2637" class="Function">transfer</a> <a id="2696" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2696" class="Bound">amount</a> <a id="2703" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2703" class="Bound">addr</a> <a id="2708" class="Symbol">=</a>  <a id="2711" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="InductiveConstructor">exec</a> <a id="2716" class="Symbol">(</a><a id="2717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="InductiveConstructor">transferc</a> <a id="2727" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2696" class="Bound">amount</a> <a id="2734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2703" class="Bound">addr</a><a id="2738" class="Symbol">)</a> <a id="2740" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a>



<a id="2750" class="Comment">-- the definition of execution stack elements</a>
<a id="2796" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="2803" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2803" class="Record">ExecStackEl</a> <a id="2815" class="Symbol">:</a> <a id="2817" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2821" class="Keyword">where</a>
  <a id="2829" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="2841" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2841" class="InductiveConstructor">execStackEl</a>
  <a id="2855" class="Keyword">field</a>
    <a id="ExecStackEl.lastCallAddress"></a><a id="2865" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2865" class="Field">lastCallAddress</a>  <a id="2882" class="Symbol">:</a>  <a id="2885" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="ExecStackEl.calledAddress"></a><a id="2897" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2897" class="Field">calledAddress</a>    <a id="2914" class="Symbol">:</a>  <a id="2917" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="ExecStackEl.continuation"></a><a id="2929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2929" class="Field">continuation</a>     <a id="2946" class="Symbol">:</a>  <a id="2949" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2953" class="Symbol">→</a> <a id="2955" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="2973" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
<a id="2977" class="Keyword">open</a> <a id="2982" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2803" class="Module">ExecStackEl</a> <a id="2994" class="Keyword">public</a>


<a id="3003" class="Comment">-- the definition of the execution stack function function</a>
<a id="ExecutionStack"></a><a id="3062" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3062" class="Function">ExecutionStack</a> <a id="3077" class="Symbol">:</a> <a id="3079" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3083" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3062" class="Function">ExecutionStack</a> <a id="3098" class="Symbol">=</a> <a id="3100" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3105" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2803" class="Record">ExecStackEl</a>



<a id="3120" class="Comment">{- StateExecFun is an intermediate state when we are evaluating a function call
   in a contract
   it consists of
        - the ledger  (which might changed because of updates)
        - executionStack  contains partially evaluated calls to other contracts together with their addresses
        - the current address
        - and the currently partially evaluated function we are evaluating
-}</a>
<a id="3516" class="Keyword">record</a> <a id="StateExecFun"></a><a id="3523" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a> <a id="3536" class="Symbol">:</a> <a id="3538" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3542" class="Keyword">where</a>
  <a id="3550" class="Keyword">constructor</a> <a id="stateEF"></a><a id="3562" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a>
  <a id="3572" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="3582" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3582" class="Field">ledger</a>           <a id="3599" class="Symbol">:</a>  <a id="3602" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="3613" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3613" class="Field">executionStack</a>   <a id="3630" class="Symbol">:</a>  <a id="3633" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3062" class="Function">ExecutionStack</a>
    <a id="StateExecFun.lastCallAddress"></a><a id="3652" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3652" class="Field">lastCallAddress</a>  <a id="3669" class="Symbol">:</a>  <a id="3672" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="StateExecFun.currentAddress"></a><a id="3684" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3684" class="Field">currentAddress</a>   <a id="3701" class="Symbol">:</a>  <a id="3704" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="StateExecFun.nextstep"></a><a id="3716" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3716" class="Field">nextstep</a>         <a id="3733" class="Symbol">:</a>  <a id="3736" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="3754" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
<a id="3758" class="Keyword">open</a> <a id="3763" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Module">StateExecFun</a> <a id="3776" class="Keyword">public</a>



<a id="3786" class="Comment">--update ledger</a>
<a id="updateLedger"></a><a id="3802" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3802" class="Function">updateLedger</a> <a id="3815" class="Symbol">:</a> <a id="3817" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="3824" class="Symbol">→</a>  <a id="3827" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="3835" class="Symbol">→</a> <a id="3837" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="3850" class="Symbol">→</a> <a id="3852" class="Symbol">(</a><a id="3853" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="3857" class="Symbol">→</a> <a id="3859" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="3877" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="3880" class="Symbol">)</a> <a id="3882" class="Symbol">→</a> <a id="3884" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a>
<a id="3891" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3802" class="Function">updateLedger</a> <a id="3904" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3904" class="Bound">ledger</a> <a id="3911" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3911" class="Bound">changedAddr</a> <a id="3923" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3923" class="Bound">changedFname</a> <a id="3936" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3936" class="Bound">f</a> <a id="3938" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3938" class="Bound">a</a> <a id="3940" class="Symbol">.</a><a id="3941" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a>    <a id="3951" class="Symbol">=</a> <a id="3953" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3904" class="Bound">ledger</a> <a id="3960" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3938" class="Bound">a</a> <a id="3962" class="Symbol">.</a><a id="3963" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a>
<a id="3970" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3802" class="Function">updateLedger</a> <a id="3983" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3983" class="Bound">ledger</a> <a id="3990" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3990" class="Bound">changedAddr</a> <a id="4002" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4002" class="Bound">changedFname</a> <a id="4015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4015" class="Bound">f</a> <a id="4017" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4017" class="Bound">a</a> <a id="4019" class="Symbol">.</a><a id="4020" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a> <a id="4024" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4024" class="Bound">fname</a> <a id="4030" class="Symbol">=</a> <a id="4032" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4035" class="Symbol">(</a><a id="4036" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4017" class="Bound">a</a> <a id="4038" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4041" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3990" class="Bound">changedAddr</a><a id="4052" class="Symbol">)</a> <a id="4054" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="4056" class="Symbol">(</a><a id="4057" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4024" class="Bound">fname</a> <a id="4063" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#297" class="Function Operator">≡fun</a> <a id="4068" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4002" class="Bound">changedFname</a><a id="4080" class="Symbol">)</a>
                                                              <a id="4144" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4149" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4015" class="Bound">f</a> <a id="4151" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4156" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3983" class="Bound">ledger</a> <a id="4163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4017" class="Bound">a</a> <a id="4165" class="Symbol">.</a><a id="4166" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a> <a id="4170" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4024" class="Bound">fname</a>


<a id="4178" class="Comment">--update ledger amount</a>
<a id="updateLedgerAmount"></a><a id="4201" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4201" class="Function">updateLedgerAmount</a> <a id="4220" class="Symbol">:</a> <a id="4222" class="Symbol">(</a><a id="4223" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4223" class="Bound">ledger</a> <a id="4230" class="Symbol">:</a> <a id="4232" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a><a id="4238" class="Symbol">)</a>
                     <a id="4261" class="Symbol">→</a> <a id="4263" class="Symbol">(</a><a id="4264" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4264" class="Bound">currentAddr</a> <a id="4276" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4276" class="Bound">destinationAddr</a> <a id="4292" class="Symbol">:</a> <a id="4294" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4301" class="Symbol">)</a> <a id="4303" class="Symbol">(</a><a id="4304" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4304" class="Bound">amount&#39;</a> <a id="4312" class="Symbol">:</a> <a id="4314" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="4320" class="Symbol">)</a>
                     <a id="4343" class="Symbol">→</a> <a id="4345" class="Symbol">(</a><a id="4346" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4346" class="Bound">correctAmount</a> <a id="4360" class="Symbol">:</a> <a id="4362" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4304" class="Bound">amount&#39;</a> <a id="4370" href="libraries.natCompare.html#508" class="Function Operator">≦r</a>  <a id="4374" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4223" class="Bound">ledger</a> <a id="4381" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4264" class="Bound">currentAddr</a> <a id="4393" class="Symbol">.</a><a id="4394" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a><a id="4400" class="Symbol">)</a>
                     <a id="4423" class="Symbol">→</a> <a id="4425" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a>
<a id="4432" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4201" class="Function">updateLedgerAmount</a> <a id="4451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4451" class="Bound">ledger</a> <a id="4458" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4458" class="Bound">currentAddr</a> <a id="4470" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4470" class="Bound">destinationAddr</a> <a id="4486" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4486" class="Bound">amount&#39;</a> <a id="4494" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4494" class="Bound">correctAmount</a> <a id="4508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4508" class="Bound">addr</a> <a id="4513" class="Symbol">.</a><a id="4514" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a>
     <a id="4526" class="Symbol">=</a> <a id="4528" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4531" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4508" class="Bound">addr</a> <a id="4536" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4539" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4458" class="Bound">currentAddr</a>
     <a id="4556" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4561" href="libraries.natCompare.html#1529" class="Function">subtract</a> <a id="4570" class="Symbol">(</a><a id="4571" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4451" class="Bound">ledger</a> <a id="4578" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4458" class="Bound">currentAddr</a> <a id="4590" class="Symbol">.</a><a id="4591" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a><a id="4597" class="Symbol">)</a> <a id="4599" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4486" class="Bound">amount&#39;</a> <a id="4607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4494" class="Bound">correctAmount</a>
     <a id="4626" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4631" class="Symbol">(</a><a id="4632" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4635" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4508" class="Bound">addr</a> <a id="4640" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4643" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4470" class="Bound">destinationAddr</a>
     <a id="4664" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4669" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4451" class="Bound">ledger</a> <a id="4676" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4470" class="Bound">destinationAddr</a> <a id="4692" class="Symbol">.</a><a id="4693" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a> <a id="4700" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4702" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4486" class="Bound">amount&#39;</a>
     <a id="4715" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4720" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4451" class="Bound">ledger</a> <a id="4727" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4508" class="Bound">addr</a> <a id="4732" class="Symbol">.</a><a id="4733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a><a id="4739" class="Symbol">)</a>
<a id="4741" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4201" class="Function">updateLedgerAmount</a> <a id="4760" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4760" class="Bound">ledger</a> <a id="4767" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4767" class="Bound">currentAddr</a> <a id="4779" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4779" class="Bound">newAddr</a> <a id="4787" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4787" class="Bound">amount&#39;</a> <a id="4795" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4795" class="Bound">correctAmount</a> <a id="4809" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4809" class="Bound">addr</a> <a id="4814" class="Symbol">.</a><a id="4815" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a>
     <a id="4824" class="Symbol">=</a> <a id="4826" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4760" class="Bound">ledger</a> <a id="4833" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4809" class="Bound">addr</a> <a id="4838" class="Symbol">.</a><a id="4839" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a>


<a id="4845" class="Comment">-- execute transfer auxiliary</a>
<a id="executeTransferAux"></a><a id="4875" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4875" class="Function">executeTransferAux</a> <a id="4894" class="Symbol">:</a> <a id="4896" class="Symbol">(</a><a id="4897" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4897" class="Bound">oldLedger</a> <a id="4907" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4907" class="Bound">currentLedger</a> <a id="4921" class="Symbol">:</a> <a id="4923" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a><a id="4929" class="Symbol">)</a>
                  <a id="4949" class="Symbol">→</a> <a id="4951" class="Symbol">(</a><a id="4952" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4952" class="Bound">executionStack</a> <a id="4967" class="Symbol">:</a> <a id="4969" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3062" class="Function">ExecutionStack</a><a id="4983" class="Symbol">)</a>
                  <a id="5003" class="Symbol">→</a> <a id="5005" class="Symbol">(</a><a id="5006" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5006" class="Bound">callAddr</a> <a id="5015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5015" class="Bound">currentAddr</a> <a id="5027" class="Symbol">:</a> <a id="5029" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5036" class="Symbol">)</a>
                  <a id="5056" class="Symbol">→</a> <a id="5058" class="Symbol">(</a><a id="5059" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5059" class="Bound">amount&#39;</a> <a id="5067" class="Symbol">:</a> <a id="5069" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="5075" class="Symbol">)</a>
                  <a id="5095" class="Symbol">→</a> <a id="5097" class="Symbol">(</a><a id="5098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5098" class="Bound">destinationAddr</a> <a id="5114" class="Symbol">:</a> <a id="5116" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5123" class="Symbol">)</a>
                  <a id="5143" class="Symbol">→</a> <a id="5145" class="Symbol">(</a><a id="5146" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5146" class="Bound">cont</a> <a id="5151" class="Symbol">:</a> <a id="5153" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="5171" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="5174" class="Symbol">)</a>
                  <a id="5194" class="Symbol">→</a> <a id="5196" class="Symbol">(</a><a id="5197" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5197" class="Bound">cp</a>  <a id="5201" class="Symbol">:</a> <a id="5203" href="libraries.natCompare.html#679" class="Datatype">OrderingLeq</a> <a id="5215" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5059" class="Bound">amount&#39;</a> <a id="5223" class="Symbol">(</a><a id="5224" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4907" class="Bound">currentLedger</a> <a id="5238" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5015" class="Bound">currentAddr</a> <a id="5250" class="Symbol">.</a><a id="5251" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a>  <a id="5259" class="Symbol">))</a>
                  <a id="5280" class="Symbol">→</a> <a id="5282" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a>
<a id="5295" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4875" class="Function">executeTransferAux</a> <a id="5314" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5314" class="Bound">oldLedger</a> <a id="5324" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5324" class="Bound">currentLedger</a> <a id="5338" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5338" class="Bound">executionStack</a> <a id="5353" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5353" class="Bound">callAddr</a> <a id="5362" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5362" class="Bound">currentAddr</a> <a id="5374" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5374" class="Bound">amount&#39;</a> <a id="5382" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5382" class="Bound">destinationAddr</a> <a id="5398" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5398" class="Bound">cont</a> <a id="5403" class="Symbol">(</a><a id="5404" href="libraries.natCompare.html#717" class="InductiveConstructor">leq</a> <a id="5408" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5408" class="Bound">x</a><a id="5409" class="Symbol">)</a> <a id="5411" class="Symbol">=</a>
          <a id="5423" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="5431" class="Symbol">(</a><a id="5432" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4201" class="Function">updateLedgerAmount</a> <a id="5451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5324" class="Bound">currentLedger</a> <a id="5465" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5362" class="Bound">currentAddr</a> <a id="5477" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5382" class="Bound">destinationAddr</a> <a id="5493" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5374" class="Bound">amount&#39;</a> <a id="5501" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5408" class="Bound">x</a><a id="5502" class="Symbol">)</a>
             <a id="5517" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5338" class="Bound">executionStack</a> <a id="5532" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5353" class="Bound">callAddr</a> <a id="5541" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5362" class="Bound">currentAddr</a> <a id="5553" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5398" class="Bound">cont</a>

<a id="5559" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4875" class="Function">executeTransferAux</a> <a id="5578" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5578" class="Bound">oldLedger</a> <a id="5588" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5588" class="Bound">currentLedger</a> <a id="5602" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5602" class="Bound">executionStack</a> <a id="5617" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5617" class="Bound">callAddr</a> <a id="5626" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5626" class="Bound">currentAddr</a> <a id="5638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5638" class="Bound">amount</a> <a id="5645" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5645" class="Bound">destinationAddr</a> <a id="5661" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5661" class="Bound">cont</a> <a id="5666" class="Symbol">(</a><a id="5667" href="libraries.natCompare.html#755" class="InductiveConstructor">greater</a> <a id="5675" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5675" class="Bound">x</a><a id="5676" class="Symbol">)</a> <a id="5678" class="Symbol">=</a>
         <a id="5689" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="5697" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5578" class="Bound">oldLedger</a> <a id="5707" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5602" class="Bound">executionStack</a> <a id="5722" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5617" class="Bound">callAddr</a> <a id="5731" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5626" class="Bound">currentAddr</a>
             <a id="5756" class="Symbol">(</a><a id="5757" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a> <a id="5763" class="Symbol">(</a><a id="5764" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="5771" class="String">&quot;not enough money&quot;</a><a id="5789" class="Symbol">))</a>

<a id="5793" class="Comment">-- -- execute transfer</a>
<a id="executeTransfer"></a><a id="5816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5816" class="Function">executeTransfer</a> <a id="5832" class="Symbol">:</a> <a id="5834" class="Symbol">(</a><a id="5835" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5835" class="Bound">oldLedger</a> <a id="5845" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5845" class="Bound">currentLedger</a> <a id="5859" class="Symbol">:</a> <a id="5861" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a><a id="5867" class="Symbol">)</a>
                  <a id="5887" class="Symbol">→</a> <a id="5889" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3062" class="Function">ExecutionStack</a>
                  <a id="5922" class="Symbol">→</a> <a id="5924" class="Symbol">(</a><a id="5925" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5925" class="Bound">callAddr</a> <a id="5934" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5934" class="Bound">currentAddr</a> <a id="5946" class="Symbol">:</a> <a id="5948" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5955" class="Symbol">)</a>
                  <a id="5975" class="Symbol">→</a> <a id="5977" class="Symbol">(</a><a id="5978" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5978" class="Bound">amount&#39;</a> <a id="5986" class="Symbol">:</a> <a id="5988" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="5994" class="Symbol">)</a>
                  <a id="6014" class="Symbol">→</a> <a id="6016" class="Symbol">(</a><a id="6017" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6017" class="Bound">destinationAddr</a> <a id="6033" class="Symbol">:</a> <a id="6035" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="6042" class="Symbol">)</a>
                  <a id="6062" class="Symbol">→</a> <a id="6064" class="Symbol">(</a><a id="6065" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6065" class="Bound">cont</a> <a id="6070" class="Symbol">:</a> <a id="6072" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1306" class="Datatype">SmartContractExec</a> <a id="6090" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="6093" class="Symbol">)</a>
                  <a id="6113" class="Symbol">→</a> <a id="6115" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a>
<a id="6128" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5816" class="Function">executeTransfer</a> <a id="6144" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6144" class="Bound">oldLedger</a> <a id="6154" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6154" class="Bound">currentLedger</a> <a id="6168" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6168" class="Bound">exexecutionStack</a> <a id="6185" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6185" class="Bound">callAddr</a> <a id="6194" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6194" class="Bound">currentAddr</a> <a id="6206" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6206" class="Bound">amount&#39;</a> <a id="6214" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6214" class="Bound">destinationAddr</a> <a id="6230" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6230" class="Bound">cont</a>
                <a id="6251" class="Symbol">=</a> <a id="6253" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4875" class="Function">executeTransferAux</a> <a id="6272" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6144" class="Bound">oldLedger</a> <a id="6282" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6154" class="Bound">currentLedger</a> <a id="6296" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6168" class="Bound">exexecutionStack</a> <a id="6313" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6185" class="Bound">callAddr</a> <a id="6322" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6194" class="Bound">currentAddr</a> <a id="6334" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6206" class="Bound">amount&#39;</a>
                   <a id="6361" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6214" class="Bound">destinationAddr</a> <a id="6377" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6230" class="Bound">cont</a>  <a id="6383" class="Symbol">(</a><a id="6384" href="libraries.natCompare.html#936" class="Function">compareLeq</a> <a id="6395" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6206" class="Bound">amount&#39;</a> <a id="6403" class="Symbol">(</a><a id="6404" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6154" class="Bound">currentLedger</a> <a id="6418" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6194" class="Bound">currentAddr</a> <a id="6430" class="Symbol">.</a><a id="6431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a>  <a id="6439" class="Symbol">))</a>

<a id="6443" class="Comment">-- definition of stepEF</a>
<a id="stepEF"></a><a id="6467" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="Function">stepEF</a> <a id="6474" class="Symbol">:</a> <a id="6476" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="6483" class="Symbol">→</a> <a id="6485" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a> <a id="6498" class="Symbol">→</a> <a id="6500" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a>
<a id="6513" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="Function">stepEF</a> <a id="6520" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6520" class="Bound">oldLedger</a> <a id="6530" class="Symbol">(</a><a id="6531" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="6539" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6539" class="Bound">currentLedger</a> <a id="6553" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6556" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6556" class="Bound">callAddr</a> <a id="6565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6565" class="Bound">currentAddr</a> <a id="6577" class="Symbol">(</a><a id="6578" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a> <a id="6585" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6585" class="Bound">result</a><a id="6591" class="Symbol">))</a>
       <a id="6601" class="Symbol">=</a> <a id="6603" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="6611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6539" class="Bound">currentLedger</a>  <a id="6626" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6629" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6556" class="Bound">callAddr</a> <a id="6638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6565" class="Bound">currentAddr</a> <a id="6650" class="Symbol">(</a><a id="6651" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a> <a id="6658" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6585" class="Bound">result</a><a id="6664" class="Symbol">)</a>
<a id="6666" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="Function">stepEF</a> <a id="6673" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6673" class="Bound">oldLedger</a> <a id="6683" class="Symbol">(</a><a id="6684" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="6692" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6692" class="Bound">currentLedger</a> <a id="6706" class="Symbol">(</a><a id="6707" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6707" class="Bound">execSEl</a> <a id="6715" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6717" class="Bound">executionStack</a><a id="6731" class="Symbol">)</a> <a id="6733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6733" class="Bound">callAddr</a> <a id="6742" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6742" class="Bound">currentAddr</a> <a id="6754" class="Symbol">(</a><a id="6755" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a> <a id="6762" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6762" class="Bound">result</a><a id="6768" class="Symbol">))</a>
       <a id="6778" class="Symbol">=</a> <a id="6780" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="6788" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6692" class="Bound">currentLedger</a> <a id="6802" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6717" class="Bound">executionStack</a> <a id="6817" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6733" class="Bound">callAddr</a>  <a id="6827" class="Symbol">(</a><a id="6828" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6707" class="Bound">execSEl</a> <a id="6836" class="Symbol">.</a><a id="6837" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2897" class="Field">calledAddress</a><a id="6850" class="Symbol">)</a> <a id="6852" class="Symbol">(</a><a id="6853" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6707" class="Bound">execSEl</a> <a id="6861" class="Symbol">.</a><a id="6862" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2929" class="Field">continuation</a> <a id="6875" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6762" class="Bound">result</a><a id="6881" class="Symbol">)</a>
<a id="6883" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="6889" class="CatchallClause"> </a><a id="6890" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6890" class="CatchallClause Bound">oldLedger</a><a id="6899" class="CatchallClause"> </a><a id="6900" class="CatchallClause Symbol">(</a><a id="6901" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="6908" class="CatchallClause"> </a><a id="6909" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6909" class="CatchallClause Bound">currentLedger</a><a id="6922" class="CatchallClause"> </a><a id="6923" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6923" class="CatchallClause Bound">executionStack</a><a id="6937" class="CatchallClause"> </a><a id="6938" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6938" class="CatchallClause Bound">callAddr</a><a id="6946" class="CatchallClause"> </a><a id="6947" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6947" class="CatchallClause Bound">currentAddr</a><a id="6958" class="CatchallClause"> </a><a id="6959" class="CatchallClause Symbol">(</a><a id="6960" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="CatchallClause InductiveConstructor">exec</a><a id="6964" class="CatchallClause"> </a><a id="6965" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#762" class="CatchallClause InductiveConstructor">currentAddrLookupc</a><a id="6983" class="CatchallClause"> </a><a id="6984" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6984" class="CatchallClause Bound">cont</a><a id="6988" class="CatchallClause Symbol">))</a>
       <a id="6998" class="Symbol">=</a> <a id="7000" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="7008" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6909" class="Bound">currentLedger</a> <a id="7022" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6923" class="Bound">executionStack</a> <a id="7037" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6938" class="Bound">callAddr</a> <a id="7046" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6947" class="Bound">currentAddr</a> <a id="7058" class="Symbol">(</a><a id="7059" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6984" class="Bound">cont</a> <a id="7064" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6947" class="Bound">currentAddr</a><a id="7075" class="Symbol">)</a>
<a id="7077" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="7083" class="CatchallClause"> </a><a id="7084" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7084" class="CatchallClause Bound">oldLedger</a><a id="7093" class="CatchallClause"> </a><a id="7094" class="CatchallClause Symbol">(</a><a id="7095" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="7102" class="CatchallClause"> </a><a id="7103" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7103" class="CatchallClause Bound">currentLedger</a><a id="7116" class="CatchallClause"> </a><a id="7117" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7117" class="CatchallClause Bound">executionStack</a><a id="7131" class="CatchallClause"> </a><a id="7132" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7132" class="CatchallClause Bound">callAddr</a><a id="7140" class="CatchallClause"> </a><a id="7141" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7141" class="CatchallClause Bound">currentAddr</a><a id="7152" class="CatchallClause"> </a><a id="7153" class="CatchallClause Symbol">(</a><a id="7154" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="CatchallClause InductiveConstructor">exec</a><a id="7158" class="CatchallClause"> </a><a id="7159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#798" class="CatchallClause InductiveConstructor">callAddrLookupc</a><a id="7174" class="CatchallClause"> </a><a id="7175" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7175" class="CatchallClause Bound">cont</a><a id="7179" class="CatchallClause Symbol">))</a>
       <a id="7189" class="Symbol">=</a> <a id="7191" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="7199" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7103" class="Bound">currentLedger</a> <a id="7213" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7117" class="Bound">executionStack</a> <a id="7228" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7132" class="Bound">callAddr</a> <a id="7237" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7141" class="Bound">currentAddr</a> <a id="7249" class="Symbol">(</a><a id="7250" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7175" class="Bound">cont</a> <a id="7255" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7132" class="Bound">callAddr</a><a id="7263" class="Symbol">)</a>
<a id="7265" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="7271" class="CatchallClause"> </a><a id="7272" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7272" class="CatchallClause Bound">oldLedger</a><a id="7281" class="CatchallClause"> </a><a id="7282" class="CatchallClause Symbol">(</a><a id="7283" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="7290" class="CatchallClause"> </a><a id="7291" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7291" class="CatchallClause Bound">currentLedger</a><a id="7304" class="CatchallClause"> </a><a id="7305" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7305" class="CatchallClause Bound">executionStack</a><a id="7319" class="CatchallClause"> </a><a id="7320" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7320" class="CatchallClause Bound">callAddr</a><a id="7328" class="CatchallClause"> </a><a id="7329" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7329" class="CatchallClause Bound">currentAddr</a>
                            <a id="7369" class="CatchallClause Symbol">(</a><a id="7370" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="CatchallClause InductiveConstructor">exec</a><a id="7374" class="CatchallClause"> </a><a id="7375" class="CatchallClause Symbol">(</a><a id="7376" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="CatchallClause InductiveConstructor">updatec</a><a id="7383" class="CatchallClause"> </a><a id="7384" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7384" class="CatchallClause Bound">changedFname</a><a id="7396" class="CatchallClause"> </a><a id="7397" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7397" class="CatchallClause Bound">changedFdef</a><a id="7408" class="CatchallClause Symbol">)</a><a id="7409" class="CatchallClause"> </a><a id="7410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7410" class="CatchallClause Bound">cont</a><a id="7414" class="CatchallClause Symbol">))</a>
       <a id="7424" class="Symbol">=</a> <a id="7426" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="7434" class="Symbol">(</a><a id="7435" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3802" class="Function">updateLedger</a> <a id="7448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7291" class="Bound">currentLedger</a> <a id="7462" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7329" class="Bound">currentAddr</a> <a id="7474" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7384" class="Bound">changedFname</a> <a id="7487" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7397" class="Bound">changedFdef</a><a id="7498" class="Symbol">)</a>
                   <a id="7519" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7305" class="Bound">executionStack</a> <a id="7534" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7320" class="Bound">callAddr</a> <a id="7543" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7329" class="Bound">currentAddr</a> <a id="7555" class="Symbol">(</a><a id="7556" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7410" class="Bound">cont</a> <a id="7561" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="7563" class="Symbol">)</a>
<a id="7565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="7571" class="CatchallClause"> </a><a id="7572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7572" class="CatchallClause Bound">oldLedger</a><a id="7581" class="CatchallClause"> </a><a id="7582" class="CatchallClause Symbol">(</a><a id="7583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="7590" class="CatchallClause"> </a><a id="7591" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7591" class="CatchallClause Bound">currentLedger</a><a id="7604" class="CatchallClause"> </a><a id="7605" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7605" class="CatchallClause Bound">executionStack</a><a id="7619" class="CatchallClause"> </a><a id="7620" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7620" class="CatchallClause Bound">oldCalladdr</a><a id="7631" class="CatchallClause"> </a><a id="7632" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7632" class="CatchallClause Bound">oldCurrentAddr</a><a id="7646" class="CatchallClause"> </a><a id="7647" class="CatchallClause Symbol">(</a><a id="7648" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="CatchallClause InductiveConstructor">exec</a><a id="7652" class="CatchallClause"> </a><a id="7653" class="CatchallClause Symbol">(</a><a id="7654" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="CatchallClause InductiveConstructor">callc</a><a id="7659" class="CatchallClause"> </a><a id="7660" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7660" class="CatchallClause Bound">newaddr</a><a id="7667" class="CatchallClause"> </a><a id="7668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7668" class="CatchallClause Bound">fname</a><a id="7673" class="CatchallClause"> </a><a id="7674" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7674" class="CatchallClause Bound">msg</a><a id="7677" class="CatchallClause Symbol">)</a><a id="7678" class="CatchallClause"> </a><a id="7679" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7679" class="CatchallClause Bound">cont</a><a id="7683" class="CatchallClause Symbol">))</a>
       <a id="7693" class="Symbol">=</a> <a id="7695" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="7703" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7591" class="Bound">currentLedger</a> <a id="7717" class="Symbol">(</a><a id="7718" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2841" class="InductiveConstructor">execStackEl</a> <a id="7730" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7620" class="Bound">oldCalladdr</a> <a id="7742" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7632" class="Bound">oldCurrentAddr</a> <a id="7757" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7679" class="Bound">cont</a>  <a id="7763" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7765" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7605" class="Bound">executionStack</a><a id="7779" class="Symbol">)</a>  <a id="7782" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7632" class="Bound">oldCurrentAddr</a> <a id="7797" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7660" class="Bound">newaddr</a>
                   <a id="7824" class="Symbol">(</a><a id="7825" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7591" class="Bound">currentLedger</a> <a id="7839" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7660" class="Bound">newaddr</a> <a id="7847" class="Symbol">.</a><a id="7848" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a> <a id="7852" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7668" class="Bound">fname</a> <a id="7858" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7674" class="Bound">msg</a><a id="7861" class="Symbol">)</a>

<a id="7864" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="7870" class="CatchallClause"> </a><a id="7871" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7871" class="CatchallClause Bound">oldLedger</a><a id="7880" class="CatchallClause"> </a><a id="7881" class="CatchallClause Symbol">(</a><a id="7882" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="7889" class="CatchallClause"> </a><a id="7890" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7890" class="CatchallClause Bound">currentLedger</a><a id="7903" class="CatchallClause"> </a><a id="7904" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7904" class="CatchallClause Bound">executionStack</a><a id="7918" class="CatchallClause"> </a><a id="7919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7919" class="CatchallClause Bound">callAddr</a><a id="7927" class="CatchallClause"> </a><a id="7928" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7928" class="CatchallClause Bound">currentAddr</a><a id="7939" class="CatchallClause"> </a><a id="7940" class="CatchallClause Symbol">(</a><a id="7941" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="CatchallClause InductiveConstructor">exec</a><a id="7945" class="CatchallClause"> </a><a id="7946" class="CatchallClause Symbol">(</a><a id="7947" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="CatchallClause InductiveConstructor">transferc</a><a id="7956" class="CatchallClause"> </a><a id="7957" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7957" class="CatchallClause Bound">amount</a><a id="7963" class="CatchallClause"> </a><a id="7964" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7964" class="CatchallClause Bound">destinationAddr</a><a id="7979" class="CatchallClause"> </a><a id="7980" class="CatchallClause Symbol">)</a><a id="7981" class="CatchallClause"> </a><a id="7982" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7982" class="CatchallClause Bound">cont</a><a id="7986" class="CatchallClause Symbol">))</a>
       <a id="7996" class="Symbol">=</a> <a id="7998" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5816" class="Function">executeTransfer</a> <a id="8014" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7871" class="Bound">oldLedger</a> <a id="8024" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7890" class="Bound">currentLedger</a> <a id="8038" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7904" class="Bound">executionStack</a> <a id="8053" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7919" class="Bound">callAddr</a> <a id="8062" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7928" class="Bound">currentAddr</a> <a id="8074" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7957" class="Bound">amount</a> <a id="8081" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7964" class="Bound">destinationAddr</a> <a id="8097" class="Symbol">(</a><a id="8098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7982" class="Bound">cont</a> <a id="8103" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="8105" class="Symbol">)</a>
<a id="8107" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="8113" class="CatchallClause"> </a><a id="8114" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8114" class="CatchallClause Bound">oldLedger</a><a id="8123" class="CatchallClause"> </a><a id="8124" class="CatchallClause Symbol">(</a><a id="8125" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="8132" class="CatchallClause"> </a><a id="8133" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8133" class="CatchallClause Bound">currentLedger</a><a id="8146" class="CatchallClause"> </a><a id="8147" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8147" class="CatchallClause Bound">executionStack</a><a id="8161" class="CatchallClause"> </a><a id="8162" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8162" class="CatchallClause Bound">callAddr</a><a id="8170" class="CatchallClause"> </a><a id="8171" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8171" class="CatchallClause Bound">currentAddr</a><a id="8182" class="CatchallClause"> </a><a id="8183" class="CatchallClause Symbol">(</a><a id="8184" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1435" class="CatchallClause InductiveConstructor">exec</a><a id="8188" class="CatchallClause"> </a><a id="8189" class="CatchallClause Symbol">(</a><a id="8190" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#834" class="CatchallClause InductiveConstructor">getAmountc</a><a id="8200" class="CatchallClause">  </a><a id="8202" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8202" class="CatchallClause Bound">addrLookedUp</a><a id="8214" class="CatchallClause Symbol">)</a><a id="8215" class="CatchallClause"> </a><a id="8216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8216" class="CatchallClause Bound">cont</a><a id="8220" class="CatchallClause Symbol">))</a>
       <a id="8230" class="Symbol">=</a> <a id="8232" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="8240" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8133" class="Bound">currentLedger</a> <a id="8254" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8147" class="Bound">executionStack</a> <a id="8269" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8162" class="Bound">callAddr</a> <a id="8278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8171" class="Bound">currentAddr</a> <a id="8290" class="Symbol">(</a><a id="8291" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8216" class="Bound">cont</a> <a id="8296" class="Symbol">(</a><a id="8297" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8133" class="Bound">currentLedger</a> <a id="8311" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8202" class="Bound">addrLookedUp</a> <a id="8324" class="Symbol">.</a><a id="8325" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1987" class="Field">amount</a><a id="8331" class="Symbol">))</a>
<a id="8334" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="CatchallClause Function">stepEF</a><a id="8340" class="CatchallClause"> </a><a id="8341" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8341" class="CatchallClause Bound">oldLedger</a><a id="8350" class="CatchallClause"> </a><a id="8351" class="CatchallClause Symbol">(</a><a id="8352" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="8359" class="CatchallClause"> </a><a id="8360" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8360" class="CatchallClause Bound">currentLedger</a><a id="8373" class="CatchallClause"> </a><a id="8374" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8374" class="CatchallClause Bound">executionStack</a><a id="8388" class="CatchallClause"> </a><a id="8389" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8389" class="CatchallClause Bound">callAddr</a><a id="8397" class="CatchallClause"> </a><a id="8398" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8398" class="CatchallClause Bound">currentAddr</a><a id="8409" class="CatchallClause"> </a><a id="8410" class="CatchallClause Symbol">(</a><a id="8411" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="CatchallClause InductiveConstructor">error</a><a id="8416" class="CatchallClause"> </a><a id="8417" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8417" class="CatchallClause Bound">errorMsg</a><a id="8425" class="CatchallClause Symbol">))</a>
       <a id="8435" class="Symbol">=</a> <a id="8437" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="8445" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8341" class="Bound">oldLedger</a> <a id="8455" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8374" class="Bound">executionStack</a> <a id="8470" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8389" class="Bound">callAddr</a> <a id="8479" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8398" class="Bound">currentAddr</a> <a id="8491" class="Symbol">(</a><a id="8492" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="InductiveConstructor">error</a> <a id="8498" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8417" class="Bound">errorMsg</a><a id="8506" class="Symbol">)</a>


<a id="8510" class="Comment">-- definition of stepEFntimes</a>
<a id="stepEFntimes"></a><a id="8540" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8540" class="Function">stepEFntimes</a> <a id="8553" class="Symbol">:</a> <a id="8555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="8562" class="Symbol">→</a> <a id="8564" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a> <a id="8577" class="Symbol">→</a> <a id="8579" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8581" class="Symbol">→</a> <a id="8583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a>
<a id="8596" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8540" class="Function">stepEFntimes</a> <a id="8609" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8609" class="Bound">oldLedger</a> <a id="8619" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8619" class="Bound">ledgerstateexecfun</a> <a id="8638" class="Number">0</a>
             <a id="8653" class="Symbol">=</a> <a id="8655" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8619" class="Bound">ledgerstateexecfun</a>
<a id="8674" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8540" class="Function">stepEFntimes</a> <a id="8687" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8687" class="Bound">oldLedger</a> <a id="8697" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8697" class="Bound">ledgerstateexecfun</a> <a id="8716" class="Symbol">(</a><a id="8717" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8721" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8721" class="Bound">n</a><a id="8722" class="Symbol">)</a>
      <a id="8730" class="Symbol">=</a> <a id="8732" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="Function">stepEF</a> <a id="8739" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8687" class="Bound">oldLedger</a> <a id="8749" class="Symbol">(</a><a id="8750" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8540" class="Function">stepEFntimes</a> <a id="8763" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8687" class="Bound">oldLedger</a> <a id="8773" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8697" class="Bound">ledgerstateexecfun</a> <a id="8792" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8721" class="Bound">n</a><a id="8793" class="Symbol">)</a>


<a id="8797" class="Comment">--define stepledgern times</a>
<a id="stepLedgerFunntimes"></a><a id="8824" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8824" class="Function">stepLedgerFunntimes</a> <a id="8844" class="Symbol">:</a> <a id="8846" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="8853" class="Symbol">→</a> <a id="8855" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
                    <a id="8883" class="Symbol">→</a> <a id="8885" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="8893" class="Symbol">→</a> <a id="8895" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
                    <a id="8928" class="Symbol">→</a> <a id="8930" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="8934" class="Symbol">→</a> <a id="8936" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8938" class="Symbol">→</a> <a id="8940" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a>
<a id="8953" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8824" class="Function">stepLedgerFunntimes</a> <a id="8973" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8973" class="Bound">ledger</a> <a id="8980" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8980" class="Bound">callAddr</a> <a id="8989" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8989" class="Bound">currentAddr</a> <a id="9001" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9001" class="Bound">funname</a> <a id="9009" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9009" class="Bound">msg</a> <a id="9013" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9013" class="Bound">n</a>
        <a id="9023" class="Symbol">=</a> <a id="9025" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8540" class="Function">stepEFntimes</a> <a id="9038" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8973" class="Bound">ledger</a> <a id="9045" class="Symbol">(</a><a id="9046" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="9054" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8973" class="Bound">ledger</a> <a id="9061" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9064" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8980" class="Bound">callAddr</a> <a id="9073" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8989" class="Bound">currentAddr</a>
        <a id="9093" class="Symbol">(</a><a id="9094" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8973" class="Bound">ledger</a> <a id="9101" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8989" class="Bound">currentAddr</a> <a id="9113" class="Symbol">.</a><a id="9114" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a> <a id="9118" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9001" class="Bound">funname</a> <a id="9126" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9009" class="Bound">msg</a><a id="9129" class="Symbol">))</a> <a id="9132" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9013" class="Bound">n</a>



<a id="stepLedgerFunntimesList"></a><a id="9137" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9137" class="Function">stepLedgerFunntimesList</a> <a id="9161" class="Symbol">:</a> <a id="9163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="9170" class="Symbol">→</a> <a id="9172" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
                          <a id="9206" class="Symbol">→</a>  <a id="9209" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="9217" class="Symbol">→</a> <a id="9219" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
                          <a id="9258" class="Symbol">→</a> <a id="9260" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="9264" class="Symbol">→</a> <a id="9266" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="9268" class="Symbol">→</a> <a id="9270" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9275" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a>
<a id="9288" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9137" class="Function">stepLedgerFunntimesList</a> <a id="9312" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9312" class="Bound">ledger</a> <a id="9319" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9319" class="Bound">callAddr</a> <a id="9328" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9328" class="Bound">currentAddr</a> <a id="9340" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9340" class="Bound">funname</a> <a id="9348" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9348" class="Bound">msg</a> <a id="9352" class="Number">0</a> <a id="9354" class="Symbol">=</a> <a id="9356" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="9359" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9137" class="Function">stepLedgerFunntimesList</a> <a id="9383" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9383" class="Bound">ledger</a> <a id="9390" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9390" class="Bound">callAddr</a> <a id="9399" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9399" class="Bound">currentAddr</a> <a id="9411" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9411" class="Bound">funname</a> <a id="9419" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9419" class="Bound">msg</a> <a id="9423" class="Symbol">(</a><a id="9424" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9428" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9428" class="Bound">n</a><a id="9429" class="Symbol">)</a>
        <a id="9439" class="Symbol">=</a> <a id="9441" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8824" class="Function">stepLedgerFunntimes</a> <a id="9461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9383" class="Bound">ledger</a> <a id="9468" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9390" class="Bound">callAddr</a> <a id="9477" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9399" class="Bound">currentAddr</a> <a id="9489" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9411" class="Bound">funname</a> <a id="9497" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9419" class="Bound">msg</a> <a id="9501" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9428" class="Bound">n</a> <a id="9503" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
          <a id="9515" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9137" class="Function">stepLedgerFunntimesList</a> <a id="9539" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9383" class="Bound">ledger</a> <a id="9546" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9390" class="Bound">callAddr</a> <a id="9555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9399" class="Bound">currentAddr</a> <a id="9567" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9411" class="Bound">funname</a> <a id="9575" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9419" class="Bound">msg</a> <a id="9579" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9428" class="Bound">n</a>



<a id="9584" class="Keyword">record</a> <a id="MsgAndLedger"></a><a id="9591" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9591" class="Record">MsgAndLedger</a> <a id="9604" class="Symbol">:</a> <a id="9606" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="9610" class="Keyword">where</a>
  <a id="9618" class="Keyword">constructor</a> <a id="msgAndLedger"></a><a id="9630" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9630" class="InductiveConstructor">msgAndLedger</a>
  <a id="9645" class="Keyword">field</a>
    <a id="MsgAndLedger.theLedger"></a><a id="9655" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9655" class="Field">theLedger</a>  <a id="9666" class="Symbol">:</a> <a id="9668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a>
    <a id="MsgAndLedger.msgOrError"></a><a id="9679" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9679" class="Field">msgOrError</a> <a id="9690" class="Symbol">:</a> <a id="9692" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#907" class="Datatype">MsgOrError</a>

<a id="9704" class="Keyword">open</a> <a id="9709" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9591" class="Module">MsgAndLedger</a> <a id="9722" class="Keyword">public</a>


<a id="9731" class="Symbol">{-#</a> <a id="9735" class="Keyword">NON_TERMINATING</a> <a id="9751" class="Symbol">#-}</a>
<a id="evaluateNonTerminatingAuxWithLedger"></a><a id="9755" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9755" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="9791" class="Symbol">:</a> <a id="9793" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="9800" class="Symbol">→</a> <a id="9802" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3523" class="Record">StateExecFun</a> <a id="9815" class="Symbol">→</a> <a id="9817" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9591" class="Record">MsgAndLedger</a>
<a id="9830" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9755" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="9866" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9866" class="Bound">oldledger</a> <a id="9876" class="Symbol">(</a><a id="9877" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="9885" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9885" class="Bound">currentLedger</a> <a id="9899" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9902" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9902" class="Bound">callAddr</a> <a id="9911" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9911" class="Bound">currentAddr</a> <a id="9923" class="Symbol">(</a><a id="9924" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1350" class="InductiveConstructor">return</a> <a id="9931" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9931" class="Bound">m</a><a id="9932" class="Symbol">))</a> <a id="9935" class="Symbol">=</a> <a id="9937" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9630" class="InductiveConstructor">msgAndLedger</a> <a id="9950" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9885" class="Bound">currentLedger</a> <a id="9964" class="Symbol">(</a><a id="9965" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#931" class="InductiveConstructor">theMsg</a> <a id="9972" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9931" class="Bound">m</a><a id="9973" class="Symbol">)</a> 
<a id="9976" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9755" class="CatchallClause Function">evaluateNonTerminatingAuxWithLedger</a><a id="10011" class="CatchallClause"> </a><a id="10012" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10012" class="CatchallClause Bound">oldledger</a><a id="10021" class="CatchallClause"> </a><a id="10022" class="CatchallClause Symbol">(</a><a id="10023" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="CatchallClause InductiveConstructor">stateEF</a><a id="10030" class="CatchallClause"> </a><a id="10031" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10031" class="CatchallClause Bound">currentLedger</a><a id="10044" class="CatchallClause"> </a><a id="10045" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10045" class="CatchallClause Bound">s</a><a id="10046" class="CatchallClause"> </a><a id="10047" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10047" class="CatchallClause Bound">callAddr</a><a id="10055" class="CatchallClause"> </a><a id="10056" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10056" class="CatchallClause Bound">currentAddr</a><a id="10067" class="CatchallClause"> </a><a id="10068" class="CatchallClause Symbol">(</a><a id="10069" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1389" class="CatchallClause InductiveConstructor">error</a><a id="10074" class="CatchallClause"> </a><a id="10075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10075" class="CatchallClause Bound">e</a><a id="10076" class="CatchallClause Symbol">))</a> <a id="10079" class="Symbol">=</a> <a id="10081" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9630" class="InductiveConstructor">msgAndLedger</a> <a id="10094" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10012" class="Bound">oldledger</a> <a id="10104" class="Symbol">(</a><a id="10105" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#959" class="InductiveConstructor">err</a> <a id="10109" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10075" class="Bound">e</a><a id="10110" class="Symbol">)</a> 
<a id="10113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9755" class="CatchallClause Function">evaluateNonTerminatingAuxWithLedger</a><a id="10148" class="CatchallClause"> </a><a id="10149" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10149" class="CatchallClause Bound">oldledger</a><a id="10158" class="CatchallClause"> </a><a id="10159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10159" class="CatchallClause Bound">state</a> <a id="10165" class="Symbol">=</a> <a id="10167" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9755" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="10203" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10149" class="Bound">oldledger</a> <a id="10213" class="Symbol">(</a><a id="10214" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6467" class="Function">stepEF</a>  <a id="10222" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10149" class="Bound">oldledger</a> <a id="10232" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10159" class="Bound">state</a><a id="10237" class="Symbol">)</a>

<a id="evaluateNonTerminatingWithLedger"></a><a id="10240" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10240" class="Function">evaluateNonTerminatingWithLedger</a> <a id="10273" class="Symbol">:</a> <a id="10275" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2099" class="Function">Ledger</a> <a id="10282" class="Symbol">→</a> <a id="10284" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="10292" class="Symbol">→</a>  <a id="10295" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="10303" class="Symbol">→</a> <a id="10305" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="10318" class="Symbol">→</a> <a id="10320" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="10324" class="Symbol">→</a> <a id="10326" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9591" class="Record">MsgAndLedger</a>
<a id="10339" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10240" class="Function">evaluateNonTerminatingWithLedger</a> <a id="10372" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10372" class="Bound">ledger</a> <a id="10379" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10379" class="Bound">callAddr</a> <a id="10388" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10388" class="Bound">currentAddr</a>  <a id="10401" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10401" class="Bound">funname</a> <a id="10409" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10409" class="Bound">msg</a>
                                        <a id="10453" class="Symbol">=</a>  <a id="10456" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9755" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="10492" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10372" class="Bound">ledger</a> <a id="10499" class="Symbol">(</a><a id="10500" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3562" class="InductiveConstructor">stateEF</a> <a id="10508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10372" class="Bound">ledger</a> <a id="10515" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10518" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10379" class="Bound">callAddr</a> <a id="10527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10388" class="Bound">currentAddr</a> <a id="10539" class="Symbol">(</a><a id="10540" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10372" class="Bound">ledger</a> <a id="10547" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10388" class="Bound">currentAddr</a> <a id="10559" class="Symbol">.</a><a id="10560" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2009" class="Field">fun</a> <a id="10564" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10401" class="Bound">funname</a> <a id="10572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10409" class="Bound">msg</a><a id="10575" class="Symbol">))</a>


</pre></body></html>