<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.ledgerversion.Ledger-Simple-Model</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">--@PREFIX@simpleModelledger</a>
<a id="29" class="Keyword">module</a> <a id="36" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="140" class="Keyword">using</a> <a id="146" class="Symbol">(</a><a id="147" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">_-_</a><a id="150" class="Symbol">)</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.List.html" class="Module">Data.List</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="295" class="Keyword">hiding</a> <a id="302" class="Symbol">(</a><a id="303" href="Data.Maybe.Base.html#2227" class="Function Operator">_&gt;&gt;=_</a><a id="308" class="Symbol">)</a>
<a id="310" class="Keyword">open</a> <a id="315" class="Keyword">import</a> <a id="322" href="Data.String.html" class="Module">Data.String</a> <a id="334" class="Keyword">hiding</a> <a id="341" class="Symbol">(</a><a id="342" href="Data.String.Base.html#2430" class="Function">length</a><a id="348" class="Symbol">)</a>

<a id="351" class="Comment">--library for simple model</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>

<a id="459" class="Comment">-- main library</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>




<a id="512" class="Keyword">mutual</a>


<a id="521" class="Comment">-- smart contract-comands:</a>
  <a id="550" class="Keyword">data</a> <a id="CCommands"></a><a id="555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a> <a id="565" class="Symbol">:</a> <a id="567" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="571" class="Keyword">where</a>
    <a id="CCommands.transferc"></a><a id="581" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="InductiveConstructor">transferc</a>  <a id="592" class="Symbol">:</a>  <a id="595" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a> <a id="602" class="Symbol">→</a> <a id="604" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="612" class="Symbol">→</a> <a id="614" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.callc"></a><a id="628" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a>      <a id="639" class="Symbol">:</a>  <a id="642" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="650" class="Symbol">→</a> <a id="652" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="665" class="Symbol">→</a> <a id="667" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="671" class="Symbol">→</a> <a id="673" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.updatec"></a><a id="687" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a>    <a id="698" class="Symbol">:</a>  <a id="701" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="714" class="Symbol">→</a> <a id="716" class="Symbol">(</a><a id="717" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="721" class="Symbol">→</a> <a id="723" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="737" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="740" class="Symbol">)</a> <a id="742" class="Symbol">→</a> <a id="744" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.currentAddrLookupc"></a><a id="758" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#758" class="InductiveConstructor">currentAddrLookupc</a>  <a id="778" class="Symbol">:</a> <a id="780" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="794" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#794" class="InductiveConstructor">callAddrLookupc</a>     <a id="814" class="Symbol">:</a> <a id="816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="830" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#830" class="InductiveConstructor">getAmountc</a>          <a id="850" class="Symbol">:</a> <a id="852" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="860" class="Symbol">→</a> <a id="862" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a>


<a id="874" class="Comment">-- smart contract response</a>
  <a id="CResponse"></a><a id="903" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="913" class="Symbol">:</a> <a id="915" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a> <a id="925" class="Symbol">→</a> <a id="927" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="943" class="Symbol">(</a><a id="944" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="InductiveConstructor">transferc</a> <a id="954" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#954" class="Bound">amount</a> <a id="961" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#961" class="Bound">addr</a><a id="965" class="Symbol">)</a>  <a id="968" class="Symbol">=</a>  <a id="971" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="975" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="985" class="Symbol">(</a><a id="986" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a> <a id="992" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#992" class="Bound">addr</a> <a id="997" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#997" class="Bound">fname</a> <a id="1003" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1003" class="Bound">msg</a><a id="1006" class="Symbol">)</a>   <a id="1010" class="Symbol">=</a>  <a id="1013" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
  <a id="1019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="1029" class="Symbol">(</a><a id="1030" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a> <a id="1038" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1038" class="Bound">fname</a> <a id="1044" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1044" class="Bound">fdef</a><a id="1048" class="Symbol">)</a>     <a id="1054" class="Symbol">=</a>  <a id="1057" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="1061" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="1071" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#758" class="InductiveConstructor">currentAddrLookupc</a>       <a id="1096" class="Symbol">=</a> <a id="1098" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
  <a id="1108" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="1118" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#794" class="InductiveConstructor">callAddrLookupc</a>          <a id="1143" class="Symbol">=</a> <a id="1145" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
  <a id="1155" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="1165" class="Symbol">(</a><a id="1166" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#830" class="InductiveConstructor">getAmountc</a> <a id="1177" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1177" class="Bound">addr</a><a id="1181" class="Symbol">)</a>        <a id="1190" class="Symbol">=</a> <a id="1192" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a>



<a id="1202" class="Comment">--SmartContractExec is datatype of what happens when a function is applied to its arguments.</a>
  <a id="1297" class="Keyword">data</a> <a id="SmartContract"></a><a id="1302" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1316" class="Symbol">(</a><a id="1317" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1317" class="Bound">A</a> <a id="1319" class="Symbol">:</a> <a id="1321" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1324" class="Symbol">)</a> <a id="1326" class="Symbol">:</a> <a id="1328" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1332" class="Keyword">where</a>
    <a id="SmartContract.return"></a><a id="1342" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a>  <a id="1350" class="Symbol">:</a>  <a id="1353" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1317" class="Bound">A</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1371" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1317" class="Bound">A</a>
    <a id="SmartContract.error"></a><a id="1377" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a>   <a id="1385" class="Symbol">:</a>  <a id="1388" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#572" class="Datatype">ErrorMsg</a> <a id="1397" class="Symbol">→</a> <a id="1399" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1413" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1317" class="Bound">A</a>
    <a id="SmartContract.exec"></a><a id="1419" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a>    <a id="1427" class="Symbol">:</a>  <a id="1430" class="Symbol">(</a><a id="1431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1431" class="Bound">c</a> <a id="1433" class="Symbol">:</a> <a id="1435" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#555" class="Datatype">CCommands</a><a id="1444" class="Symbol">)</a> <a id="1446" class="Symbol">→</a> <a id="1448" class="Symbol">(</a><a id="1449" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#903" class="Function">CResponse</a> <a id="1459" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1431" class="Bound">c</a> <a id="1461" class="Symbol">→</a> <a id="1463" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1477" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1317" class="Bound">A</a><a id="1478" class="Symbol">)</a>
            <a id="1492" class="Symbol">→</a> <a id="1494" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1317" class="Bound">A</a>


<a id="_&gt;&gt;==_"></a><a id="1512" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1512" class="Function Operator">_&gt;&gt;==_</a> <a id="1519" class="Symbol">:</a> <a id="1521" class="Symbol">{</a><a id="1522" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1522" class="Bound">A</a> <a id="1524" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1524" class="Bound">B</a> <a id="1526" class="Symbol">:</a> <a id="1528" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1531" class="Symbol">}</a> <a id="1533" class="Symbol">→</a> <a id="1535" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1549" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1522" class="Bound">A</a> <a id="1551" class="Symbol">→</a> <a id="1553" class="Symbol">(</a><a id="1554" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1522" class="Bound">A</a> <a id="1556" class="Symbol">→</a> <a id="1558" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1524" class="Bound">B</a><a id="1573" class="Symbol">)</a> <a id="1575" class="Symbol">→</a> <a id="1577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1591" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1524" class="Bound">B</a>
<a id="1593" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="1600" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1600" class="Bound">x</a> <a id="1602" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1512" class="Function Operator">&gt;&gt;==</a> <a id="1607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1607" class="Bound">q</a> <a id="1609" class="Symbol">=</a> <a id="1611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1607" class="Bound">q</a> <a id="1613" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1600" class="Bound">x</a>
<a id="1615" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1621" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Bound">x</a> <a id="1623" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1512" class="Function Operator">&gt;&gt;==</a> <a id="1628" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1628" class="Bound">q</a> <a id="1630" class="Symbol">=</a> <a id="1632" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Bound">x</a>
<a id="1640" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1645" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1645" class="Bound">c</a> <a id="1647" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1647" class="Bound">x</a> <a id="1649" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1512" class="Function Operator">&gt;&gt;==</a> <a id="1654" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1654" class="Bound">q</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1663" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1645" class="Bound">c</a> <a id="1665" class="Symbol">(λ</a> <a id="1668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1668" class="Bound">r</a> <a id="1670" class="Symbol">→</a> <a id="1672" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1647" class="Bound">x</a> <a id="1674" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1668" class="Bound">r</a> <a id="1676" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1512" class="Function Operator">&gt;&gt;==</a> <a id="1681" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1654" class="Bound">q</a><a id="1682" class="Symbol">)</a>


<a id="_&gt;&gt;_"></a><a id="1686" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1686" class="Function Operator">_&gt;&gt;_</a> <a id="1691" class="Symbol">:</a> <a id="1693" class="Symbol">{</a><a id="1694" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1694" class="Bound">A</a> <a id="1696" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1696" class="Bound">B</a> <a id="1698" class="Symbol">:</a> <a id="1700" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1703" class="Symbol">}</a> <a id="1705" class="Symbol">→</a> <a id="1707" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1721" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1694" class="Bound">A</a> <a id="1723" class="Symbol">→</a> <a id="1725" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1739" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1696" class="Bound">B</a> <a id="1741" class="Symbol">→</a> <a id="1743" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="1757" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1696" class="Bound">B</a>
<a id="1759" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="1766" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1766" class="Bound">x</a> <a id="1768" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1686" class="Function Operator">&gt;&gt;</a> <a id="1771" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1771" class="Bound">q</a> <a id="1773" class="Symbol">=</a> <a id="1775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1771" class="Bound">q</a>
<a id="1777" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1783" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1783" class="Bound">x</a> <a id="1785" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1686" class="Function Operator">&gt;&gt;</a> <a id="1788" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1788" class="Bound">q</a> <a id="1790" class="Symbol">=</a> <a id="1792" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="1798" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1783" class="Bound">x</a>
<a id="1800" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1805" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1805" class="Bound">c</a> <a id="1807" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1807" class="Bound">x</a> <a id="1809" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1686" class="Function Operator">&gt;&gt;</a> <a id="1812" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1812" class="Bound">q</a> <a id="1814" class="Symbol">=</a> <a id="1816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="1821" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1805" class="Bound">c</a> <a id="1823" class="Symbol">(λ</a> <a id="1826" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1826" class="Bound">r</a> <a id="1828" class="Symbol">→</a> <a id="1830" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1807" class="Bound">x</a> <a id="1832" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1826" class="Bound">r</a> <a id="1834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1686" class="Function Operator">&gt;&gt;</a> <a id="1837" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1812" class="Bound">q</a><a id="1838" class="Symbol">)</a>



<a id="1843" class="Comment">-- Definition of simple contract</a>
<a id="1876" class="Keyword">record</a> <a id="Contract"></a><a id="1883" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1883" class="Record">Contract</a> <a id="1892" class="Symbol">:</a> <a id="1894" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1898" class="Keyword">where</a>
  <a id="1906" class="Keyword">constructor</a> <a id="contract"></a><a id="1918" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1918" class="InductiveConstructor">contract</a>
  <a id="1929" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="1939" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>  <a id="1947" class="Symbol">:</a>  <a id="1950" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="1961" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a>     <a id="1969" class="Symbol">:</a>  <a id="1972" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="1985" class="Symbol">→</a> <a id="1987" class="Symbol">(</a><a id="1988" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="1992" class="Symbol">→</a> <a id="1994" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2008" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2011" class="Symbol">)</a>
<a id="2013" class="Keyword">open</a> <a id="2018" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1883" class="Module">Contract</a> <a id="2027" class="Keyword">public</a>



<a id="2037" class="Comment">-- ledger</a>
<a id="Ledger"></a><a id="2047" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="2054" class="Symbol">:</a> <a id="2056" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2060" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="2067" class="Symbol">=</a> <a id="2069" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>  <a id="2078" class="Symbol">→</a> <a id="2080" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1883" class="Record">Contract</a>


<a id="2091" class="Comment">--- theses functions below we use them with do notation</a>
<a id="call"></a><a id="2147" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2147" class="Function">call</a> <a id="2152" class="Symbol">:</a> <a id="2154" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>  <a id="2163" class="Symbol">→</a> <a id="2165" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2178" class="Symbol">→</a> <a id="2180" class="Symbol">(</a><a id="2181" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2185" class="Symbol">→</a> <a id="2187" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2201" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2204" class="Symbol">)</a>
<a id="2206" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2147" class="Function">call</a> <a id="2211" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2211" class="Bound">addr</a> <a id="2216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2216" class="Bound">fname</a> <a id="2222" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2222" class="Bound">msg</a> <a id="2226" class="Symbol">=</a> <a id="2228" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="2233" class="Symbol">(</a><a id="2234" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="InductiveConstructor">callc</a> <a id="2240" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2211" class="Bound">addr</a> <a id="2245" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2216" class="Bound">fname</a> <a id="2251" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2222" class="Bound">msg</a><a id="2254" class="Symbol">)</a> <a id="2256" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a>

<a id="update"></a><a id="2264" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2264" class="Function">update</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2286" class="Symbol">→</a> <a id="2288" class="Symbol">(</a><a id="2289" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2293" class="Symbol">→</a> <a id="2295" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2309" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2312" class="Symbol">)</a> <a id="2314" class="Symbol">→</a> <a id="2316" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2330" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2332" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2264" class="Function">update</a> <a id="2339" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2339" class="Bound">fname</a> <a id="2345" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2345" class="Bound">fdef</a> <a id="2350" class="Symbol">=</a> <a id="2352" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="2357" class="Symbol">(</a><a id="2358" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="InductiveConstructor">updatec</a> <a id="2366" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2339" class="Bound">fname</a> <a id="2372" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2345" class="Bound">fdef</a><a id="2376" class="Symbol">)</a> <a id="2378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a>

<a id="currentAddrLookup"></a><a id="2386" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2386" class="Function">currentAddrLookup</a> <a id="2404" class="Symbol">:</a> <a id="2406" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2420" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
<a id="2428" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2386" class="Function">currentAddrLookup</a> <a id="2446" class="Symbol">=</a> <a id="2448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="2453" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#758" class="InductiveConstructor">currentAddrLookupc</a> <a id="2472" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a>

<a id="callAddrLookup"></a><a id="2480" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2480" class="Function">callAddrLookup</a> <a id="2495" class="Symbol">:</a> <a id="2497" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2511" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
<a id="2519" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2480" class="Function">callAddrLookup</a> <a id="2534" class="Symbol">=</a> <a id="2536" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="2541" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#794" class="InductiveConstructor">callAddrLookupc</a> <a id="2557" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a>

<a id="transfer"></a><a id="2565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2565" class="Function">transfer</a> <a id="2574" class="Symbol">:</a> <a id="2576" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a> <a id="2583" class="Symbol">→</a> <a id="2585" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="2593" class="Symbol">→</a> <a id="2595" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2609" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2565" class="Function">transfer</a> <a id="2620" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2620" class="Bound">amount</a> <a id="2627" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2627" class="Bound">addr</a> <a id="2632" class="Symbol">=</a>  <a id="2635" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="InductiveConstructor">exec</a> <a id="2640" class="Symbol">(</a><a id="2641" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="InductiveConstructor">transferc</a> <a id="2651" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2620" class="Bound">amount</a> <a id="2658" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2627" class="Bound">addr</a><a id="2662" class="Symbol">)</a> <a id="2664" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a>



<a id="2674" class="Comment">-- the definition of execution stack elements</a>
<a id="2720" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="2727" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2727" class="Record">ExecStackEl</a> <a id="2739" class="Symbol">:</a> <a id="2741" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2745" class="Keyword">where</a>
  <a id="2753" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="2765" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2765" class="InductiveConstructor">execStackEl</a>
  <a id="2779" class="Keyword">field</a>
    <a id="ExecStackEl.lastCallAddress"></a><a id="2789" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2789" class="Field">lastCallAddress</a>  <a id="2806" class="Symbol">:</a>  <a id="2809" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="ExecStackEl.calledAddress"></a><a id="2821" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2821" class="Field">calledAddress</a>    <a id="2838" class="Symbol">:</a>  <a id="2841" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="ExecStackEl.continuation"></a><a id="2853" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2853" class="Field">continuation</a>     <a id="2870" class="Symbol">:</a>  <a id="2873" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2877" class="Symbol">→</a> <a id="2879" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="2893" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
<a id="2897" class="Keyword">open</a> <a id="2902" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2727" class="Module">ExecStackEl</a> <a id="2914" class="Keyword">public</a>


<a id="2923" class="Comment">-- the definition of the execution stack function function</a>
<a id="ExecutionStack"></a><a id="2982" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2982" class="Function">ExecutionStack</a> <a id="2997" class="Symbol">:</a> <a id="2999" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3003" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2982" class="Function">ExecutionStack</a> <a id="3018" class="Symbol">=</a> <a id="3020" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3025" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2727" class="Record">ExecStackEl</a>



<a id="3040" class="Comment">{- StateExecFun is an intermediate state when we are evaluating a function call
   in a contract
   it consists of
        - the ledger  (which might changed because of updates)
        - executionStack  contains partially evaluated calls to other contracts together with their addresses
        - the current address
        - and the currently partially evaluated function we are evaluating
-}</a>
<a id="3436" class="Keyword">record</a> <a id="StateExecFun"></a><a id="3443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a> <a id="3456" class="Symbol">:</a> <a id="3458" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="3462" class="Keyword">where</a>
  <a id="3470" class="Keyword">constructor</a> <a id="stateEF"></a><a id="3482" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a>
  <a id="3492" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="3502" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3502" class="Field">ledger</a>           <a id="3519" class="Symbol">:</a>  <a id="3522" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="3533" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3533" class="Field">executionStack</a>   <a id="3550" class="Symbol">:</a>  <a id="3553" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2982" class="Function">ExecutionStack</a>
    <a id="StateExecFun.lastCallAddress"></a><a id="3572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3572" class="Field">lastCallAddress</a>  <a id="3589" class="Symbol">:</a>  <a id="3592" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="StateExecFun.currentAddress"></a><a id="3604" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3604" class="Field">currentAddress</a>   <a id="3621" class="Symbol">:</a>  <a id="3624" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="StateExecFun.nextstep"></a><a id="3636" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3636" class="Field">nextstep</a>         <a id="3653" class="Symbol">:</a>  <a id="3656" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="3670" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
<a id="3674" class="Keyword">open</a> <a id="3679" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Module">StateExecFun</a> <a id="3692" class="Keyword">public</a>



<a id="3702" class="Comment">--update ledger</a>
<a id="updateLedger"></a><a id="3718" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3718" class="Function">updateLedger</a> <a id="3731" class="Symbol">:</a> <a id="3733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="3740" class="Symbol">→</a>  <a id="3743" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="3751" class="Symbol">→</a> <a id="3753" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="3766" class="Symbol">→</a> <a id="3768" class="Symbol">(</a><a id="3769" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="3773" class="Symbol">→</a> <a id="3775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="3789" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="3792" class="Symbol">)</a> <a id="3794" class="Symbol">→</a> <a id="3796" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a>
<a id="3803" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3718" class="Function">updateLedger</a> <a id="3816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3816" class="Bound">ledger</a> <a id="3823" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3823" class="Bound">changedAddr</a> <a id="3835" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3835" class="Bound">changedFname</a> <a id="3848" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3848" class="Bound">f</a> <a id="3850" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3850" class="Bound">a</a> <a id="3852" class="Symbol">.</a><a id="3853" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>    <a id="3863" class="Symbol">=</a> <a id="3865" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3816" class="Bound">ledger</a> <a id="3872" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3850" class="Bound">a</a> <a id="3874" class="Symbol">.</a><a id="3875" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>
<a id="3882" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3718" class="Function">updateLedger</a> <a id="3895" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3895" class="Bound">ledger</a> <a id="3902" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3902" class="Bound">changedAddr</a> <a id="3914" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3914" class="Bound">changedFname</a> <a id="3927" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3927" class="Bound">f</a> <a id="3929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3929" class="Bound">a</a> <a id="3931" class="Symbol">.</a><a id="3932" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="3936" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3936" class="Bound">fname</a> <a id="3942" class="Symbol">=</a> <a id="3944" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="3947" class="Symbol">(</a><a id="3948" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3929" class="Bound">a</a> <a id="3950" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="3953" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3902" class="Bound">changedAddr</a><a id="3964" class="Symbol">)</a> <a id="3966" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="3968" class="Symbol">(</a><a id="3969" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3936" class="Bound">fname</a> <a id="3975" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#297" class="Function Operator">≡fun</a> <a id="3980" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3914" class="Bound">changedFname</a><a id="3992" class="Symbol">)</a>
                                                              <a id="4056" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4061" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3927" class="Bound">f</a> <a id="4063" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4068" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3895" class="Bound">ledger</a> <a id="4075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3929" class="Bound">a</a> <a id="4077" class="Symbol">.</a><a id="4078" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="4082" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3936" class="Bound">fname</a>


<a id="4090" class="Comment">--update ledger amount</a>
<a id="updateLedgerAmount"></a><a id="4113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4113" class="Function">updateLedgerAmount</a> <a id="4132" class="Symbol">:</a> <a id="4134" class="Symbol">(</a><a id="4135" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4135" class="Bound">ledger</a> <a id="4142" class="Symbol">:</a> <a id="4144" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a><a id="4150" class="Symbol">)</a>
                     <a id="4173" class="Symbol">→</a> <a id="4175" class="Symbol">(</a><a id="4176" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4176" class="Bound">currentAddr</a> <a id="4188" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4188" class="Bound">destinationAddr</a> <a id="4204" class="Symbol">:</a> <a id="4206" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4213" class="Symbol">)</a> <a id="4215" class="Symbol">(</a><a id="4216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4216" class="Bound">amount&#39;</a> <a id="4224" class="Symbol">:</a> <a id="4226" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="4232" class="Symbol">)</a>
                     <a id="4255" class="Symbol">→</a> <a id="4257" class="Symbol">(</a><a id="4258" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4258" class="Bound">correctAmount</a> <a id="4272" class="Symbol">:</a> <a id="4274" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4216" class="Bound">amount&#39;</a> <a id="4282" href="libraries.natCompare.html#508" class="Function Operator">≦r</a>  <a id="4286" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4135" class="Bound">ledger</a> <a id="4293" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4176" class="Bound">currentAddr</a> <a id="4305" class="Symbol">.</a><a id="4306" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a><a id="4312" class="Symbol">)</a>
                     <a id="4335" class="Symbol">→</a> <a id="4337" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a>
<a id="4344" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4113" class="Function">updateLedgerAmount</a> <a id="4363" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4363" class="Bound">ledger</a> <a id="4370" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4370" class="Bound">currentAddr</a> <a id="4382" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4382" class="Bound">destinationAddr</a> <a id="4398" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">amount&#39;</a> <a id="4406" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4406" class="Bound">correctAmount</a> <a id="4420" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4420" class="Bound">addr</a> <a id="4425" class="Symbol">.</a><a id="4426" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>
     <a id="4438" class="Symbol">=</a> <a id="4440" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4420" class="Bound">addr</a> <a id="4448" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4370" class="Bound">currentAddr</a>
     <a id="4468" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4473" href="libraries.natCompare.html#1529" class="Function">subtract</a> <a id="4482" class="Symbol">(</a><a id="4483" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4363" class="Bound">ledger</a> <a id="4490" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4370" class="Bound">currentAddr</a> <a id="4502" class="Symbol">.</a><a id="4503" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a><a id="4509" class="Symbol">)</a> <a id="4511" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">amount&#39;</a> <a id="4519" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4406" class="Bound">correctAmount</a>
     <a id="4538" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4543" class="Symbol">(</a><a id="4544" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="4547" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4420" class="Bound">addr</a> <a id="4552" href="Data.Nat.Base.html#1127" class="Primitive Operator">≡ᵇ</a> <a id="4555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4382" class="Bound">destinationAddr</a>
     <a id="4576" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="4581" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4363" class="Bound">ledger</a> <a id="4588" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4382" class="Bound">destinationAddr</a> <a id="4604" class="Symbol">.</a><a id="4605" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a> <a id="4612" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4614" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4398" class="Bound">amount&#39;</a>
     <a id="4627" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="4632" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4363" class="Bound">ledger</a> <a id="4639" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4420" class="Bound">addr</a> <a id="4644" class="Symbol">.</a><a id="4645" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a><a id="4651" class="Symbol">)</a>
<a id="4653" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4113" class="Function">updateLedgerAmount</a> <a id="4672" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4672" class="Bound">ledger</a> <a id="4679" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4679" class="Bound">currentAddr</a> <a id="4691" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4691" class="Bound">newAddr</a> <a id="4699" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4699" class="Bound">amount&#39;</a> <a id="4707" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4707" class="Bound">correctAmount</a> <a id="4721" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4721" class="Bound">addr</a> <a id="4726" class="Symbol">.</a><a id="4727" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a>
     <a id="4736" class="Symbol">=</a> <a id="4738" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4672" class="Bound">ledger</a> <a id="4745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4721" class="Bound">addr</a> <a id="4750" class="Symbol">.</a><a id="4751" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a>


<a id="4757" class="Comment">-- execute transfer auxiliary</a>
<a id="executeTransferAux"></a><a id="4787" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4787" class="Function">executeTransferAux</a> <a id="4806" class="Symbol">:</a> <a id="4808" class="Symbol">(</a><a id="4809" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4809" class="Bound">oldLedger</a> <a id="4819" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4819" class="Bound">currentLedger</a> <a id="4833" class="Symbol">:</a> <a id="4835" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a><a id="4841" class="Symbol">)</a>
                  <a id="4861" class="Symbol">→</a> <a id="4863" class="Symbol">(</a><a id="4864" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4864" class="Bound">executionStack</a> <a id="4879" class="Symbol">:</a> <a id="4881" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2982" class="Function">ExecutionStack</a><a id="4895" class="Symbol">)</a>
                  <a id="4915" class="Symbol">→</a> <a id="4917" class="Symbol">(</a><a id="4918" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4918" class="Bound">callAddr</a> <a id="4927" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4927" class="Bound">currentAddr</a> <a id="4939" class="Symbol">:</a> <a id="4941" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4948" class="Symbol">)</a>
                  <a id="4968" class="Symbol">→</a> <a id="4970" class="Symbol">(</a><a id="4971" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4971" class="Bound">amount&#39;</a> <a id="4979" class="Symbol">:</a> <a id="4981" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="4987" class="Symbol">)</a>
                  <a id="5007" class="Symbol">→</a> <a id="5009" class="Symbol">(</a><a id="5010" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5010" class="Bound">destinationAddr</a> <a id="5026" class="Symbol">:</a> <a id="5028" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5035" class="Symbol">)</a>
                  <a id="5055" class="Symbol">→</a> <a id="5057" class="Symbol">(</a><a id="5058" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5058" class="Bound">cont</a> <a id="5063" class="Symbol">:</a> <a id="5065" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="5079" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="5082" class="Symbol">)</a>
                  <a id="5102" class="Symbol">→</a> <a id="5104" class="Symbol">(</a><a id="5105" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5105" class="Bound">cp</a>  <a id="5109" class="Symbol">:</a> <a id="5111" href="libraries.natCompare.html#679" class="Datatype">OrderingLeq</a> <a id="5123" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4971" class="Bound">amount&#39;</a> <a id="5131" class="Symbol">(</a><a id="5132" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4819" class="Bound">currentLedger</a> <a id="5146" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4927" class="Bound">currentAddr</a> <a id="5158" class="Symbol">.</a><a id="5159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>  <a id="5167" class="Symbol">))</a>
                  <a id="5188" class="Symbol">→</a> <a id="5190" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a>
<a id="5203" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4787" class="Function">executeTransferAux</a> <a id="5222" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5222" class="Bound">oldLedger</a> <a id="5232" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5232" class="Bound">currentLedger</a> <a id="5246" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5246" class="Bound">executionStack</a> <a id="5261" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5261" class="Bound">callAddr</a> <a id="5270" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5270" class="Bound">currentAddr</a> <a id="5282" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5282" class="Bound">amount&#39;</a> <a id="5290" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5290" class="Bound">destinationAddr</a> <a id="5306" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5306" class="Bound">cont</a> <a id="5311" class="Symbol">(</a><a id="5312" href="libraries.natCompare.html#717" class="InductiveConstructor">leq</a> <a id="5316" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5316" class="Bound">x</a><a id="5317" class="Symbol">)</a> <a id="5319" class="Symbol">=</a>
          <a id="5331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="5339" class="Symbol">(</a><a id="5340" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4113" class="Function">updateLedgerAmount</a> <a id="5359" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5232" class="Bound">currentLedger</a> <a id="5373" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5270" class="Bound">currentAddr</a> <a id="5385" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5290" class="Bound">destinationAddr</a> <a id="5401" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5282" class="Bound">amount&#39;</a> <a id="5409" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5316" class="Bound">x</a><a id="5410" class="Symbol">)</a>
             <a id="5425" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5246" class="Bound">executionStack</a> <a id="5440" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5261" class="Bound">callAddr</a> <a id="5449" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5270" class="Bound">currentAddr</a> <a id="5461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5306" class="Bound">cont</a>

<a id="5467" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4787" class="Function">executeTransferAux</a> <a id="5486" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5486" class="Bound">oldLedger</a> <a id="5496" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5496" class="Bound">currentLedger</a> <a id="5510" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5510" class="Bound">executionStack</a> <a id="5525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5525" class="Bound">callAddr</a> <a id="5534" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5534" class="Bound">currentAddr</a> <a id="5546" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5546" class="Bound">amount</a> <a id="5553" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5553" class="Bound">destinationAddr</a> <a id="5569" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5569" class="Bound">cont</a> <a id="5574" class="Symbol">(</a><a id="5575" href="libraries.natCompare.html#755" class="InductiveConstructor">greater</a> <a id="5583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5583" class="Bound">x</a><a id="5584" class="Symbol">)</a> <a id="5586" class="Symbol">=</a>
         <a id="5597" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="5605" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5486" class="Bound">oldLedger</a> <a id="5615" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5510" class="Bound">executionStack</a> <a id="5630" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5525" class="Bound">callAddr</a> <a id="5639" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5534" class="Bound">currentAddr</a>
             <a id="5664" class="Symbol">(</a><a id="5665" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="5671" class="Symbol">(</a><a id="5672" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="5679" class="String">&quot;not enough money&quot;</a><a id="5697" class="Symbol">))</a>

<a id="5701" class="Comment">-- -- execute transfer</a>
<a id="executeTransfer"></a><a id="5724" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5724" class="Function">executeTransfer</a> <a id="5740" class="Symbol">:</a> <a id="5742" class="Symbol">(</a><a id="5743" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5743" class="Bound">oldLedger</a> <a id="5753" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5753" class="Bound">currentLedger</a> <a id="5767" class="Symbol">:</a> <a id="5769" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a><a id="5775" class="Symbol">)</a>
                  <a id="5795" class="Symbol">→</a> <a id="5797" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2982" class="Function">ExecutionStack</a>
                  <a id="5830" class="Symbol">→</a> <a id="5832" class="Symbol">(</a><a id="5833" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5833" class="Bound">callAddr</a> <a id="5842" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5842" class="Bound">currentAddr</a> <a id="5854" class="Symbol">:</a> <a id="5856" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5863" class="Symbol">)</a>
                  <a id="5883" class="Symbol">→</a> <a id="5885" class="Symbol">(</a><a id="5886" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5886" class="Bound">amount&#39;</a> <a id="5894" class="Symbol">:</a> <a id="5896" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="5902" class="Symbol">)</a>
                  <a id="5922" class="Symbol">→</a> <a id="5924" class="Symbol">(</a><a id="5925" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5925" class="Bound">destinationAddr</a> <a id="5941" class="Symbol">:</a> <a id="5943" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5950" class="Symbol">)</a>
                  <a id="5970" class="Symbol">→</a> <a id="5972" class="Symbol">(</a><a id="5973" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5973" class="Bound">cont</a> <a id="5978" class="Symbol">:</a> <a id="5980" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1302" class="Datatype">SmartContract</a> <a id="5994" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="5997" class="Symbol">)</a>
                  <a id="6017" class="Symbol">→</a> <a id="6019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a>
<a id="6032" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5724" class="Function">executeTransfer</a> <a id="6048" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6048" class="Bound">oldLedger</a> <a id="6058" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6058" class="Bound">currentLedger</a> <a id="6072" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6072" class="Bound">exexecutionStack</a> <a id="6089" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6089" class="Bound">callAddr</a> <a id="6098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6098" class="Bound">currentAddr</a> <a id="6110" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6110" class="Bound">amount&#39;</a> <a id="6118" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6118" class="Bound">destinationAddr</a> <a id="6134" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6134" class="Bound">cont</a>
                <a id="6155" class="Symbol">=</a> <a id="6157" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4787" class="Function">executeTransferAux</a> <a id="6176" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6048" class="Bound">oldLedger</a> <a id="6186" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6058" class="Bound">currentLedger</a> <a id="6200" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6072" class="Bound">exexecutionStack</a> <a id="6217" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6089" class="Bound">callAddr</a> <a id="6226" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6098" class="Bound">currentAddr</a> <a id="6238" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6110" class="Bound">amount&#39;</a>
                   <a id="6265" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6118" class="Bound">destinationAddr</a> <a id="6281" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6134" class="Bound">cont</a>  <a id="6287" class="Symbol">(</a><a id="6288" href="libraries.natCompare.html#936" class="Function">compareLeq</a> <a id="6299" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6110" class="Bound">amount&#39;</a> <a id="6307" class="Symbol">(</a><a id="6308" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6058" class="Bound">currentLedger</a> <a id="6322" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6098" class="Bound">currentAddr</a> <a id="6334" class="Symbol">.</a><a id="6335" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a>  <a id="6343" class="Symbol">))</a>

<a id="6347" class="Comment">-- definition of stepEF</a>
<a id="stepEF"></a><a id="6371" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="Function">stepEF</a> <a id="6378" class="Symbol">:</a> <a id="6380" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="6387" class="Symbol">→</a> <a id="6389" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a> <a id="6402" class="Symbol">→</a> <a id="6404" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a>
<a id="6417" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="Function">stepEF</a> <a id="6424" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6424" class="Bound">oldLedger</a> <a id="6434" class="Symbol">(</a><a id="6435" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="6443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6443" class="Bound">currentLedger</a> <a id="6457" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6460" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6460" class="Bound">callAddr</a> <a id="6469" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6469" class="Bound">currentAddr</a> <a id="6481" class="Symbol">(</a><a id="6482" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="6489" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6489" class="Bound">result</a><a id="6495" class="Symbol">))</a>
       <a id="6505" class="Symbol">=</a> <a id="6507" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="6515" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6443" class="Bound">currentLedger</a>  <a id="6530" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="6533" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6460" class="Bound">callAddr</a> <a id="6542" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6469" class="Bound">currentAddr</a> <a id="6554" class="Symbol">(</a><a id="6555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="6562" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6489" class="Bound">result</a><a id="6568" class="Symbol">)</a>
<a id="6570" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="Function">stepEF</a> <a id="6577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6577" class="Bound">oldLedger</a> <a id="6587" class="Symbol">(</a><a id="6588" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="6596" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6596" class="Bound">currentLedger</a> <a id="6610" class="Symbol">(</a><a id="6611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6611" class="Bound">execSEl</a> <a id="6619" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6621" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6621" class="Bound">executionStack</a><a id="6635" class="Symbol">)</a> <a id="6637" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6637" class="Bound">callAddr</a> <a id="6646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6646" class="Bound">currentAddr</a> <a id="6658" class="Symbol">(</a><a id="6659" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="6666" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6666" class="Bound">result</a><a id="6672" class="Symbol">))</a>
       <a id="6682" class="Symbol">=</a> <a id="6684" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="6692" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6596" class="Bound">currentLedger</a> <a id="6706" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6621" class="Bound">executionStack</a> <a id="6721" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6637" class="Bound">callAddr</a>  <a id="6731" class="Symbol">(</a><a id="6732" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6611" class="Bound">execSEl</a> <a id="6740" class="Symbol">.</a><a id="6741" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2821" class="Field">calledAddress</a><a id="6754" class="Symbol">)</a> <a id="6756" class="Symbol">(</a><a id="6757" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6611" class="Bound">execSEl</a> <a id="6765" class="Symbol">.</a><a id="6766" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2853" class="Field">continuation</a> <a id="6779" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6666" class="Bound">result</a><a id="6785" class="Symbol">)</a>
<a id="6787" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="6793" class="CatchallClause"> </a><a id="6794" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6794" class="CatchallClause Bound">oldLedger</a><a id="6803" class="CatchallClause"> </a><a id="6804" class="CatchallClause Symbol">(</a><a id="6805" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="6812" class="CatchallClause"> </a><a id="6813" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6813" class="CatchallClause Bound">currentLedger</a><a id="6826" class="CatchallClause"> </a><a id="6827" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6827" class="CatchallClause Bound">executionStack</a><a id="6841" class="CatchallClause"> </a><a id="6842" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6842" class="CatchallClause Bound">callAddr</a><a id="6850" class="CatchallClause"> </a><a id="6851" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6851" class="CatchallClause Bound">currentAddr</a><a id="6862" class="CatchallClause"> </a><a id="6863" class="CatchallClause Symbol">(</a><a id="6864" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="CatchallClause InductiveConstructor">exec</a><a id="6868" class="CatchallClause"> </a><a id="6869" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#758" class="CatchallClause InductiveConstructor">currentAddrLookupc</a><a id="6887" class="CatchallClause"> </a><a id="6888" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6888" class="CatchallClause Bound">cont</a><a id="6892" class="CatchallClause Symbol">))</a>
       <a id="6902" class="Symbol">=</a> <a id="6904" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="6912" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6813" class="Bound">currentLedger</a> <a id="6926" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6827" class="Bound">executionStack</a> <a id="6941" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6842" class="Bound">callAddr</a> <a id="6950" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6851" class="Bound">currentAddr</a> <a id="6962" class="Symbol">(</a><a id="6963" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6888" class="Bound">cont</a> <a id="6968" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6851" class="Bound">currentAddr</a><a id="6979" class="Symbol">)</a>
<a id="6981" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="6987" class="CatchallClause"> </a><a id="6988" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6988" class="CatchallClause Bound">oldLedger</a><a id="6997" class="CatchallClause"> </a><a id="6998" class="CatchallClause Symbol">(</a><a id="6999" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="7006" class="CatchallClause"> </a><a id="7007" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7007" class="CatchallClause Bound">currentLedger</a><a id="7020" class="CatchallClause"> </a><a id="7021" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7021" class="CatchallClause Bound">executionStack</a><a id="7035" class="CatchallClause"> </a><a id="7036" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7036" class="CatchallClause Bound">callAddr</a><a id="7044" class="CatchallClause"> </a><a id="7045" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7045" class="CatchallClause Bound">currentAddr</a><a id="7056" class="CatchallClause"> </a><a id="7057" class="CatchallClause Symbol">(</a><a id="7058" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="CatchallClause InductiveConstructor">exec</a><a id="7062" class="CatchallClause"> </a><a id="7063" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#794" class="CatchallClause InductiveConstructor">callAddrLookupc</a><a id="7078" class="CatchallClause"> </a><a id="7079" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7079" class="CatchallClause Bound">cont</a><a id="7083" class="CatchallClause Symbol">))</a>
       <a id="7093" class="Symbol">=</a> <a id="7095" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="7103" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7007" class="Bound">currentLedger</a> <a id="7117" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7021" class="Bound">executionStack</a> <a id="7132" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7036" class="Bound">callAddr</a> <a id="7141" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7045" class="Bound">currentAddr</a> <a id="7153" class="Symbol">(</a><a id="7154" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7079" class="Bound">cont</a> <a id="7159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7036" class="Bound">callAddr</a><a id="7167" class="Symbol">)</a>
<a id="7169" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="7175" class="CatchallClause"> </a><a id="7176" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7176" class="CatchallClause Bound">oldLedger</a><a id="7185" class="CatchallClause"> </a><a id="7186" class="CatchallClause Symbol">(</a><a id="7187" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="7194" class="CatchallClause"> </a><a id="7195" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7195" class="CatchallClause Bound">currentLedger</a><a id="7208" class="CatchallClause"> </a><a id="7209" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7209" class="CatchallClause Bound">executionStack</a><a id="7223" class="CatchallClause"> </a><a id="7224" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7224" class="CatchallClause Bound">callAddr</a><a id="7232" class="CatchallClause"> </a><a id="7233" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7233" class="CatchallClause Bound">currentAddr</a>
                            <a id="7273" class="CatchallClause Symbol">(</a><a id="7274" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="CatchallClause InductiveConstructor">exec</a><a id="7278" class="CatchallClause"> </a><a id="7279" class="CatchallClause Symbol">(</a><a id="7280" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#687" class="CatchallClause InductiveConstructor">updatec</a><a id="7287" class="CatchallClause"> </a><a id="7288" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7288" class="CatchallClause Bound">changedFname</a><a id="7300" class="CatchallClause"> </a><a id="7301" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7301" class="CatchallClause Bound">changedFdef</a><a id="7312" class="CatchallClause Symbol">)</a><a id="7313" class="CatchallClause"> </a><a id="7314" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7314" class="CatchallClause Bound">cont</a><a id="7318" class="CatchallClause Symbol">))</a>
       <a id="7328" class="Symbol">=</a> <a id="7330" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="7338" class="Symbol">(</a><a id="7339" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3718" class="Function">updateLedger</a> <a id="7352" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7195" class="Bound">currentLedger</a> <a id="7366" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7233" class="Bound">currentAddr</a> <a id="7378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7288" class="Bound">changedFname</a> <a id="7391" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7301" class="Bound">changedFdef</a><a id="7402" class="Symbol">)</a>
                   <a id="7423" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7209" class="Bound">executionStack</a> <a id="7438" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7224" class="Bound">callAddr</a> <a id="7447" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7233" class="Bound">currentAddr</a> <a id="7459" class="Symbol">(</a><a id="7460" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7314" class="Bound">cont</a> <a id="7465" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="7467" class="Symbol">)</a>
<a id="7469" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="7475" class="CatchallClause"> </a><a id="7476" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7476" class="CatchallClause Bound">oldLedger</a><a id="7485" class="CatchallClause"> </a><a id="7486" class="CatchallClause Symbol">(</a><a id="7487" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="7494" class="CatchallClause"> </a><a id="7495" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7495" class="CatchallClause Bound">currentLedger</a><a id="7508" class="CatchallClause"> </a><a id="7509" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7509" class="CatchallClause Bound">executionStack</a><a id="7523" class="CatchallClause"> </a><a id="7524" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7524" class="CatchallClause Bound">oldCalladdr</a><a id="7535" class="CatchallClause"> </a><a id="7536" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7536" class="CatchallClause Bound">oldCurrentAddr</a><a id="7550" class="CatchallClause"> </a><a id="7551" class="CatchallClause Symbol">(</a><a id="7552" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="CatchallClause InductiveConstructor">exec</a><a id="7556" class="CatchallClause"> </a><a id="7557" class="CatchallClause Symbol">(</a><a id="7558" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#628" class="CatchallClause InductiveConstructor">callc</a><a id="7563" class="CatchallClause"> </a><a id="7564" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7564" class="CatchallClause Bound">newaddr</a><a id="7571" class="CatchallClause"> </a><a id="7572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7572" class="CatchallClause Bound">fname</a><a id="7577" class="CatchallClause"> </a><a id="7578" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7578" class="CatchallClause Bound">msg</a><a id="7581" class="CatchallClause Symbol">)</a><a id="7582" class="CatchallClause"> </a><a id="7583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7583" class="CatchallClause Bound">cont</a><a id="7587" class="CatchallClause Symbol">))</a>
       <a id="7597" class="Symbol">=</a> <a id="7599" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="7607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7495" class="Bound">currentLedger</a> <a id="7621" class="Symbol">(</a><a id="7622" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2765" class="InductiveConstructor">execStackEl</a> <a id="7634" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7524" class="Bound">oldCalladdr</a> <a id="7646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7536" class="Bound">oldCurrentAddr</a> <a id="7661" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7583" class="Bound">cont</a>  <a id="7667" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7669" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7509" class="Bound">executionStack</a><a id="7683" class="Symbol">)</a>  <a id="7686" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7536" class="Bound">oldCurrentAddr</a> <a id="7701" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7564" class="Bound">newaddr</a>
                   <a id="7728" class="Symbol">(</a><a id="7729" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7495" class="Bound">currentLedger</a> <a id="7743" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7564" class="Bound">newaddr</a> <a id="7751" class="Symbol">.</a><a id="7752" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="7756" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7572" class="Bound">fname</a> <a id="7762" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7578" class="Bound">msg</a><a id="7765" class="Symbol">)</a>

<a id="7768" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="7774" class="CatchallClause"> </a><a id="7775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7775" class="CatchallClause Bound">oldLedger</a><a id="7784" class="CatchallClause"> </a><a id="7785" class="CatchallClause Symbol">(</a><a id="7786" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="7793" class="CatchallClause"> </a><a id="7794" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7794" class="CatchallClause Bound">currentLedger</a><a id="7807" class="CatchallClause"> </a><a id="7808" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7808" class="CatchallClause Bound">executionStack</a><a id="7822" class="CatchallClause"> </a><a id="7823" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7823" class="CatchallClause Bound">callAddr</a><a id="7831" class="CatchallClause"> </a><a id="7832" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7832" class="CatchallClause Bound">currentAddr</a><a id="7843" class="CatchallClause"> </a><a id="7844" class="CatchallClause Symbol">(</a><a id="7845" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="CatchallClause InductiveConstructor">exec</a><a id="7849" class="CatchallClause"> </a><a id="7850" class="CatchallClause Symbol">(</a><a id="7851" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#581" class="CatchallClause InductiveConstructor">transferc</a><a id="7860" class="CatchallClause"> </a><a id="7861" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7861" class="CatchallClause Bound">amount</a><a id="7867" class="CatchallClause"> </a><a id="7868" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7868" class="CatchallClause Bound">destinationAddr</a><a id="7883" class="CatchallClause"> </a><a id="7884" class="CatchallClause Symbol">)</a><a id="7885" class="CatchallClause"> </a><a id="7886" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7886" class="CatchallClause Bound">cont</a><a id="7890" class="CatchallClause Symbol">))</a>
       <a id="7900" class="Symbol">=</a> <a id="7902" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5724" class="Function">executeTransfer</a> <a id="7918" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7775" class="Bound">oldLedger</a> <a id="7928" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7794" class="Bound">currentLedger</a> <a id="7942" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7808" class="Bound">executionStack</a> <a id="7957" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7823" class="Bound">callAddr</a> <a id="7966" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7832" class="Bound">currentAddr</a> <a id="7978" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7861" class="Bound">amount</a> <a id="7985" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7868" class="Bound">destinationAddr</a> <a id="8001" class="Symbol">(</a><a id="8002" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7886" class="Bound">cont</a> <a id="8007" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="8009" class="Symbol">)</a>
<a id="8011" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="8017" class="CatchallClause"> </a><a id="8018" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8018" class="CatchallClause Bound">oldLedger</a><a id="8027" class="CatchallClause"> </a><a id="8028" class="CatchallClause Symbol">(</a><a id="8029" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="8036" class="CatchallClause"> </a><a id="8037" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8037" class="CatchallClause Bound">currentLedger</a><a id="8050" class="CatchallClause"> </a><a id="8051" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8051" class="CatchallClause Bound">executionStack</a><a id="8065" class="CatchallClause"> </a><a id="8066" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8066" class="CatchallClause Bound">callAddr</a><a id="8074" class="CatchallClause"> </a><a id="8075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8075" class="CatchallClause Bound">currentAddr</a><a id="8086" class="CatchallClause"> </a><a id="8087" class="CatchallClause Symbol">(</a><a id="8088" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1419" class="CatchallClause InductiveConstructor">exec</a><a id="8092" class="CatchallClause"> </a><a id="8093" class="CatchallClause Symbol">(</a><a id="8094" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#830" class="CatchallClause InductiveConstructor">getAmountc</a><a id="8104" class="CatchallClause">  </a><a id="8106" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8106" class="CatchallClause Bound">addrLookedUp</a><a id="8118" class="CatchallClause Symbol">)</a><a id="8119" class="CatchallClause"> </a><a id="8120" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8120" class="CatchallClause Bound">cont</a><a id="8124" class="CatchallClause Symbol">))</a>
       <a id="8134" class="Symbol">=</a> <a id="8136" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="8144" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8037" class="Bound">currentLedger</a> <a id="8158" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8051" class="Bound">executionStack</a> <a id="8173" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8066" class="Bound">callAddr</a> <a id="8182" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8075" class="Bound">currentAddr</a> <a id="8194" class="Symbol">(</a><a id="8195" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8120" class="Bound">cont</a> <a id="8200" class="Symbol">(</a><a id="8201" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8037" class="Bound">currentLedger</a> <a id="8215" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8106" class="Bound">addrLookedUp</a> <a id="8228" class="Symbol">.</a><a id="8229" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1939" class="Field">amount</a><a id="8235" class="Symbol">))</a>
<a id="8238" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="CatchallClause Function">stepEF</a><a id="8244" class="CatchallClause"> </a><a id="8245" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8245" class="CatchallClause Bound">oldLedger</a><a id="8254" class="CatchallClause"> </a><a id="8255" class="CatchallClause Symbol">(</a><a id="8256" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="8263" class="CatchallClause"> </a><a id="8264" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8264" class="CatchallClause Bound">currentLedger</a><a id="8277" class="CatchallClause"> </a><a id="8278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8278" class="CatchallClause Bound">executionStack</a><a id="8292" class="CatchallClause"> </a><a id="8293" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8293" class="CatchallClause Bound">callAddr</a><a id="8301" class="CatchallClause"> </a><a id="8302" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8302" class="CatchallClause Bound">currentAddr</a><a id="8313" class="CatchallClause"> </a><a id="8314" class="CatchallClause Symbol">(</a><a id="8315" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="CatchallClause InductiveConstructor">error</a><a id="8320" class="CatchallClause"> </a><a id="8321" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8321" class="CatchallClause Bound">errorMsg</a><a id="8329" class="CatchallClause Symbol">))</a>
       <a id="8339" class="Symbol">=</a> <a id="8341" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="8349" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8245" class="Bound">oldLedger</a> <a id="8359" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8278" class="Bound">executionStack</a> <a id="8374" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8293" class="Bound">callAddr</a> <a id="8383" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8302" class="Bound">currentAddr</a> <a id="8395" class="Symbol">(</a><a id="8396" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="InductiveConstructor">error</a> <a id="8402" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8321" class="Bound">errorMsg</a><a id="8410" class="Symbol">)</a>


<a id="8414" class="Comment">-- definition of stepEFntimes</a>
<a id="stepEFntimes"></a><a id="8444" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8444" class="Function">stepEFntimes</a> <a id="8457" class="Symbol">:</a> <a id="8459" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="8466" class="Symbol">→</a> <a id="8468" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a> <a id="8481" class="Symbol">→</a> <a id="8483" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8485" class="Symbol">→</a> <a id="8487" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a>
<a id="8500" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8444" class="Function">stepEFntimes</a> <a id="8513" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8513" class="Bound">oldLedger</a> <a id="8523" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8523" class="Bound">ledgerstateexecfun</a> <a id="8542" class="Number">0</a>
             <a id="8557" class="Symbol">=</a> <a id="8559" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8523" class="Bound">ledgerstateexecfun</a>
<a id="8578" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8444" class="Function">stepEFntimes</a> <a id="8591" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8591" class="Bound">oldLedger</a> <a id="8601" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8601" class="Bound">ledgerstateexecfun</a> <a id="8620" class="Symbol">(</a><a id="8621" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8625" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8625" class="Bound">n</a><a id="8626" class="Symbol">)</a>
      <a id="8634" class="Symbol">=</a> <a id="8636" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="Function">stepEF</a> <a id="8643" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8591" class="Bound">oldLedger</a> <a id="8653" class="Symbol">(</a><a id="8654" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8444" class="Function">stepEFntimes</a> <a id="8667" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8591" class="Bound">oldLedger</a> <a id="8677" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8601" class="Bound">ledgerstateexecfun</a> <a id="8696" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8625" class="Bound">n</a><a id="8697" class="Symbol">)</a>


<a id="8701" class="Comment">--define stepledgern times</a>
<a id="stepLedgerFunntimes"></a><a id="8728" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8728" class="Function">stepLedgerFunntimes</a> <a id="8748" class="Symbol">:</a> <a id="8750" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="8757" class="Symbol">→</a> <a id="8759" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
                    <a id="8787" class="Symbol">→</a> <a id="8789" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="8797" class="Symbol">→</a> <a id="8799" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
                    <a id="8832" class="Symbol">→</a> <a id="8834" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="8838" class="Symbol">→</a> <a id="8840" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8842" class="Symbol">→</a> <a id="8844" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a>
<a id="8857" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8728" class="Function">stepLedgerFunntimes</a> <a id="8877" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8877" class="Bound">ledger</a> <a id="8884" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8884" class="Bound">callAddr</a> <a id="8893" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8893" class="Bound">currentAddr</a> <a id="8905" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8905" class="Bound">funname</a> <a id="8913" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8913" class="Bound">msg</a> <a id="8917" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8917" class="Bound">n</a>
        <a id="8927" class="Symbol">=</a> <a id="8929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8444" class="Function">stepEFntimes</a> <a id="8942" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8877" class="Bound">ledger</a> <a id="8949" class="Symbol">(</a><a id="8950" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="8958" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8877" class="Bound">ledger</a> <a id="8965" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="8968" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8884" class="Bound">callAddr</a> <a id="8977" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8893" class="Bound">currentAddr</a>
        <a id="8997" class="Symbol">(</a><a id="8998" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8877" class="Bound">ledger</a> <a id="9005" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8893" class="Bound">currentAddr</a> <a id="9017" class="Symbol">.</a><a id="9018" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="9022" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8905" class="Bound">funname</a> <a id="9030" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8913" class="Bound">msg</a><a id="9033" class="Symbol">))</a> <a id="9036" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8917" class="Bound">n</a>



<a id="stepLedgerFunntimesList"></a><a id="9041" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9041" class="Function">stepLedgerFunntimesList</a> <a id="9065" class="Symbol">:</a> <a id="9067" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="9074" class="Symbol">→</a> <a id="9076" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
                          <a id="9110" class="Symbol">→</a>  <a id="9113" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="9121" class="Symbol">→</a> <a id="9123" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
                          <a id="9162" class="Symbol">→</a> <a id="9164" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="9168" class="Symbol">→</a> <a id="9170" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="9172" class="Symbol">→</a> <a id="9174" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="9179" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a>
<a id="9192" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9041" class="Function">stepLedgerFunntimesList</a> <a id="9216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9216" class="Bound">ledger</a> <a id="9223" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9223" class="Bound">callAddr</a> <a id="9232" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9232" class="Bound">currentAddr</a> <a id="9244" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9244" class="Bound">funname</a> <a id="9252" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9252" class="Bound">msg</a> <a id="9256" class="Number">0</a> <a id="9258" class="Symbol">=</a> <a id="9260" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="9263" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9041" class="Function">stepLedgerFunntimesList</a> <a id="9287" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9287" class="Bound">ledger</a> <a id="9294" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9294" class="Bound">callAddr</a> <a id="9303" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9303" class="Bound">currentAddr</a> <a id="9315" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9315" class="Bound">funname</a> <a id="9323" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9323" class="Bound">msg</a> <a id="9327" class="Symbol">(</a><a id="9328" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="9332" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9332" class="Bound">n</a><a id="9333" class="Symbol">)</a>
        <a id="9343" class="Symbol">=</a> <a id="9345" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8728" class="Function">stepLedgerFunntimes</a> <a id="9365" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9287" class="Bound">ledger</a> <a id="9372" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9294" class="Bound">callAddr</a> <a id="9381" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9303" class="Bound">currentAddr</a> <a id="9393" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9315" class="Bound">funname</a> <a id="9401" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9323" class="Bound">msg</a> <a id="9405" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9332" class="Bound">n</a> <a id="9407" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a>
          <a id="9419" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9041" class="Function">stepLedgerFunntimesList</a> <a id="9443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9287" class="Bound">ledger</a> <a id="9450" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9294" class="Bound">callAddr</a> <a id="9459" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9303" class="Bound">currentAddr</a> <a id="9471" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9315" class="Bound">funname</a> <a id="9479" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9323" class="Bound">msg</a> <a id="9483" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9332" class="Bound">n</a>



<a id="9488" class="Keyword">record</a> <a id="MsgAndLedger"></a><a id="9495" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9495" class="Record">MsgAndLedger</a> <a id="9508" class="Symbol">:</a> <a id="9510" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="9514" class="Keyword">where</a>
  <a id="9522" class="Keyword">constructor</a> <a id="msgAndLedger"></a><a id="9534" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9534" class="InductiveConstructor">msgAndLedger</a>
  <a id="9549" class="Keyword">field</a>
    <a id="MsgAndLedger.theLedger"></a><a id="9559" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9559" class="Field">theLedger</a>  <a id="9570" class="Symbol">:</a> <a id="9572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a>
    <a id="MsgAndLedger.msgOrError"></a><a id="9583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9583" class="Field">msgOrError</a> <a id="9594" class="Symbol">:</a> <a id="9596" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#907" class="Datatype">MsgOrError</a>

<a id="9608" class="Keyword">open</a> <a id="9613" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9495" class="Module">MsgAndLedger</a> <a id="9626" class="Keyword">public</a>


<a id="9635" class="Symbol">{-#</a> <a id="9639" class="Keyword">NON_TERMINATING</a> <a id="9655" class="Symbol">#-}</a>
<a id="evaluateNonTerminatingAuxWithLedger"></a><a id="9659" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9659" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="9695" class="Symbol">:</a> <a id="9697" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="9704" class="Symbol">→</a> <a id="9706" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3443" class="Record">StateExecFun</a> <a id="9719" class="Symbol">→</a> <a id="9721" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9495" class="Record">MsgAndLedger</a>
<a id="9734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9659" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="9770" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9770" class="Bound">oldledger</a> <a id="9780" class="Symbol">(</a><a id="9781" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="9789" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9789" class="Bound">currentLedger</a> <a id="9803" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="9806" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9806" class="Bound">callAddr</a> <a id="9815" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9815" class="Bound">currentAddr</a> <a id="9827" class="Symbol">(</a><a id="9828" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1342" class="InductiveConstructor">return</a> <a id="9835" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9835" class="Bound">m</a><a id="9836" class="Symbol">))</a> <a id="9839" class="Symbol">=</a> <a id="9841" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9534" class="InductiveConstructor">msgAndLedger</a> <a id="9854" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9789" class="Bound">currentLedger</a> <a id="9868" class="Symbol">(</a><a id="9869" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#931" class="InductiveConstructor">theMsg</a> <a id="9876" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9835" class="Bound">m</a><a id="9877" class="Symbol">)</a> 
<a id="9880" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9659" class="CatchallClause Function">evaluateNonTerminatingAuxWithLedger</a><a id="9915" class="CatchallClause"> </a><a id="9916" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9916" class="CatchallClause Bound">oldledger</a><a id="9925" class="CatchallClause"> </a><a id="9926" class="CatchallClause Symbol">(</a><a id="9927" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="CatchallClause InductiveConstructor">stateEF</a><a id="9934" class="CatchallClause"> </a><a id="9935" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9935" class="CatchallClause Bound">currentLedger</a><a id="9948" class="CatchallClause"> </a><a id="9949" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9949" class="CatchallClause Bound">s</a><a id="9950" class="CatchallClause"> </a><a id="9951" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9951" class="CatchallClause Bound">callAddr</a><a id="9959" class="CatchallClause"> </a><a id="9960" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9960" class="CatchallClause Bound">currentAddr</a><a id="9971" class="CatchallClause"> </a><a id="9972" class="CatchallClause Symbol">(</a><a id="9973" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1377" class="CatchallClause InductiveConstructor">error</a><a id="9978" class="CatchallClause"> </a><a id="9979" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9979" class="CatchallClause Bound">e</a><a id="9980" class="CatchallClause Symbol">))</a> <a id="9983" class="Symbol">=</a> <a id="9985" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9534" class="InductiveConstructor">msgAndLedger</a> <a id="9998" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9916" class="Bound">oldledger</a> <a id="10008" class="Symbol">(</a><a id="10009" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#959" class="InductiveConstructor">err</a> <a id="10013" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9979" class="Bound">e</a><a id="10014" class="Symbol">)</a> 
<a id="10017" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9659" class="CatchallClause Function">evaluateNonTerminatingAuxWithLedger</a><a id="10052" class="CatchallClause"> </a><a id="10053" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10053" class="CatchallClause Bound">oldledger</a><a id="10062" class="CatchallClause"> </a><a id="10063" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10063" class="CatchallClause Bound">state</a> <a id="10069" class="Symbol">=</a> <a id="10071" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9659" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="10107" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10053" class="Bound">oldledger</a> <a id="10117" class="Symbol">(</a><a id="10118" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6371" class="Function">stepEF</a>  <a id="10126" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10053" class="Bound">oldledger</a> <a id="10136" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10063" class="Bound">state</a><a id="10141" class="Symbol">)</a>

<a id="evaluateNonTerminatingWithLedger"></a><a id="10144" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10144" class="Function">evaluateNonTerminatingWithLedger</a> <a id="10177" class="Symbol">:</a> <a id="10179" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2047" class="Function">Ledger</a> <a id="10186" class="Symbol">→</a> <a id="10188" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="10196" class="Symbol">→</a>  <a id="10199" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="10207" class="Symbol">→</a> <a id="10209" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="10222" class="Symbol">→</a> <a id="10224" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="10228" class="Symbol">→</a> <a id="10230" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9495" class="Record">MsgAndLedger</a>
<a id="10243" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10144" class="Function">evaluateNonTerminatingWithLedger</a> <a id="10276" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10276" class="Bound">ledger</a> <a id="10283" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10283" class="Bound">callAddr</a> <a id="10292" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10292" class="Bound">currentAddr</a>  <a id="10305" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10305" class="Bound">funname</a> <a id="10313" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10313" class="Bound">msg</a>
                                        <a id="10357" class="Symbol">=</a>  <a id="10360" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9659" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="10396" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10276" class="Bound">ledger</a> <a id="10403" class="Symbol">(</a><a id="10404" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3482" class="InductiveConstructor">stateEF</a> <a id="10412" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10276" class="Bound">ledger</a> <a id="10419" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="10422" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10283" class="Bound">callAddr</a> <a id="10431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10292" class="Bound">currentAddr</a> <a id="10443" class="Symbol">(</a><a id="10444" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10276" class="Bound">ledger</a> <a id="10451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10292" class="Bound">currentAddr</a> <a id="10463" class="Symbol">.</a><a id="10464" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1961" class="Field">fun</a> <a id="10468" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10305" class="Bound">funname</a> <a id="10476" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10313" class="Bound">msg</a><a id="10479" class="Symbol">))</a>


</pre></body></html>